<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Validity and Validation Tests | Principal Component Analysis: Unveiling the Structure of Psychological Data</title>
  <meta name="description" content="A comprehensive handbook on psychological measurement concepts, theories, and statistical methods." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Validity and Validation Tests | Principal Component Analysis: Unveiling the Structure of Psychological Data" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A comprehensive handbook on psychological measurement concepts, theories, and statistical methods." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Validity and Validation Tests | Principal Component Analysis: Unveiling the Structure of Psychological Data" />
  
  <meta name="twitter:description" content="A comprehensive handbook on psychological measurement concepts, theories, and statistical methods." />
  

<meta name="author" content="Psychological Measurement" />


<meta name="date" content="2025-06-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="advanced-topics-and-future-directions.html"/>
<link rel="next" href="principal-component-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Handbook of Psychological Measurement</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i>How to Use This Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#required-r-packages"><i class="fa fa-check"></i>Required R Packages</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="classical-test-theory.html"><a href="classical-test-theory.html"><i class="fa fa-check"></i><b>1</b> Classical Test Theory: The Foundation of Psychological Measurement</a>
<ul>
<li class="chapter" data-level="1.1" data-path="classical-test-theory.html"><a href="classical-test-theory.html#understanding-classical-test-theory-the-building-blocks-of-measurement"><i class="fa fa-check"></i><b>1.1</b> Understanding Classical Test Theory: The Building Blocks of Measurement</a></li>
<li class="chapter" data-level="1.2" data-path="classical-test-theory.html"><a href="classical-test-theory.html#the-fundamental-equation-breaking-down-test-scores"><i class="fa fa-check"></i><b>1.2</b> The Fundamental Equation: Breaking Down Test Scores</a></li>
<li class="chapter" data-level="1.3" data-path="classical-test-theory.html"><a href="classical-test-theory.html#core-assumptions-the-rules-of-the-game"><i class="fa fa-check"></i><b>1.3</b> Core Assumptions: The Rules of the Game</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="classical-test-theory.html"><a href="classical-test-theory.html#assumption-1-true-score-as-expected-value"><i class="fa fa-check"></i><b>1.3.1</b> Assumption 1: True Score as Expected Value</a></li>
<li class="chapter" data-level="1.3.2" data-path="classical-test-theory.html"><a href="classical-test-theory.html#assumption-2-error-properties"><i class="fa fa-check"></i><b>1.3.2</b> Assumption 2: Error Properties</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="classical-test-theory.html"><a href="classical-test-theory.html#visualizing-classical-test-theory-concepts"><i class="fa fa-check"></i><b>1.4</b> Visualizing Classical Test Theory Concepts</a></li>
<li class="chapter" data-level="1.5" data-path="classical-test-theory.html"><a href="classical-test-theory.html#reliability-the-consistency-of-measurement"><i class="fa fa-check"></i><b>1.5</b> Reliability: The Consistency of Measurement</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="classical-test-theory.html"><a href="classical-test-theory.html#the-reliability-coefficient"><i class="fa fa-check"></i><b>1.5.1</b> The Reliability Coefficient</a></li>
<li class="chapter" data-level="1.5.2" data-path="classical-test-theory.html"><a href="classical-test-theory.html#alternative-reliability-formula"><i class="fa fa-check"></i><b>1.5.2</b> Alternative Reliability Formula</a></li>
<li class="chapter" data-level="1.5.3" data-path="classical-test-theory.html"><a href="classical-test-theory.html#types-of-reliability-evidence"><i class="fa fa-check"></i><b>1.5.3</b> Types of Reliability Evidence</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="classical-test-theory.html"><a href="classical-test-theory.html#demonstrating-reliability-concepts"><i class="fa fa-check"></i><b>1.6</b> Demonstrating Reliability Concepts</a></li>
<li class="chapter" data-level="1.7" data-path="classical-test-theory.html"><a href="classical-test-theory.html#validity-measuring-what-we-intend-to-measure"><i class="fa fa-check"></i><b>1.7</b> Validity: Measuring What We Intend to Measure</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="classical-test-theory.html"><a href="classical-test-theory.html#the-reliability-validity-relationship"><i class="fa fa-check"></i><b>1.7.1</b> The Reliability-Validity Relationship</a></li>
<li class="chapter" data-level="1.7.2" data-path="classical-test-theory.html"><a href="classical-test-theory.html#correction-for-attenuation"><i class="fa fa-check"></i><b>1.7.2</b> Correction for Attenuation</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="classical-test-theory.html"><a href="classical-test-theory.html#standard-error-of-measurement"><i class="fa fa-check"></i><b>1.8</b> Standard Error of Measurement</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="classical-test-theory.html"><a href="classical-test-theory.html#confidence-intervals-for-individual-scores"><i class="fa fa-check"></i><b>1.8.1</b> Confidence Intervals for Individual Scores</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="classical-test-theory.html"><a href="classical-test-theory.html#applications-across-psychological-domains"><i class="fa fa-check"></i><b>1.9</b> Applications Across Psychological Domains</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="classical-test-theory.html"><a href="classical-test-theory.html#clinical-psychology-applications"><i class="fa fa-check"></i><b>1.9.1</b> Clinical Psychology Applications</a></li>
<li class="chapter" data-level="1.9.2" data-path="classical-test-theory.html"><a href="classical-test-theory.html#cognitive-psychology-applications"><i class="fa fa-check"></i><b>1.9.2</b> Cognitive Psychology Applications</a></li>
<li class="chapter" data-level="1.9.3" data-path="classical-test-theory.html"><a href="classical-test-theory.html#behavioral-psychology-applications"><i class="fa fa-check"></i><b>1.9.3</b> Behavioral Psychology Applications</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="classical-test-theory.html"><a href="classical-test-theory.html#limitations-and-modern-developments"><i class="fa fa-check"></i><b>1.10</b> Limitations and Modern Developments</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="classical-test-theory.html"><a href="classical-test-theory.html#classical-test-theory-limitations"><i class="fa fa-check"></i><b>1.10.1</b> Classical Test Theory Limitations</a></li>
<li class="chapter" data-level="1.10.2" data-path="classical-test-theory.html"><a href="classical-test-theory.html#modern-alternatives"><i class="fa fa-check"></i><b>1.10.2</b> Modern Alternatives</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="classical-test-theory.html"><a href="classical-test-theory.html#practical-guidelines-for-researchers-and-practitioners"><i class="fa fa-check"></i><b>1.11</b> Practical Guidelines for Researchers and Practitioners</a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="classical-test-theory.html"><a href="classical-test-theory.html#test-selection-criteria"><i class="fa fa-check"></i><b>1.11.1</b> Test Selection Criteria</a></li>
<li class="chapter" data-level="1.11.2" data-path="classical-test-theory.html"><a href="classical-test-theory.html#score-interpretation-guidelines"><i class="fa fa-check"></i><b>1.11.2</b> Score Interpretation Guidelines</a></li>
<li class="chapter" data-level="1.11.3" data-path="classical-test-theory.html"><a href="classical-test-theory.html#test-development-recommendations"><i class="fa fa-check"></i><b>1.11.3</b> Test Development Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="classical-test-theory.html"><a href="classical-test-theory.html#references"><i class="fa fa-check"></i><b>1.12</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reliability.html"><a href="reliability.html"><i class="fa fa-check"></i><b>2</b> Reliability in Classical Test Theory</a>
<ul>
<li class="chapter" data-level="2.1" data-path="reliability.html"><a href="reliability.html#parallel-tests-and-their-mathematical-properties"><i class="fa fa-check"></i><b>2.1</b> Parallel Tests and Their Mathematical Properties</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="reliability.html"><a href="reliability.html#definition-of-parallel-tests"><i class="fa fa-check"></i><b>2.1.1</b> Definition of Parallel Tests</a></li>
<li class="chapter" data-level="2.1.2" data-path="reliability.html"><a href="reliability.html#mathematical-implications"><i class="fa fa-check"></i><b>2.1.2</b> Mathematical Implications</a></li>
<li class="chapter" data-level="2.1.3" data-path="reliability.html"><a href="reliability.html#tau-equivalent-tests"><i class="fa fa-check"></i><b>2.1.3</b> Tau-Equivalent Tests</a></li>
<li class="chapter" data-level="2.1.4" data-path="reliability.html"><a href="reliability.html#essentially-tau-equivalent-tests"><i class="fa fa-check"></i><b>2.1.4</b> Essentially Tau-Equivalent Tests</a></li>
<li class="chapter" data-level="2.1.5" data-path="reliability.html"><a href="reliability.html#example-analyzing-parallel-tests"><i class="fa fa-check"></i><b>2.1.5</b> Example: Analyzing Parallel Tests</a></li>
<li class="chapter" data-level="2.1.6" data-path="reliability.html"><a href="reliability.html#r-code-for-parallel-test-analysis"><i class="fa fa-check"></i><b>2.1.6</b> R Code for Parallel Test Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="reliability.html"><a href="reliability.html#reliability-and-test-length"><i class="fa fa-check"></i><b>2.2</b> Reliability and Test Length</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="reliability.html"><a href="reliability.html#the-spearman-brown-prophecy-formula"><i class="fa fa-check"></i><b>2.2.1</b> The Spearman-Brown Prophecy Formula</a></li>
<li class="chapter" data-level="2.2.2" data-path="reliability.html"><a href="reliability.html#special-cases"><i class="fa fa-check"></i><b>2.2.2</b> Special Cases</a></li>
<li class="chapter" data-level="2.2.3" data-path="reliability.html"><a href="reliability.html#example-effect-of-test-length-on-reliability"><i class="fa fa-check"></i><b>2.2.3</b> Example: Effect of Test Length on Reliability</a></li>
<li class="chapter" data-level="2.2.4" data-path="reliability.html"><a href="reliability.html#r-code-for-test-length-analysis"><i class="fa fa-check"></i><b>2.2.4</b> R Code for Test Length Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="reliability.html"><a href="reliability.html#reliability-and-group-homogeneity"><i class="fa fa-check"></i><b>2.3</b> Reliability and Group Homogeneity</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="reliability.html"><a href="reliability.html#the-effect-of-range-restriction"><i class="fa fa-check"></i><b>2.3.1</b> The Effect of Range Restriction</a></li>
<li class="chapter" data-level="2.3.2" data-path="reliability.html"><a href="reliability.html#adjusting-reliability-for-range-restriction"><i class="fa fa-check"></i><b>2.3.2</b> Adjusting Reliability for Range Restriction</a></li>
<li class="chapter" data-level="2.3.3" data-path="reliability.html"><a href="reliability.html#example-effect-of-range-restriction"><i class="fa fa-check"></i><b>2.3.3</b> Example: Effect of Range Restriction</a></li>
<li class="chapter" data-level="2.3.4" data-path="reliability.html"><a href="reliability.html#r-code-for-range-restriction-analysis"><i class="fa fa-check"></i><b>2.3.4</b> R Code for Range Restriction Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="reliability.html"><a href="reliability.html#estimation-of-true-scores"><i class="fa fa-check"></i><b>2.4</b> Estimation of True Scores</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="reliability.html"><a href="reliability.html#regression-toward-the-mean"><i class="fa fa-check"></i><b>2.4.1</b> Regression Toward the Mean</a></li>
<li class="chapter" data-level="2.4.2" data-path="reliability.html"><a href="reliability.html#confidence-intervals-for-estimated-true-scores"><i class="fa fa-check"></i><b>2.4.2</b> Confidence Intervals for Estimated True Scores</a></li>
<li class="chapter" data-level="2.4.3" data-path="reliability.html"><a href="reliability.html#example-estimating-true-scores"><i class="fa fa-check"></i><b>2.4.3</b> Example: Estimating True Scores</a></li>
<li class="chapter" data-level="2.4.4" data-path="reliability.html"><a href="reliability.html#r-code-for-true-score-estimation"><i class="fa fa-check"></i><b>2.4.4</b> R Code for True Score Estimation</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="reliability.html"><a href="reliability.html#correction-for-attenuation-1"><i class="fa fa-check"></i><b>2.5</b> Correction for Attenuation</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="reliability.html"><a href="reliability.html#the-attenuation-problem"><i class="fa fa-check"></i><b>2.5.1</b> The Attenuation Problem</a></li>
<li class="chapter" data-level="2.5.2" data-path="reliability.html"><a href="reliability.html#the-correction-formula"><i class="fa fa-check"></i><b>2.5.2</b> The Correction Formula</a></li>
<li class="chapter" data-level="2.5.3" data-path="reliability.html"><a href="reliability.html#example-correcting-a-correlation"><i class="fa fa-check"></i><b>2.5.3</b> Example: Correcting a Correlation</a></li>
<li class="chapter" data-level="2.5.4" data-path="reliability.html"><a href="reliability.html#r-code-for-attenuation-correction"><i class="fa fa-check"></i><b>2.5.4</b> R Code for Attenuation Correction</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="reliability.html"><a href="reliability.html#methods-for-estimating-reliability"><i class="fa fa-check"></i><b>2.6</b> Methods for Estimating Reliability</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="reliability.html"><a href="reliability.html#test-retest-reliability"><i class="fa fa-check"></i><b>2.6.1</b> Test-Retest Reliability</a></li>
<li class="chapter" data-level="2.6.2" data-path="reliability.html"><a href="reliability.html#internal-consistency-reliability"><i class="fa fa-check"></i><b>2.6.2</b> Internal Consistency Reliability</a></li>
<li class="chapter" data-level="2.6.3" data-path="reliability.html"><a href="reliability.html#r-code-for-reliability-estimation"><i class="fa fa-check"></i><b>2.6.3</b> R Code for Reliability Estimation</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="reliability.html"><a href="reliability.html#practical-applications-and-recommendations"><i class="fa fa-check"></i><b>2.7</b> Practical Applications and Recommendations</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="reliability.html"><a href="reliability.html#minimum-reliability-standards"><i class="fa fa-check"></i><b>2.7.1</b> Minimum Reliability Standards</a></li>
<li class="chapter" data-level="2.7.2" data-path="reliability.html"><a href="reliability.html#strategies-for-improving-reliability"><i class="fa fa-check"></i><b>2.7.2</b> Strategies for Improving Reliability</a></li>
<li class="chapter" data-level="2.7.3" data-path="reliability.html"><a href="reliability.html#reporting-practices"><i class="fa fa-check"></i><b>2.7.3</b> Reporting Practices</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="reliability.html"><a href="reliability.html#references-1"><i class="fa fa-check"></i><b>2.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html"><i class="fa fa-check"></i><b>3</b> Generalizability Theory in Psychological Measurement</a>
<ul>
<li class="chapter" data-level="3.1" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#basic-concepts-of-generalizability-theory"><i class="fa fa-check"></i><b>3.2</b> Basic Concepts of Generalizability Theory</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#universe-of-admissible-observations"><i class="fa fa-check"></i><b>3.2.1</b> Universe of Admissible Observations</a></li>
<li class="chapter" data-level="3.2.2" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#facets"><i class="fa fa-check"></i><b>3.2.2</b> Facets</a></li>
<li class="chapter" data-level="3.2.3" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#variance-components"><i class="fa fa-check"></i><b>3.2.3</b> Variance Components</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#one-facet-designs"><i class="fa fa-check"></i><b>3.3</b> One-Facet Designs</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#crossed-design-p-i"><i class="fa fa-check"></i><b>3.3.1</b> Crossed Design (p × i)</a></li>
<li class="chapter" data-level="3.3.2" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#nested-design-ip"><i class="fa fa-check"></i><b>3.3.2</b> Nested Design (i:p)</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#two-facet-designs"><i class="fa fa-check"></i><b>3.4</b> Two-Facet Designs</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#crossed-design-p-i-j"><i class="fa fa-check"></i><b>3.4.1</b> Crossed Design (p × i × j)</a></li>
<li class="chapter" data-level="3.4.2" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#nested-two-facet-design-p-ij"><i class="fa fa-check"></i><b>3.4.2</b> Nested Two-Facet Design (p × (i:j))</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#decision-studies-d-studies"><i class="fa fa-check"></i><b>3.5</b> Decision Studies (D-Studies)</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#generalizability-coefficients"><i class="fa fa-check"></i><b>3.5.1</b> Generalizability Coefficients</a></li>
<li class="chapter" data-level="3.5.2" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#example-optimizing-assessment-design"><i class="fa fa-check"></i><b>3.5.2</b> Example: Optimizing Assessment Design</a></li>
<li class="chapter" data-level="3.5.3" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#relative-versus-absolute-decisions"><i class="fa fa-check"></i><b>3.5.3</b> Relative versus Absolute Decisions</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#practical-applications-in-psychology"><i class="fa fa-check"></i><b>3.6</b> Practical Applications in Psychology</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#clinical-assessment"><i class="fa fa-check"></i><b>3.6.1</b> Clinical Assessment</a></li>
<li class="chapter" data-level="3.6.2" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#educational-measurement"><i class="fa fa-check"></i><b>3.6.2</b> Educational Measurement</a></li>
<li class="chapter" data-level="3.6.3" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#research-methodology"><i class="fa fa-check"></i><b>3.6.3</b> Research Methodology</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#conclusion"><i class="fa fa-check"></i><b>3.7</b> Conclusion</a></li>
<li class="chapter" data-level="3.8" data-path="generalizability-theory-in-psychological-measurement.html"><a href="generalizability-theory-in-psychological-measurement.html#references-2"><i class="fa fa-check"></i><b>3.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html"><i class="fa fa-check"></i><b>4</b> Models for Dichotomous Items</a>
<ul>
<li class="chapter" data-level="4.1" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#understanding-dichotomous-items"><i class="fa fa-check"></i><b>4.1.1</b> 1. Understanding Dichotomous Items</a></li>
<li class="chapter" data-level="4.1.2" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#example-from-cognitive-psychology"><i class="fa fa-check"></i><b>4.1.2</b> Example from Cognitive Psychology</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#the-binomial-model"><i class="fa fa-check"></i><b>4.2</b> 2. The Binomial Model</a></li>
<li class="chapter" data-level="4.3" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#mathematical-definition"><i class="fa fa-check"></i><b>4.3</b> Mathematical Definition</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#interpretation"><i class="fa fa-check"></i><b>4.3.1</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#variance-and-error"><i class="fa fa-check"></i><b>4.4</b> Variance and Error</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#worked-example"><i class="fa fa-check"></i><b>4.4.1</b> Worked Example</a></li>
<li class="chapter" data-level="4.4.2" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#plotting-the-binomial-distribution"><i class="fa fa-check"></i><b>4.4.2</b> Plotting the Binomial Distribution</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#generalized-binomial-model"><i class="fa fa-check"></i><b>4.5</b> 3. Generalized Binomial Model</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#mathematical-formulation"><i class="fa fa-check"></i><b>4.5.1</b> Mathematical Formulation</a></li>
<li class="chapter" data-level="4.5.2" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#understanding-the-components"><i class="fa fa-check"></i><b>4.5.2</b> Understanding the Components</a></li>
<li class="chapter" data-level="4.5.3" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#example-from-behavioral-psychology"><i class="fa fa-check"></i><b>4.5.3</b> Example from Behavioral Psychology</a></li>
<li class="chapter" data-level="4.5.4" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#advanced-item-response-functions"><i class="fa fa-check"></i><b>4.5.4</b> Advanced Item Response Functions</a></li>
<li class="chapter" data-level="4.5.5" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#information-functions-and-precision"><i class="fa fa-check"></i><b>4.5.5</b> Information Functions and Precision</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#psychological-applications-and-item-analysis"><i class="fa fa-check"></i><b>4.6</b> 4. Psychological Applications and Item Analysis</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#clinical-example"><i class="fa fa-check"></i><b>4.6.1</b> Clinical Example</a></li>
<li class="chapter" data-level="4.6.2" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#item-statistics"><i class="fa fa-check"></i><b>4.6.2</b> Item Statistics</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#reliability-and-estimation"><i class="fa fa-check"></i><b>4.7</b> 5. Reliability and Estimation</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#example-calculation"><i class="fa fa-check"></i><b>4.7.1</b> Example Calculation</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#the-rasch-model"><i class="fa fa-check"></i><b>4.8</b> 6. The Rasch Model</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#mathematical-foundation"><i class="fa fa-check"></i><b>4.8.1</b> Mathematical Foundation</a></li>
<li class="chapter" data-level="4.8.2" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#alternative-parameterization"><i class="fa fa-check"></i><b>4.8.2</b> Alternative Parameterization</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#key-properties-of-the-rasch-model"><i class="fa fa-check"></i><b>4.9</b> Key Properties of the Rasch Model</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#sufficiency-of-raw-scores"><i class="fa fa-check"></i><b>4.9.1</b> 1. Sufficiency of Raw Scores</a></li>
<li class="chapter" data-level="4.9.2" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#sample-independence"><i class="fa fa-check"></i><b>4.9.2</b> 2. Sample Independence</a></li>
<li class="chapter" data-level="4.9.3" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#specific-objectivity"><i class="fa fa-check"></i><b>4.9.3</b> 3. Specific Objectivity</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#practical-example-depression-assessment"><i class="fa fa-check"></i><b>4.10</b> Practical Example: Depression Assessment</a></li>
<li class="chapter" data-level="4.11" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#item-fit-analysis"><i class="fa fa-check"></i><b>4.11</b> Item Fit Analysis</a>
<ul>
<li class="chapter" data-level="4.11.1" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#infit-and-outfit-statistics"><i class="fa fa-check"></i><b>4.11.1</b> Infit and Outfit Statistics</a></li>
</ul></li>
<li class="chapter" data-level="4.12" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#two-parameter-and-three-parameter-logistic-models"><i class="fa fa-check"></i><b>4.12</b> 7. Two-Parameter and Three-Parameter Logistic Models</a>
<ul>
<li class="chapter" data-level="4.12.1" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#two-parameter-logistic-2pl-model"><i class="fa fa-check"></i><b>4.12.1</b> Two-Parameter Logistic (2PL) Model</a></li>
<li class="chapter" data-level="4.12.2" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#interpretation-of-parameters"><i class="fa fa-check"></i><b>4.12.2</b> Interpretation of Parameters</a></li>
<li class="chapter" data-level="4.12.3" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#three-parameter-logistic-3pl-model"><i class="fa fa-check"></i><b>4.12.3</b> Three-Parameter Logistic (3PL) Model</a></li>
<li class="chapter" data-level="4.12.4" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#comparative-example-intelligence-test-items"><i class="fa fa-check"></i><b>4.12.4</b> Comparative Example: Intelligence Test Items</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#testlet-models-and-local-dependence"><i class="fa fa-check"></i><b>4.13</b> 8. Testlet Models and Local Dependence</a>
<ul>
<li class="chapter" data-level="4.13.1" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#the-testlet-response-model"><i class="fa fa-check"></i><b>4.13.1</b> The Testlet Response Model</a></li>
<li class="chapter" data-level="4.13.2" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#example-reading-comprehension-assessment"><i class="fa fa-check"></i><b>4.13.2</b> Example: Reading Comprehension Assessment</a></li>
</ul></li>
<li class="chapter" data-level="4.14" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#differential-item-functioning-dif"><i class="fa fa-check"></i><b>4.14</b> 9. Differential Item Functioning (DIF)</a>
<ul>
<li class="chapter" data-level="4.14.1" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#types-of-dif"><i class="fa fa-check"></i><b>4.14.1</b> Types of DIF</a></li>
<li class="chapter" data-level="4.14.2" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#non-uniform-dif"><i class="fa fa-check"></i><b>4.14.2</b> Non-uniform DIF</a></li>
<li class="chapter" data-level="4.14.3" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#dif-detection-example"><i class="fa fa-check"></i><b>4.14.3</b> DIF Detection Example</a></li>
</ul></li>
<li class="chapter" data-level="4.15" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#computerized-adaptive-testing-cat"><i class="fa fa-check"></i><b>4.15</b> 10. Computerized Adaptive Testing (CAT)</a>
<ul>
<li class="chapter" data-level="4.15.1" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#cat-algorithm-components"><i class="fa fa-check"></i><b>4.15.1</b> CAT Algorithm Components</a></li>
<li class="chapter" data-level="4.15.2" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#information-based-item-selection"><i class="fa fa-check"></i><b>4.15.2</b> Information-Based Item Selection</a></li>
</ul></li>
<li class="chapter" data-level="4.16" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#cat-simulation-example"><i class="fa fa-check"></i><b>4.16</b> CAT Simulation Example</a></li>
<li class="chapter" data-level="4.17" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#model-comparison-and-selection"><i class="fa fa-check"></i><b>4.17</b> 11. Model Comparison and Selection</a>
<ul>
<li class="chapter" data-level="4.17.1" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#information-criteria"><i class="fa fa-check"></i><b>4.17.1</b> Information Criteria</a></li>
</ul></li>
<li class="chapter" data-level="4.18" data-path="models-for-dichotomous-items.html"><a href="models-for-dichotomous-items.html#practical-model-comparison"><i class="fa fa-check"></i><b>4.18</b> Practical Model Comparison</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="advanced-topics-and-future-directions.html"><a href="advanced-topics-and-future-directions.html"><i class="fa fa-check"></i><b>5</b> 12. Advanced Topics and Future Directions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="advanced-topics-and-future-directions.html"><a href="advanced-topics-and-future-directions.html#multidimensional-irt"><i class="fa fa-check"></i><b>5.1</b> Multidimensional IRT</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="advanced-topics-and-future-directions.html"><a href="advanced-topics-and-future-directions.html#explanatory-irt"><i class="fa fa-check"></i><b>5.1.1</b> Explanatory IRT</a></li>
<li class="chapter" data-level="5.1.2" data-path="advanced-topics-and-future-directions.html"><a href="advanced-topics-and-future-directions.html#machine-learning-applications"><i class="fa fa-check"></i><b>5.1.2</b> Machine Learning Applications</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="advanced-topics-and-future-directions.html"><a href="advanced-topics-and-future-directions.html#conclusion-1"><i class="fa fa-check"></i><b>5.2</b> Conclusion</a></li>
<li class="chapter" data-level="5.3" data-path="advanced-topics-and-future-directions.html"><a href="advanced-topics-and-future-directions.html#references-3"><i class="fa fa-check"></i><b>5.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html"><i class="fa fa-check"></i><b>6</b> Validity and Validation Tests</a>
<ul>
<li class="chapter" data-level="6.1" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#introduction-2"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#mathematical-foundations-of-validity-theory"><i class="fa fa-check"></i><b>6.2</b> Mathematical Foundations of Validity Theory</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#theoretical-framework-and-mathematical-models"><i class="fa fa-check"></i><b>6.2.1</b> Theoretical Framework and Mathematical Models</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#problems-of-validity"><i class="fa fa-check"></i><b>6.3</b> Problems of Validity</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#the-challenge-of-construct-representation"><i class="fa fa-check"></i><b>6.3.1</b> The Challenge of Construct Representation</a></li>
<li class="chapter" data-level="6.3.2" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#construct-underrepresentation-mathematical-analysis"><i class="fa fa-check"></i><b>6.3.2</b> Construct Underrepresentation: Mathematical Analysis</a></li>
<li class="chapter" data-level="6.3.3" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#construct-irrelevant-variance-mathematical-treatment"><i class="fa fa-check"></i><b>6.3.3</b> Construct-Irrelevant Variance: Mathematical Treatment</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#many-faces-of-validity-and-standards"><i class="fa fa-check"></i><b>6.4</b> Many Faces of Validity and Standards</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#historical-evolution-of-validity-frameworks"><i class="fa fa-check"></i><b>6.4.1</b> Historical Evolution of Validity Frameworks</a></li>
<li class="chapter" data-level="6.4.2" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#the-five-sources-of-validity-evidence"><i class="fa fa-check"></i><b>6.4.2</b> The Five Sources of Validity Evidence</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#sources-of-evidence-in-validity"><i class="fa fa-check"></i><b>6.5</b> Sources of Evidence in Validity</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#evidence-based-on-test-content-mathematical-framework"><i class="fa fa-check"></i><b>6.5.1</b> Evidence Based on Test Content: Mathematical Framework</a></li>
<li class="chapter" data-level="6.5.2" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#evidence-based-on-response-processes"><i class="fa fa-check"></i><b>6.5.2</b> Evidence Based on Response Processes</a></li>
<li class="chapter" data-level="6.5.3" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#evidence-based-on-internal-structure"><i class="fa fa-check"></i><b>6.5.3</b> Evidence Based on Internal Structure</a></li>
<li class="chapter" data-level="6.5.4" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#the-multitrait-multimethod-matrix"><i class="fa fa-check"></i><b>6.5.4</b> The Multitrait-Multimethod Matrix</a></li>
<li class="chapter" data-level="6.5.5" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#analyzing-mtmm-evidence"><i class="fa fa-check"></i><b>6.5.5</b> Analyzing MTMM Evidence</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#mathematical-theory-of-range-restriction-effects"><i class="fa fa-check"></i><b>6.6</b> Mathematical Theory of Range Restriction Effects</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#theoretical-framework-and-mathematical-foundations"><i class="fa fa-check"></i><b>6.6.1</b> Theoretical Framework and Mathematical Foundations</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#mathematical-theory-of-multitrait-multimethod-analysis"><i class="fa fa-check"></i><b>6.7</b> Mathematical Theory of Multitrait-Multimethod Analysis</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#theoretical-framework-for-mtmm-matrix-decomposition"><i class="fa fa-check"></i><b>6.7.1</b> Theoretical Framework for MTMM Matrix Decomposition</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#mathematical-theory-of-bayesian-classification"><i class="fa fa-check"></i><b>6.8</b> Mathematical Theory of Bayesian Classification</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#theoretical-framework-for-optimal-decision-making"><i class="fa fa-check"></i><b>6.8.1</b> Theoretical Framework for Optimal Decision Making</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#mathematical-theory-of-irt-based-validity"><i class="fa fa-check"></i><b>6.9</b> Mathematical Theory of IRT-Based Validity</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#theoretical-framework-for-item-response-theory-validation"><i class="fa fa-check"></i><b>6.9.1</b> Theoretical Framework for Item Response Theory Validation</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#generate-angoff-ratings-probability-of-correct-response-for-borderline-candidate"><i class="fa fa-check"></i><b>6.10</b> Generate Angoff ratings (probability of correct response for borderline candidate)</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#section"><i class="fa fa-check"></i><b>6.10.1</b> </a></li>
<li class="chapter" data-level="6.10.2" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#judge-ratings-with-some-individual-differences"><i class="fa fa-check"></i><b>6.10.2</b> Judge ratings with some individual differences</a></li>
<li class="chapter" data-level="6.10.3" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#calculate-statistics"><i class="fa fa-check"></i><b>6.10.3</b> Calculate statistics</a></li>
<li class="chapter" data-level="6.10.4" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#overall-cut-score"><i class="fa fa-check"></i><b>6.10.4</b> Overall cut score</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#create-visualization-of-judge-agreement"><i class="fa fa-check"></i><b>6.11</b> Create visualization of judge agreement</a></li>
<li class="chapter" data-level="6.12" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#item-level-summary"><i class="fa fa-check"></i><b>6.12</b> Item-level summary</a></li>
<li class="chapter" data-level="6.13" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#mathematical-theory-of-factor-analysis-in-validity"><i class="fa fa-check"></i><b>6.13</b> Mathematical Theory of Factor Analysis in Validity</a>
<ul>
<li class="chapter" data-level="6.13.1" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#theoretical-framework-for-factor-based-validity"><i class="fa fa-check"></i><b>6.13.1</b> Theoretical Framework for Factor-Based Validity</a></li>
</ul></li>
<li class="chapter" data-level="6.14" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#summary-and-integration"><i class="fa fa-check"></i><b>6.14</b> Summary and Integration</a>
<ul>
<li class="chapter" data-level="6.14.1" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#future-directions"><i class="fa fa-check"></i><b>6.14.1</b> Future Directions</a></li>
</ul></li>
<li class="chapter" data-level="6.15" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#selection-and-classification-with-multiple-predictors"><i class="fa fa-check"></i><b>6.15</b> Selection and Classification with Multiple Predictors</a>
<ul>
<li class="chapter" data-level="6.15.1" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#multiple-regression-approaches"><i class="fa fa-check"></i><b>6.15.1</b> Multiple Regression Approaches</a></li>
<li class="chapter" data-level="6.15.2" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#cross-validation-and-shrinkage"><i class="fa fa-check"></i><b>6.15.2</b> Cross-Validation and Shrinkage</a></li>
</ul></li>
<li class="chapter" data-level="6.16" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#validation-and-irt"><i class="fa fa-check"></i><b>6.16</b> Validation and IRT</a>
<ul>
<li class="chapter" data-level="6.16.1" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#dif-as-a-validity-threat"><i class="fa fa-check"></i><b>6.16.1</b> DIF as a Validity Threat</a></li>
<li class="chapter" data-level="6.16.2" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#irt-based-validity-evidence"><i class="fa fa-check"></i><b>6.16.2</b> IRT-Based Validity Evidence</a></li>
</ul></li>
<li class="chapter" data-level="6.17" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#conclusion-2"><i class="fa fa-check"></i><b>6.17</b> Conclusion</a></li>
<li class="chapter" data-level="6.18" data-path="validity-and-validation-tests.html"><a href="validity-and-validation-tests.html#references-4"><i class="fa fa-check"></i><b>6.18</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i><b>7</b> Principal Component Analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#the-mathematical-foundations-of-pca"><i class="fa fa-check"></i><b>7.1</b> The Mathematical Foundations of PCA</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#data-representation-the-data-matrix"><i class="fa fa-check"></i><b>7.1.1</b> Data Representation: The Data Matrix</a></li>
<li class="chapter" data-level="7.1.2" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#centering-the-data"><i class="fa fa-check"></i><b>7.1.2</b> Centering the Data</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#core-concepts-variance-covariance-and-the-covariance-matrix"><i class="fa fa-check"></i><b>7.2</b> Core Concepts: Variance, Covariance, and the Covariance Matrix</a></li>
<li class="chapter" data-level="7.3" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#the-goal-of-pca-finding-new-bases"><i class="fa fa-check"></i><b>7.3</b> The Goal of PCA: Finding New Bases</a></li>
<li class="chapter" data-level="7.4" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#eigenvectors-and-eigenvalues-the-heart-of-pca"><i class="fa fa-check"></i><b>7.4</b> Eigenvectors and Eigenvalues: The Heart of PCA</a></li>
<li class="chapter" data-level="7.5" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#geometric-interpretation"><i class="fa fa-check"></i><b>7.5</b> Geometric Interpretation</a></li>
<li class="chapter" data-level="7.6" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#steps-in-performing-pca-mathematical-summary"><i class="fa fa-check"></i><b>7.6</b> Steps in Performing PCA (Mathematical Summary)</a></li>
<li class="chapter" data-level="7.7" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#interpreting-pca-results"><i class="fa fa-check"></i><b>7.7</b> Interpreting PCA Results</a></li>
<li class="chapter" data-level="7.8" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#practical-example-of-pca-in-r"><i class="fa fa-check"></i><b>7.8</b> Practical Example of PCA in R</a></li>
<li class="chapter" data-level="7.9" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#performing-pca"><i class="fa fa-check"></i><b>7.9</b> Performing PCA</a></li>
<li class="chapter" data-level="7.10" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#scree-plot-deciding-on-the-number-of-components"><i class="fa fa-check"></i><b>7.10</b> Scree Plot: Deciding on the Number of Components</a></li>
<li class="chapter" data-level="7.11" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#loadings-interpreting-the-components"><i class="fa fa-check"></i><b>7.11</b> Loadings: Interpreting the Components</a></li>
<li class="chapter" data-level="7.12" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#component-scores"><i class="fa fa-check"></i><b>7.12</b> Component Scores</a></li>
<li class="chapter" data-level="7.13" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#assumptions-and-limitations-of-pca"><i class="fa fa-check"></i><b>7.13</b> Assumptions and Limitations of PCA</a></li>
<li class="chapter" data-level="7.14" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#pca-vs.-factor-analysis-fa"><i class="fa fa-check"></i><b>7.14</b> PCA vs. Factor Analysis (FA)</a></li>
<li class="chapter" data-level="7.15" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#conclusion-3"><i class="fa fa-check"></i><b>7.15</b> Conclusion</a></li>
<li class="chapter" data-level="7.16" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#references-5"><i class="fa fa-check"></i><b>7.16</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chi-square.html"><a href="chi-square.html"><i class="fa fa-check"></i><b>8</b> Understanding Chi-Square Tests: A Foundation for Categorical Data Analysis in Psychology</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chi-square.html"><a href="chi-square.html#what-are-chi-square-tests"><i class="fa fa-check"></i><b>8.1</b> What Are Chi-Square Tests?</a></li>
<li class="chapter" data-level="8.2" data-path="chi-square.html"><a href="chi-square.html#the-three-main-types-of-chi-square-tests"><i class="fa fa-check"></i><b>8.2</b> The Three Main Types of Chi-Square Tests</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="chi-square.html"><a href="chi-square.html#chi-square-goodness-of-fit-test-testing-single-variable-distributions"><i class="fa fa-check"></i><b>8.2.1</b> Chi-Square Goodness-of-Fit Test: Testing Single Variable Distributions</a></li>
<li class="chapter" data-level="8.2.2" data-path="chi-square.html"><a href="chi-square.html#chi-square-test-of-independence-exploring-relationships-between-variables"><i class="fa fa-check"></i><b>8.2.2</b> Chi-Square Test of Independence: Exploring Relationships Between Variables</a></li>
<li class="chapter" data-level="8.2.3" data-path="chi-square.html"><a href="chi-square.html#chi-square-test-of-homogeneity-comparing-distributions-across-groups"><i class="fa fa-check"></i><b>8.2.3</b> Chi-Square Test of Homogeneity: Comparing Distributions Across Groups</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="chi-square.html"><a href="chi-square.html#practical-example-goodness-of-fit-test-in-personality-research"><i class="fa fa-check"></i><b>8.3</b> Practical Example: Goodness-of-Fit Test in Personality Research</a></li>
<li class="chapter" data-level="8.4" data-path="chi-square.html"><a href="chi-square.html#practical-example-test-of-independence-in-therapy-research"><i class="fa fa-check"></i><b>8.4</b> Practical Example: Test of Independence in Therapy Research</a></li>
<li class="chapter" data-level="8.5" data-path="chi-square.html"><a href="chi-square.html#understanding-assumptions-and-requirements"><i class="fa fa-check"></i><b>8.5</b> Understanding Assumptions and Requirements</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="chi-square.html"><a href="chi-square.html#critical-assumptions-for-valid-chi-square-tests"><i class="fa fa-check"></i><b>8.5.1</b> Critical Assumptions for Valid Chi-Square Tests</a></li>
<li class="chapter" data-level="8.5.2" data-path="chi-square.html"><a href="chi-square.html#sample-size-considerations-and-power"><i class="fa fa-check"></i><b>8.5.2</b> Sample Size Considerations and Power</a></li>
<li class="chapter" data-level="8.5.3" data-path="chi-square.html"><a href="chi-square.html#yates-continuity-correction-for-small-samples"><i class="fa fa-check"></i><b>8.5.3</b> Yates’ Continuity Correction for Small Samples</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="chi-square.html"><a href="chi-square.html#advanced-applications-mcnemars-test-for-paired-data"><i class="fa fa-check"></i><b>8.6</b> Advanced Applications: McNemar’s Test for Paired Data</a></li>
<li class="chapter" data-level="8.7" data-path="chi-square.html"><a href="chi-square.html#effect-size-measures-understanding-practical-significance"><i class="fa fa-check"></i><b>8.7</b> Effect Size Measures: Understanding Practical Significance</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="validity_validation.html"><a href="#phi-coefficient-%CF%86-for-22-tables"><i class="fa fa-check"></i><b>8.7.1</b> Phi Coefficient (φ) for 2×2 Tables</a></li>
<li class="chapter" data-level="8.7.2" data-path="chi-square.html"><a href="chi-square.html#cramers-v-for-larger-tables"><i class="fa fa-check"></i><b>8.7.2</b> Cramer’s V for Larger Tables</a></li>
<li class="chapter" data-level="8.7.3" data-path="chi-square.html"><a href="chi-square.html#contingency-coefficient-c"><i class="fa fa-check"></i><b>8.7.3</b> Contingency Coefficient (C)</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="chi-square.html"><a href="chi-square.html#psychological-applications-across-domains"><i class="fa fa-check"></i><b>8.8</b> Psychological Applications Across Domains</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="chi-square.html"><a href="chi-square.html#clinical-psychology-applications-1"><i class="fa fa-check"></i><b>8.8.1</b> Clinical Psychology Applications</a></li>
<li class="chapter" data-level="8.8.2" data-path="chi-square.html"><a href="chi-square.html#cognitive-psychology-applications-1"><i class="fa fa-check"></i><b>8.8.2</b> Cognitive Psychology Applications</a></li>
<li class="chapter" data-level="8.8.3" data-path="chi-square.html"><a href="chi-square.html#behavioral-psychology-applications-1"><i class="fa fa-check"></i><b>8.8.3</b> Behavioral Psychology Applications</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="chi-square.html"><a href="chi-square.html#alternative-tests-and-when-to-use-them"><i class="fa fa-check"></i><b>8.9</b> Alternative Tests and When to Use Them</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="chi-square.html"><a href="chi-square.html#fishers-exact-test-for-small-samples"><i class="fa fa-check"></i><b>8.9.1</b> Fisher’s Exact Test for Small Samples</a></li>
<li class="chapter" data-level="8.9.2" data-path="chi-square.html"><a href="chi-square.html#likelihood-ratio-chi-square"><i class="fa fa-check"></i><b>8.9.2</b> Likelihood Ratio Chi-Square</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="chi-square.html"><a href="chi-square.html#limitations-and-considerations"><i class="fa fa-check"></i><b>8.10</b> Limitations and Considerations</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="chi-square.html"><a href="chi-square.html#information-loss-through-categorization"><i class="fa fa-check"></i><b>8.10.1</b> Information Loss Through Categorization</a></li>
<li class="chapter" data-level="8.10.2" data-path="chi-square.html"><a href="chi-square.html#sample-size-sensitivity"><i class="fa fa-check"></i><b>8.10.2</b> Sample Size Sensitivity</a></li>
<li class="chapter" data-level="8.10.3" data-path="chi-square.html"><a href="chi-square.html#post-hoc-analysis-limitations"><i class="fa fa-check"></i><b>8.10.3</b> Post-Hoc Analysis Limitations</a></li>
<li class="chapter" data-level="8.10.4" data-path="chi-square.html"><a href="chi-square.html#assumption-violations"><i class="fa fa-check"></i><b>8.10.4</b> Assumption Violations</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="chi-square.html"><a href="chi-square.html#references-6"><i class="fa fa-check"></i><b>8.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="frequency-distributions.html"><a href="frequency-distributions.html"><i class="fa fa-check"></i><b>9</b> Making Sense of Data Patterns: Understanding Frequency Distributions in Psychology</a>
<ul>
<li class="chapter" data-level="9.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#what-are-frequency-distributions"><i class="fa fa-check"></i><b>9.1</b> What Are Frequency Distributions?</a></li>
<li class="chapter" data-level="9.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#the-four-essential-types-of-frequency-distributions"><i class="fa fa-check"></i><b>9.2</b> The Four Essential Types of Frequency Distributions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#simple-frequency-distribution-the-basic-building-block"><i class="fa fa-check"></i><b>9.2.1</b> Simple Frequency Distribution: The Basic Building Block</a></li>
<li class="chapter" data-level="9.2.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#cumulative-frequency-distribution-running-totals"><i class="fa fa-check"></i><b>9.2.2</b> Cumulative Frequency Distribution: Running Totals</a></li>
<li class="chapter" data-level="9.2.3" data-path="frequency-distributions.html"><a href="frequency-distributions.html#relative-frequency-distribution-understanding-proportions"><i class="fa fa-check"></i><b>9.2.3</b> Relative Frequency Distribution: Understanding Proportions</a></li>
<li class="chapter" data-level="9.2.4" data-path="frequency-distributions.html"><a href="frequency-distributions.html#grouped-frequency-distribution-taming-large-datasets"><i class="fa fa-check"></i><b>9.2.4</b> Grouped Frequency Distribution: Taming Large Datasets</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="frequency-distributions.html"><a href="frequency-distributions.html#real-world-example-depression-screening-in-clinical-practice"><i class="fa fa-check"></i><b>9.3</b> Real-World Example: Depression Screening in Clinical Practice</a></li>
<li class="chapter" data-level="9.4" data-path="frequency-distributions.html"><a href="frequency-distributions.html#understanding-response-patterns-in-psychological-assessment"><i class="fa fa-check"></i><b>9.4</b> Understanding Response Patterns in Psychological Assessment</a></li>
<li class="chapter" data-level="9.5" data-path="frequency-distributions.html"><a href="frequency-distributions.html#visual-representations-bringing-data-to-life"><i class="fa fa-check"></i><b>9.5</b> Visual Representations: Bringing Data to Life</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#histograms-revealing-the-shape-of-continuous-data"><i class="fa fa-check"></i><b>9.5.1</b> Histograms: Revealing the Shape of Continuous Data</a></li>
<li class="chapter" data-level="9.5.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#bar-charts-perfect-for-categorical-data"><i class="fa fa-check"></i><b>9.5.2</b> Bar Charts: Perfect for Categorical Data</a></li>
<li class="chapter" data-level="9.5.3" data-path="frequency-distributions.html"><a href="frequency-distributions.html#frequency-polygons-smooth-curves-for-comparison"><i class="fa fa-check"></i><b>9.5.3</b> Frequency Polygons: Smooth Curves for Comparison</a></li>
<li class="chapter" data-level="9.5.4" data-path="frequency-distributions.html"><a href="frequency-distributions.html#ogives-cumulative-frequency-curves"><i class="fa fa-check"></i><b>9.5.4</b> Ogives: Cumulative Frequency Curves</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="frequency-distributions.html"><a href="frequency-distributions.html#statistical-measures-quantifying-distribution-characteristics"><i class="fa fa-check"></i><b>9.6</b> Statistical Measures: Quantifying Distribution Characteristics</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#measures-of-central-tendency-finding-the-center"><i class="fa fa-check"></i><b>9.6.1</b> Measures of Central Tendency: Finding the Center</a></li>
<li class="chapter" data-level="9.6.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#measures-of-variability-understanding-spread"><i class="fa fa-check"></i><b>9.6.2</b> Measures of Variability: Understanding Spread</a></li>
<li class="chapter" data-level="9.6.3" data-path="frequency-distributions.html"><a href="frequency-distributions.html#measures-of-shape-understanding-distribution-form"><i class="fa fa-check"></i><b>9.6.3</b> Measures of Shape: Understanding Distribution Form</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="frequency-distributions.html"><a href="frequency-distributions.html#practical-applications-in-different-psychology-domains"><i class="fa fa-check"></i><b>9.7</b> Practical Applications in Different Psychology Domains</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#clinical-psychology-diagnostic-and-treatment-applications"><i class="fa fa-check"></i><b>9.7.1</b> Clinical Psychology: Diagnostic and Treatment Applications</a></li>
<li class="chapter" data-level="9.7.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#cognitive-psychology-understanding-mental-processes"><i class="fa fa-check"></i><b>9.7.2</b> Cognitive Psychology: Understanding Mental Processes</a></li>
<li class="chapter" data-level="9.7.3" data-path="frequency-distributions.html"><a href="frequency-distributions.html#behavioral-psychology-analyzing-behavior-patterns"><i class="fa fa-check"></i><b>9.7.3</b> Behavioral Psychology: Analyzing Behavior Patterns</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="frequency-distributions.html"><a href="frequency-distributions.html#understanding-distribution-shapes-and-their-psychological-meaning"><i class="fa fa-check"></i><b>9.8</b> Understanding Distribution Shapes and Their Psychological Meaning</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#normal-distribution-the-gold-standard"><i class="fa fa-check"></i><b>9.8.1</b> Normal Distribution: The Gold Standard</a></li>
<li class="chapter" data-level="9.8.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#skewed-distributions-when-data-leans-one-way"><i class="fa fa-check"></i><b>9.8.2</b> Skewed Distributions: When Data Leans One Way</a></li>
<li class="chapter" data-level="9.8.3" data-path="frequency-distributions.html"><a href="frequency-distributions.html#bimodal-and-multimodal-distributions-when-groups-hide-in-your-data"><i class="fa fa-check"></i><b>9.8.3</b> Bimodal and Multimodal Distributions: When Groups Hide in Your Data</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="frequency-distributions.html"><a href="frequency-distributions.html#creating-standardized-scores-from-frequency-distributions"><i class="fa fa-check"></i><b>9.9</b> Creating Standardized Scores from Frequency Distributions</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#z-scores-the-foundation-of-standardization"><i class="fa fa-check"></i><b>9.9.1</b> Z-Scores: The Foundation of Standardization</a></li>
<li class="chapter" data-level="9.9.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#t-scores-user-friendly-standardization"><i class="fa fa-check"></i><b>9.9.2</b> T-Scores: User-Friendly Standardization</a></li>
<li class="chapter" data-level="9.9.3" data-path="frequency-distributions.html"><a href="frequency-distributions.html#percentile-ranks-intuitive-comparisons"><i class="fa fa-check"></i><b>9.9.3</b> Percentile Ranks: Intuitive Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="frequency-distributions.html"><a href="frequency-distributions.html#applications-in-test-development-and-validation"><i class="fa fa-check"></i><b>9.10</b> Applications in Test Development and Validation</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#establishing-normative-data"><i class="fa fa-check"></i><b>9.10.1</b> Establishing Normative Data</a></li>
<li class="chapter" data-level="9.10.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#item-analysis-and-test-refinement"><i class="fa fa-check"></i><b>9.10.2</b> Item Analysis and Test Refinement</a></li>
<li class="chapter" data-level="9.10.3" data-path="frequency-distributions.html"><a href="frequency-distributions.html#diagnostic-decision-making"><i class="fa fa-check"></i><b>9.10.3</b> Diagnostic Decision Making</a></li>
</ul></li>
<li class="chapter" data-level="9.11" data-path="frequency-distributions.html"><a href="frequency-distributions.html#common-challenges-and-solutions-in-frequency-distribution-analysis"><i class="fa fa-check"></i><b>9.11</b> Common Challenges and Solutions in Frequency Distribution Analysis</a>
<ul>
<li class="chapter" data-level="9.11.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#dealing-with-extreme-scores-and-outliers"><i class="fa fa-check"></i><b>9.11.1</b> Dealing with Extreme Scores and Outliers</a></li>
<li class="chapter" data-level="9.11.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#handling-missing-data"><i class="fa fa-check"></i><b>9.11.2</b> Handling Missing Data</a></li>
<li class="chapter" data-level="9.11.3" data-path="frequency-distributions.html"><a href="frequency-distributions.html#sample-size-considerations"><i class="fa fa-check"></i><b>9.11.3</b> Sample Size Considerations</a></li>
</ul></li>
<li class="chapter" data-level="9.12" data-path="frequency-distributions.html"><a href="frequency-distributions.html#advanced-applications-and-extensions"><i class="fa fa-check"></i><b>9.12</b> Advanced Applications and Extensions</a>
<ul>
<li class="chapter" data-level="9.12.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#comparing-multiple-distributions"><i class="fa fa-check"></i><b>9.12.1</b> Comparing Multiple Distributions</a></li>
<li class="chapter" data-level="9.12.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#mixture-distribution-analysis"><i class="fa fa-check"></i><b>9.12.2</b> Mixture Distribution Analysis</a></li>
<li class="chapter" data-level="9.12.3" data-path="frequency-distributions.html"><a href="frequency-distributions.html#time-series-of-frequency-distributions"><i class="fa fa-check"></i><b>9.12.3</b> Time Series of Frequency Distributions</a></li>
</ul></li>
<li class="chapter" data-level="9.13" data-path="frequency-distributions.html"><a href="frequency-distributions.html#conclusion-the-foundation-of-psychological-measurement"><i class="fa fa-check"></i><b>9.13</b> Conclusion: The Foundation of Psychological Measurement</a></li>
<li class="chapter" data-level="9.14" data-path="frequency-distributions.html"><a href="frequency-distributions.html#references-7"><i class="fa fa-check"></i><b>9.14</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="information-entropy.html"><a href="information-entropy.html"><i class="fa fa-check"></i><b>10</b> Uncovering Hidden Patterns: Information Entropy in Psychological Measurement</a>
<ul>
<li class="chapter" data-level="10.1" data-path="information-entropy.html"><a href="information-entropy.html#what-is-information-entropy-and-why-should-psychologists-care"><i class="fa fa-check"></i><b>10.1</b> What Is Information Entropy and Why Should Psychologists Care?</a></li>
<li class="chapter" data-level="10.2" data-path="information-entropy.html"><a href="information-entropy.html#the-essential-properties-that-make-entropy-useful"><i class="fa fa-check"></i><b>10.2</b> The Essential Properties That Make Entropy Useful</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="information-entropy.html"><a href="information-entropy.html#non-negativity-information-is-never-negative"><i class="fa fa-check"></i><b>10.2.1</b> Non-Negativity: Information Is Never Negative</a></li>
<li class="chapter" data-level="10.2.2" data-path="information-entropy.html"><a href="information-entropy.html#maximum-entropy-the-point-of-greatest-uncertainty"><i class="fa fa-check"></i><b>10.2.2</b> Maximum Entropy: The Point of Greatest Uncertainty</a></li>
<li class="chapter" data-level="10.2.3" data-path="information-entropy.html"><a href="information-entropy.html#additivity-independent-information-combines-simply"><i class="fa fa-check"></i><b>10.2.3</b> Additivity: Independent Information Combines Simply</a></li>
<li class="chapter" data-level="10.2.4" data-path="information-entropy.html"><a href="information-entropy.html#conditional-entropy-information-after-learning"><i class="fa fa-check"></i><b>10.2.4</b> Conditional Entropy: Information After Learning</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="information-entropy.html"><a href="information-entropy.html#real-world-application-diagnostic-classification-in-clinical-practice"><i class="fa fa-check"></i><b>10.3</b> Real-World Application: Diagnostic Classification in Clinical Practice</a></li>
<li class="chapter" data-level="10.4" data-path="information-entropy.html"><a href="information-entropy.html#understanding-information-gain-in-psychological-assessment"><i class="fa fa-check"></i><b>10.4</b> Understanding Information Gain in Psychological Assessment</a></li>
<li class="chapter" data-level="10.5" data-path="information-entropy.html"><a href="information-entropy.html#entropy-in-test-construction-and-item-analysis"><i class="fa fa-check"></i><b>10.5</b> Entropy in Test Construction and Item Analysis</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="information-entropy.html"><a href="information-entropy.html#identifying-informative-vs.-non-informative-items"><i class="fa fa-check"></i><b>10.5.1</b> Identifying Informative vs. Non-Informative Items</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="information-entropy.html"><a href="information-entropy.html#response-pattern-analysis-detecting-problematic-responding"><i class="fa fa-check"></i><b>10.6</b> Response Pattern Analysis: Detecting Problematic Responding</a></li>
<li class="chapter" data-level="10.7" data-path="information-entropy.html"><a href="information-entropy.html#advanced-applications-in-psychological-research"><i class="fa fa-check"></i><b>10.7</b> Advanced Applications in Psychological Research</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="information-entropy.html"><a href="information-entropy.html#measuring-construct-complexity-through-factor-analysis"><i class="fa fa-check"></i><b>10.7.1</b> Measuring Construct Complexity Through Factor Analysis</a></li>
<li class="chapter" data-level="10.7.2" data-path="information-entropy.html"><a href="information-entropy.html#mutual-information-measuring-variable-relationships"><i class="fa fa-check"></i><b>10.7.2</b> Mutual Information: Measuring Variable Relationships</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="information-entropy.html"><a href="information-entropy.html#practical-applications-across-psychology-domains"><i class="fa fa-check"></i><b>10.8</b> Practical Applications Across Psychology Domains</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="information-entropy.html"><a href="information-entropy.html#clinical-psychology-treatment-outcome-prediction"><i class="fa fa-check"></i><b>10.8.1</b> Clinical Psychology: Treatment Outcome Prediction</a></li>
<li class="chapter" data-level="10.8.2" data-path="information-entropy.html"><a href="information-entropy.html#cognitive-psychology-decision-making-analysis"><i class="fa fa-check"></i><b>10.8.2</b> Cognitive Psychology: Decision-Making Analysis</a></li>
<li class="chapter" data-level="10.8.3" data-path="information-entropy.html"><a href="information-entropy.html#behavioral-psychology-response-variability-analysis"><i class="fa fa-check"></i><b>10.8.3</b> Behavioral Psychology: Response Variability Analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="information-entropy.html"><a href="information-entropy.html#advanced-entropy-measures-and-applications"><i class="fa fa-check"></i><b>10.9</b> Advanced Entropy Measures and Applications</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="information-entropy.html"><a href="information-entropy.html#differential-entropy-for-continuous-variables"><i class="fa fa-check"></i><b>10.9.1</b> Differential Entropy for Continuous Variables</a></li>
<li class="chapter" data-level="10.9.2" data-path="information-entropy.html"><a href="information-entropy.html#kullback-leibler-divergence-measuring-distribution-differences"><i class="fa fa-check"></i><b>10.9.2</b> Kullback-Leibler Divergence: Measuring Distribution Differences</a></li>
<li class="chapter" data-level="10.9.3" data-path="information-entropy.html"><a href="information-entropy.html#jensen-shannon-divergence-symmetric-distribution-comparison"><i class="fa fa-check"></i><b>10.9.3</b> Jensen-Shannon Divergence: Symmetric Distribution Comparison</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="information-entropy.html"><a href="information-entropy.html#emerging-applications-and-future-directions"><i class="fa fa-check"></i><b>10.10</b> Emerging Applications and Future Directions</a>
<ul>
<li class="chapter" data-level="10.10.1" data-path="information-entropy.html"><a href="information-entropy.html#machine-learning-integration"><i class="fa fa-check"></i><b>10.10.1</b> Machine Learning Integration</a></li>
<li class="chapter" data-level="10.10.2" data-path="information-entropy.html"><a href="information-entropy.html#network-analysis-in-psychology"><i class="fa fa-check"></i><b>10.10.2</b> Network Analysis in Psychology</a></li>
<li class="chapter" data-level="10.10.3" data-path="information-entropy.html"><a href="information-entropy.html#personalized-assessment"><i class="fa fa-check"></i><b>10.10.3</b> Personalized Assessment</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="information-entropy.html"><a href="information-entropy.html#practical-guidelines-for-using-entropy-in-psychological-research"><i class="fa fa-check"></i><b>10.11</b> Practical Guidelines for Using Entropy in Psychological Research</a>
<ul>
<li class="chapter" data-level="10.11.1" data-path="information-entropy.html"><a href="information-entropy.html#when-to-use-entropy-measures"><i class="fa fa-check"></i><b>10.11.1</b> When to Use Entropy Measures</a></li>
<li class="chapter" data-level="10.11.2" data-path="information-entropy.html"><a href="information-entropy.html#interpreting-entropy-values"><i class="fa fa-check"></i><b>10.11.2</b> Interpreting Entropy Values</a></li>
<li class="chapter" data-level="10.11.3" data-path="information-entropy.html"><a href="information-entropy.html#reporting-entropy-results"><i class="fa fa-check"></i><b>10.11.3</b> Reporting Entropy Results</a></li>
</ul></li>
<li class="chapter" data-level="10.12" data-path="information-entropy.html"><a href="information-entropy.html#limitations-and-considerations-1"><i class="fa fa-check"></i><b>10.12</b> Limitations and Considerations</a>
<ul>
<li class="chapter" data-level="10.12.1" data-path="information-entropy.html"><a href="information-entropy.html#sample-size-requirements"><i class="fa fa-check"></i><b>10.12.1</b> Sample Size Requirements</a></li>
<li class="chapter" data-level="10.12.2" data-path="information-entropy.html"><a href="information-entropy.html#independence-assumptions"><i class="fa fa-check"></i><b>10.12.2</b> Independence Assumptions</a></li>
<li class="chapter" data-level="10.12.3" data-path="information-entropy.html"><a href="information-entropy.html#cultural-and-linguistic-considerations"><i class="fa fa-check"></i><b>10.12.3</b> Cultural and Linguistic Considerations</a></li>
</ul></li>
<li class="chapter" data-level="10.13" data-path="information-entropy.html"><a href="information-entropy.html#integration-with-traditional-psychometric-approaches"><i class="fa fa-check"></i><b>10.13</b> Integration with Traditional Psychometric Approaches</a>
<ul>
<li class="chapter" data-level="10.13.1" data-path="information-entropy.html"><a href="information-entropy.html#complementing-classical-test-theory"><i class="fa fa-check"></i><b>10.13.1</b> Complementing Classical Test Theory</a></li>
<li class="chapter" data-level="10.13.2" data-path="information-entropy.html"><a href="information-entropy.html#enhancing-item-response-theory"><i class="fa fa-check"></i><b>10.13.2</b> Enhancing Item Response Theory</a></li>
</ul></li>
<li class="chapter" data-level="10.14" data-path="information-entropy.html"><a href="information-entropy.html#conclusion-the-information-revolution-in-psychological-measurement"><i class="fa fa-check"></i><b>10.14</b> Conclusion: The Information Revolution in Psychological Measurement</a></li>
<li class="chapter" data-level="10.15" data-path="information-entropy.html"><a href="information-entropy.html#references-8"><i class="fa fa-check"></i><b>10.15</b> References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mode.html"><a href="mode.html"><i class="fa fa-check"></i><b>11</b> Understanding the Mode: Finding the Most Common Values in Psychological Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="mode.html"><a href="mode.html#what-is-the-mode-and-why-does-it-matter-in-psychology"><i class="fa fa-check"></i><b>11.1</b> What Is the Mode and Why Does It Matter in Psychology?</a></li>
<li class="chapter" data-level="11.2" data-path="mode.html"><a href="mode.html#essential-properties-that-make-the-mode-unique"><i class="fa fa-check"></i><b>11.2</b> Essential Properties That Make the Mode Unique</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="mode.html"><a href="mode.html#non-uniqueness-multiple-peaks-are-possible"><i class="fa fa-check"></i><b>11.2.1</b> Non-Uniqueness: Multiple Peaks Are Possible</a></li>
<li class="chapter" data-level="11.2.2" data-path="mode.html"><a href="mode.html#resistance-to-extreme-values"><i class="fa fa-check"></i><b>11.2.2</b> Resistance to Extreme Values</a></li>
<li class="chapter" data-level="11.2.3" data-path="mode.html"><a href="mode.html#universal-applicability-across-measurement-scales"><i class="fa fa-check"></i><b>11.2.3</b> Universal Applicability Across Measurement Scales</a></li>
<li class="chapter" data-level="11.2.4" data-path="mode.html"><a href="mode.html#lack-of-algebraic-properties"><i class="fa fa-check"></i><b>11.2.4</b> Lack of Algebraic Properties</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="mode.html"><a href="mode.html#real-world-application-diagnostic-categories-in-clinical-practice"><i class="fa fa-check"></i><b>11.3</b> Real-World Application: Diagnostic Categories in Clinical Practice</a></li>
<li class="chapter" data-level="11.4" data-path="mode.html"><a href="mode.html#understanding-response-patterns-in-psychological-assessment-1"><i class="fa fa-check"></i><b>11.4</b> Understanding Response Patterns in Psychological Assessment</a></li>
<li class="chapter" data-level="11.5" data-path="mode.html"><a href="mode.html#calculating-the-mode-from-simple-to-complex"><i class="fa fa-check"></i><b>11.5</b> Calculating the Mode: From Simple to Complex</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="mode.html"><a href="mode.html#simple-mode-calculation-for-categorical-data"><i class="fa fa-check"></i><b>11.5.1</b> Simple Mode Calculation for Categorical Data</a></li>
<li class="chapter" data-level="11.5.2" data-path="mode.html"><a href="mode.html#mode-for-grouped-data-estimation-from-class-intervals"><i class="fa fa-check"></i><b>11.5.2</b> Mode for Grouped Data: Estimation from Class Intervals</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="mode.html"><a href="mode.html#comparing-mode-with-mean-and-median"><i class="fa fa-check"></i><b>11.6</b> Comparing Mode with Mean and Median</a></li>
<li class="chapter" data-level="11.7" data-path="mode.html"><a href="mode.html#advanced-applications-mixture-models-and-bimodal-distributions"><i class="fa fa-check"></i><b>11.7</b> Advanced Applications: Mixture Models and Bimodal Distributions</a></li>
<li class="chapter" data-level="11.8" data-path="mode.html"><a href="mode.html#statistical-inference-and-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>11.8</b> Statistical Inference and Bootstrap Confidence Intervals</a></li>
<li class="chapter" data-level="11.9" data-path="mode.html"><a href="mode.html#mode-applications-across-psychology-domains"><i class="fa fa-check"></i><b>11.9</b> Mode Applications Across Psychology Domains</a>
<ul>
<li class="chapter" data-level="11.9.1" data-path="mode.html"><a href="mode.html#clinical-psychology-diagnostic-and-treatment-applications-1"><i class="fa fa-check"></i><b>11.9.1</b> Clinical Psychology: Diagnostic and Treatment Applications</a></li>
<li class="chapter" data-level="11.9.2" data-path="mode.html"><a href="mode.html#cognitive-psychology-understanding-mental-processes-1"><i class="fa fa-check"></i><b>11.9.2</b> Cognitive Psychology: Understanding Mental Processes</a></li>
<li class="chapter" data-level="11.9.3" data-path="mode.html"><a href="mode.html#behavioral-psychology-analyzing-action-patterns"><i class="fa fa-check"></i><b>11.9.3</b> Behavioral Psychology: Analyzing Action Patterns</a></li>
</ul></li>
<li class="chapter" data-level="11.10" data-path="mode.html"><a href="mode.html#practical-guidelines-for-using-the-mode"><i class="fa fa-check"></i><b>11.10</b> Practical Guidelines for Using the Mode</a>
<ul>
<li class="chapter" data-level="11.10.1" data-path="mode.html"><a href="mode.html#when-the-mode-is-most-appropriate"><i class="fa fa-check"></i><b>11.10.1</b> When the Mode Is Most Appropriate</a></li>
<li class="chapter" data-level="11.10.2" data-path="mode.html"><a href="mode.html#reporting-mode-results"><i class="fa fa-check"></i><b>11.10.2</b> Reporting Mode Results</a></li>
<li class="chapter" data-level="11.10.3" data-path="mode.html"><a href="mode.html#common-pitfalls-to-avoid"><i class="fa fa-check"></i><b>11.10.3</b> Common Pitfalls to Avoid</a></li>
</ul></li>
<li class="chapter" data-level="11.11" data-path="mode.html"><a href="mode.html#integration-with-modern-statistical-approaches"><i class="fa fa-check"></i><b>11.11</b> Integration with Modern Statistical Approaches</a>
<ul>
<li class="chapter" data-level="11.11.1" data-path="mode.html"><a href="mode.html#machine-learning-applications-1"><i class="fa fa-check"></i><b>11.11.1</b> Machine Learning Applications</a></li>
<li class="chapter" data-level="11.11.2" data-path="mode.html"><a href="mode.html#bayesian-statistics"><i class="fa fa-check"></i><b>11.11.2</b> Bayesian Statistics</a></li>
<li class="chapter" data-level="11.11.3" data-path="mode.html"><a href="mode.html#meta-analysis"><i class="fa fa-check"></i><b>11.11.3</b> Meta-Analysis</a></li>
</ul></li>
<li class="chapter" data-level="11.12" data-path="mode.html"><a href="mode.html#future-directions-and-emerging-applications"><i class="fa fa-check"></i><b>11.12</b> Future Directions and Emerging Applications</a>
<ul>
<li class="chapter" data-level="11.12.1" data-path="mode.html"><a href="mode.html#big-data-psychology"><i class="fa fa-check"></i><b>11.12.1</b> Big Data Psychology</a></li>
<li class="chapter" data-level="11.12.2" data-path="mode.html"><a href="mode.html#personalized-psychology"><i class="fa fa-check"></i><b>11.12.2</b> Personalized Psychology</a></li>
<li class="chapter" data-level="11.12.3" data-path="mode.html"><a href="mode.html#cross-cultural-research"><i class="fa fa-check"></i><b>11.12.3</b> Cross-Cultural Research</a></li>
</ul></li>
<li class="chapter" data-level="11.13" data-path="mode.html"><a href="mode.html#conclusion-the-modes-unique-contribution-to-psychological-understanding"><i class="fa fa-check"></i><b>11.13</b> Conclusion: The Mode’s Unique Contribution to Psychological Understanding</a></li>
<li class="chapter" data-level="11.14" data-path="mode.html"><a href="mode.html#references-9"><i class="fa fa-check"></i><b>11.14</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="mathematical-functions-in-psychology.html"><a href="mathematical-functions-in-psychology.html"><i class="fa fa-check"></i><b>12</b> Mathematical Functions in Psychology</a>
<ul>
<li class="chapter" data-level="12.1" data-path="mathematical-functions-in-psychology.html"><a href="mathematical-functions-in-psychology.html#introduction-to-functions"><i class="fa fa-check"></i><b>12.1</b> Introduction to Functions</a></li>
<li class="chapter" data-level="12.2" data-path="mathematical-functions-in-psychology.html"><a href="mathematical-functions-in-psychology.html#basic-types-of-functions-relevant-to-psychology"><i class="fa fa-check"></i><b>12.2</b> Basic Types of Functions Relevant to Psychology</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="mathematical-functions-in-psychology.html"><a href="mathematical-functions-in-psychology.html#linear-functions"><i class="fa fa-check"></i><b>12.2.1</b> Linear Functions</a></li>
<li class="chapter" data-level="12.2.2" data-path="mathematical-functions-in-psychology.html"><a href="mathematical-functions-in-psychology.html#exponential-functions"><i class="fa fa-check"></i><b>12.2.2</b> Exponential Functions</a></li>
<li class="chapter" data-level="12.2.3" data-path="mathematical-functions-in-psychology.html"><a href="mathematical-functions-in-psychology.html#logarithmic-functions"><i class="fa fa-check"></i><b>12.2.3</b> Logarithmic Functions</a></li>
<li class="chapter" data-level="12.2.4" data-path="mathematical-functions-in-psychology.html"><a href="mathematical-functions-in-psychology.html#power-functions"><i class="fa fa-check"></i><b>12.2.4</b> Power Functions</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="mathematical-functions-in-psychology.html"><a href="mathematical-functions-in-psychology.html#interpreting-functions-in-psychological-research"><i class="fa fa-check"></i><b>12.3</b> Interpreting Functions in Psychological Research</a></li>
<li class="chapter" data-level="12.4" data-path="mathematical-functions-in-psychology.html"><a href="mathematical-functions-in-psychology.html#applications-of-functions-in-different-areas-of-psychology"><i class="fa fa-check"></i><b>12.4</b> Applications of Functions in Different Areas of Psychology</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="mathematical-functions-in-psychology.html"><a href="mathematical-functions-in-psychology.html#clinical-psychology"><i class="fa fa-check"></i><b>12.4.1</b> Clinical Psychology</a></li>
<li class="chapter" data-level="12.4.2" data-path="mathematical-functions-in-psychology.html"><a href="mathematical-functions-in-psychology.html#cognitive-psychology"><i class="fa fa-check"></i><b>12.4.2</b> Cognitive Psychology</a></li>
<li class="chapter" data-level="12.4.3" data-path="mathematical-functions-in-psychology.html"><a href="mathematical-functions-in-psychology.html#developmental-psychology"><i class="fa fa-check"></i><b>12.4.3</b> Developmental Psychology</a></li>
<li class="chapter" data-level="12.4.4" data-path="mathematical-functions-in-psychology.html"><a href="mathematical-functions-in-psychology.html#social-psychology"><i class="fa fa-check"></i><b>12.4.4</b> Social Psychology</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="mathematical-functions-in-psychology.html"><a href="mathematical-functions-in-psychology.html#creating-and-testing-functional-models"><i class="fa fa-check"></i><b>12.5</b> Creating and Testing Functional Models</a></li>
<li class="chapter" data-level="12.6" data-path="mathematical-functions-in-psychology.html"><a href="mathematical-functions-in-psychology.html#statistical-approaches-to-functional-relationships"><i class="fa fa-check"></i><b>12.6</b> Statistical Approaches to Functional Relationships</a></li>
<li class="chapter" data-level="12.7" data-path="mathematical-functions-in-psychology.html"><a href="mathematical-functions-in-psychology.html#conclusion-4"><i class="fa fa-check"></i><b>12.7</b> Conclusion</a></li>
<li class="chapter" data-level="12.8" data-path="mathematical-functions-in-psychology.html"><a href="mathematical-functions-in-psychology.html#references-10"><i class="fa fa-check"></i><b>12.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="math-notation.html"><a href="math-notation.html"><i class="fa fa-check"></i><b>13</b> Mathematical Notation Reference Guide</a>
<ul>
<li class="chapter" data-level="13.1" data-path="math-notation.html"><a href="math-notation.html#greek-letters"><i class="fa fa-check"></i><b>13.1</b> Greek Letters</a></li>
<li class="chapter" data-level="13.2" data-path="math-notation.html"><a href="math-notation.html#subscripts-and-superscripts"><i class="fa fa-check"></i><b>13.2</b> Subscripts and Superscripts</a></li>
<li class="chapter" data-level="13.3" data-path="math-notation.html"><a href="math-notation.html#statistical-notation"><i class="fa fa-check"></i><b>13.3</b> Statistical Notation</a></li>
<li class="chapter" data-level="13.4" data-path="math-notation.html"><a href="math-notation.html#specific-to-classical-test-theory"><i class="fa fa-check"></i><b>13.4</b> Specific to Classical Test Theory</a></li>
<li class="chapter" data-level="13.5" data-path="math-notation.html"><a href="math-notation.html#mathematical-operations"><i class="fa fa-check"></i><b>13.5</b> Mathematical Operations</a></li>
<li class="chapter" data-level="13.6" data-path="math-notation.html"><a href="math-notation.html#set-notation"><i class="fa fa-check"></i><b>13.6</b> Set Notation</a></li>
<li class="chapter" data-level="13.7" data-path="math-notation.html"><a href="math-notation.html#probability-notation"><i class="fa fa-check"></i><b>13.7</b> Probability Notation</a></li>
<li class="chapter" data-level="13.8" data-path="math-notation.html"><a href="math-notation.html#scales-of-measurement"><i class="fa fa-check"></i><b>13.8</b> Scales of Measurement</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="math-notation.html"><a href="math-notation.html#nominal-scale"><i class="fa fa-check"></i><b>13.8.1</b> Nominal Scale</a></li>
<li class="chapter" data-level="13.8.2" data-path="math-notation.html"><a href="math-notation.html#ordinal-scale"><i class="fa fa-check"></i><b>13.8.2</b> Ordinal Scale</a></li>
<li class="chapter" data-level="13.8.3" data-path="math-notation.html"><a href="math-notation.html#interval-scale"><i class="fa fa-check"></i><b>13.8.3</b> Interval Scale</a></li>
<li class="chapter" data-level="13.8.4" data-path="math-notation.html"><a href="math-notation.html#ratio-scale"><i class="fa fa-check"></i><b>13.8.4</b> Ratio Scale</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="math-notation.html"><a href="math-notation.html#test-theory-formulas"><i class="fa fa-check"></i><b>13.9</b> Test Theory Formulas</a></li>
<li class="chapter" data-level="13.10" data-path="math-notation.html"><a href="math-notation.html#item-response-theory-irt-formulas"><i class="fa fa-check"></i><b>13.10</b> Item Response Theory (IRT) Formulas</a></li>
<li class="chapter" data-level="13.11" data-path="math-notation.html"><a href="math-notation.html#other-important-statistical-formulas"><i class="fa fa-check"></i><b>13.11</b> Other Important Statistical Formulas</a></li>
<li class="chapter" data-level="13.12" data-path="math-notation.html"><a href="math-notation.html#measurement-and-scaling-formulas"><i class="fa fa-check"></i><b>13.12</b> Measurement and Scaling Formulas</a></li>
<li class="chapter" data-level="13.13" data-path="math-notation.html"><a href="math-notation.html#matrix-notation"><i class="fa fa-check"></i><b>13.13</b> Matrix Notation</a></li>
<li class="chapter" data-level="13.14" data-path="math-notation.html"><a href="math-notation.html#multivariate-statistics"><i class="fa fa-check"></i><b>13.14</b> Multivariate Statistics</a></li>
<li class="chapter" data-level="13.15" data-path="math-notation.html"><a href="math-notation.html#how-to-use-this-reference-guide"><i class="fa fa-check"></i><b>13.15</b> How to Use This Reference Guide</a></li>
<li class="chapter" data-level="13.16" data-path="math-notation.html"><a href="math-notation.html#references-and-further-reading"><i class="fa fa-check"></i><b>13.16</b> References and Further Reading</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Principal Component Analysis: Unveiling the Structure of Psychological Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="validity-and-validation-tests" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Validity and Validation Tests<a href="validity-and-validation-tests.html#validity-and-validation-tests" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-2" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Introduction<a href="validity-and-validation-tests.html#introduction-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Validity represents the most fundamental concern in psychological measurement — whether a test measures what it purports to measure. Unlike reliability, which focuses on consistency, validity addresses the meaningfulness and appropriateness of inferences drawn from test scores. This chapter explores the multifaceted nature of validity, from theoretical foundations to practical validation procedures used in cognitive, clinical, and behavioral psychology.</p>
<p>The concept of validity has evolved significantly since its early conceptualization as a simple property of tests. Modern validity theory, as articulated in the Standards for Educational and Psychological Testing, views validity as a unitary concept supported by multiple sources of evidence. This unified approach recognizes that validity is not inherent in a test itself, but rather in the interpretations and uses of test scores within specific contexts.</p>
<p>Understanding validity is crucial for psychology students and researchers because invalid measures can lead to incorrect conclusions about human behavior, flawed interventions, and misguided theoretical developments. Whether developing a new measure of anxiety, validating a cognitive assessment battery, or adapting an existing instrument for a different population, the principles covered in this chapter provide the foundation for sound measurement practice.</p>
</div>
<div id="mathematical-foundations-of-validity-theory" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Mathematical Foundations of Validity Theory<a href="validity-and-validation-tests.html#mathematical-foundations-of-validity-theory" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="theoretical-framework-and-mathematical-models" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Theoretical Framework and Mathematical Models<a href="validity-and-validation-tests.html#theoretical-framework-and-mathematical-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Validity theory rests on fundamental mathematical relationships between observed scores, true scores, and construct domains. Let us define the core mathematical framework:</p>
<p><strong>Definition 1: Construct Domain</strong>
Let <span class="math inline">\(\Theta\)</span> represent the theoretical construct domain, where <span class="math inline">\(\theta \in \Theta\)</span> represents any possible manifestation of the construct. For a multidimensional construct with <span class="math inline">\(k\)</span> dimensions, we have:</p>
<p><span class="math display">\[\theta = (\theta_1, \theta_2, ..., \theta_k)^T\]</span></p>
<p>where each <span class="math inline">\(\theta_i\)</span> represents a specific facet of the construct.</p>
<p><strong>Definition 2: Operational Definition</strong>
An operational definition creates a mapping function <span class="math inline">\(f: \Theta \rightarrow X\)</span>, where <span class="math inline">\(X\)</span> is the observable score space. The validity of this mapping depends on how well <span class="math inline">\(f(\theta)\)</span> captures the essential characteristics of <span class="math inline">\(\theta\)</span>.</p>
<p><strong>Definition 3: Construct Representation</strong>
The degree of construct representation can be quantified using the coverage coefficient:</p>
<p><span class="math display">\[C = \frac{\sum_{i=1}^{k} w_i \cdot I_i}{\sum_{i=1}^{k} w_i}\]</span></p>
<p>where:
- <span class="math inline">\(w_i\)</span> = theoretical importance weight of dimension <span class="math inline">\(i\)</span>
- <span class="math inline">\(I_i\)</span> = indicator variable (1 if dimension <span class="math inline">\(i\)</span> is measured, 0 otherwise)</p>
</div>
</div>
<div id="problems-of-validity" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Problems of Validity<a href="validity-and-validation-tests.html#problems-of-validity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-challenge-of-construct-representation" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> The Challenge of Construct Representation<a href="validity-and-validation-tests.html#the-challenge-of-construct-representation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The fundamental challenge in validity is the <strong>representation problem</strong>: ensuring that our operational definition adequately captures the theoretical construct space. This can be formalized as an optimization problem.</p>
<p><strong>Mathematical Formulation:</strong>
Given a construct <span class="math inline">\(\Theta\)</span> with true score function <span class="math inline">\(T(\theta)\)</span> and observed score function <span class="math inline">\(X(\theta, \epsilon)\)</span> where <span class="math inline">\(\epsilon\)</span> represents measurement error, we want to minimize:</p>
<p><span class="math display">\[L = E[T(\theta) - X(\theta, \epsilon)]^2 + \lambda \cdot \text{Complexity}(X)\]</span></p>
<p>where <span class="math inline">\(\lambda\)</span> is a regularization parameter controlling the trade-off between accuracy and complexity.</p>
</div>
<div id="construct-underrepresentation-mathematical-analysis" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Construct Underrepresentation: Mathematical Analysis<a href="validity-and-validation-tests.html#construct-underrepresentation-mathematical-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Theorem 1: Underrepresentation Bias</strong>
When a test samples only a subset <span class="math inline">\(S \subset \Theta\)</span> of the construct domain, the validity coefficient is attenuated by:</p>
<p><span class="math display">\[\rho_{XY,\text{observed}} = \rho_{XY,\text{true}} \cdot \sqrt{\frac{\text{Var}(T_S)}{\text{Var}(T_\Theta)}}\]</span></p>
<p>where:
- <span class="math inline">\(T_S\)</span> = true score based on subset <span class="math inline">\(S\)</span>
- <span class="math inline">\(T_\Theta\)</span> = true score based on complete domain <span class="math inline">\(\Theta\)</span></p>
<p><strong>Proof:</strong>
Let <span class="math inline">\(T_\Theta = \sum_{i=1}^{k} w_i T_i\)</span> be the complete true score and <span class="math inline">\(T_S = \sum_{i \in S} w_i T_i\)</span> be the subset true score.</p>
<p>The variance ratio is:
<span class="math display">\[\frac{\text{Var}(T_S)}{\text{Var}(T_\Theta)} = \frac{\sum_{i \in S} \sum_{j \in S} w_i w_j \sigma_{ij}}{\sum_{i=1}^{k} \sum_{j=1}^{k} w_i w_j \sigma_{ij}}\]</span></p>
<p>This demonstrates that systematic undersampling of the construct domain leads to predictable attenuation in validity coefficients.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="validity-and-validation-tests.html#cb125-1" tabindex="-1"></a><span class="co"># Mathematical demonstration of construct underrepresentation</span></span>
<span id="cb125-2"><a href="validity-and-validation-tests.html#cb125-2" tabindex="-1"></a><span class="co"># This simulation demonstrates Theorem 1 mathematically</span></span>
<span id="cb125-3"><a href="validity-and-validation-tests.html#cb125-3" tabindex="-1"></a></span>
<span id="cb125-4"><a href="validity-and-validation-tests.html#cb125-4" tabindex="-1"></a><span class="co"># Define construct parameters</span></span>
<span id="cb125-5"><a href="validity-and-validation-tests.html#cb125-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb125-6"><a href="validity-and-validation-tests.html#cb125-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb125-7"><a href="validity-and-validation-tests.html#cb125-7" tabindex="-1"></a></span>
<span id="cb125-8"><a href="validity-and-validation-tests.html#cb125-8" tabindex="-1"></a><span class="co"># Complete construct has 4 correlated components</span></span>
<span id="cb125-9"><a href="validity-and-validation-tests.html#cb125-9" tabindex="-1"></a><span class="co"># Construct correlation matrix (population parameters)</span></span>
<span id="cb125-10"><a href="validity-and-validation-tests.html#cb125-10" tabindex="-1"></a>construct_correlations <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb125-11"><a href="validity-and-validation-tests.html#cb125-11" tabindex="-1"></a>  <span class="fl">1.0</span>, <span class="fl">0.6</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span>,</span>
<span id="cb125-12"><a href="validity-and-validation-tests.html#cb125-12" tabindex="-1"></a>  <span class="fl">0.6</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>,</span>
<span id="cb125-13"><a href="validity-and-validation-tests.html#cb125-13" tabindex="-1"></a>  <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">0.4</span>,</span>
<span id="cb125-14"><a href="validity-and-validation-tests.html#cb125-14" tabindex="-1"></a>  <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">1.0</span></span>
<span id="cb125-15"><a href="validity-and-validation-tests.html#cb125-15" tabindex="-1"></a>), <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb125-16"><a href="validity-and-validation-tests.html#cb125-16" tabindex="-1"></a></span>
<span id="cb125-17"><a href="validity-and-validation-tests.html#cb125-17" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Population Construct Correlation Matrix:&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;Population Construct Correlation Matrix:&quot;</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="validity-and-validation-tests.html#cb127-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(construct_correlations, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>     [,1] [,2] [,3] [,4]
[1,]  1.0  0.6  0.5  0.4
[2,]  0.6  1.0  0.5  0.3
[3,]  0.5  0.5  1.0  0.4
[4,]  0.4  0.3  0.4  1.0</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="validity-and-validation-tests.html#cb129-1" tabindex="-1"></a><span class="co"># Theoretical weights for complete construct</span></span>
<span id="cb129-2"><a href="validity-and-validation-tests.html#cb129-2" tabindex="-1"></a>true_weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>)  <span class="co"># Importance weights</span></span>
<span id="cb129-3"><a href="validity-and-validation-tests.html#cb129-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Theoretical component weights:&quot;</span>, <span class="fu">paste</span>(true_weights, <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>)))</span></code></pre></div>
<pre><code>[1] &quot;Theoretical component weights: 0.4, 0.3, 0.2, 0.1&quot;</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="validity-and-validation-tests.html#cb131-1" tabindex="-1"></a><span class="co"># Generate true component scores using Cholesky decomposition</span></span>
<span id="cb131-2"><a href="validity-and-validation-tests.html#cb131-2" tabindex="-1"></a>chol_decomp <span class="ot">&lt;-</span> <span class="fu">chol</span>(construct_correlations)</span>
<span id="cb131-3"><a href="validity-and-validation-tests.html#cb131-3" tabindex="-1"></a>uncorr_components <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> <span class="dv">4</span>), <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb131-4"><a href="validity-and-validation-tests.html#cb131-4" tabindex="-1"></a>true_components <span class="ot">&lt;-</span> uncorr_components <span class="sc">%*%</span> chol_decomp</span>
<span id="cb131-5"><a href="validity-and-validation-tests.html#cb131-5" tabindex="-1"></a></span>
<span id="cb131-6"><a href="validity-and-validation-tests.html#cb131-6" tabindex="-1"></a><span class="co"># Calculate complete true score</span></span>
<span id="cb131-7"><a href="validity-and-validation-tests.html#cb131-7" tabindex="-1"></a>complete_true_score <span class="ot">&lt;-</span> true_components <span class="sc">%*%</span> true_weights</span>
<span id="cb131-8"><a href="validity-and-validation-tests.html#cb131-8" tabindex="-1"></a></span>
<span id="cb131-9"><a href="validity-and-validation-tests.html#cb131-9" tabindex="-1"></a><span class="co"># Generate external criterion (what we&#39;re trying to predict)</span></span>
<span id="cb131-10"><a href="validity-and-validation-tests.html#cb131-10" tabindex="-1"></a>criterion_loading <span class="ot">&lt;-</span> <span class="fl">0.8</span>  <span class="co"># True relationship strength</span></span>
<span id="cb131-11"><a href="validity-and-validation-tests.html#cb131-11" tabindex="-1"></a>external_criterion <span class="ot">&lt;-</span> criterion_loading <span class="sc">*</span> complete_true_score <span class="sc">+</span> </span>
<span id="cb131-12"><a href="validity-and-validation-tests.html#cb131-12" tabindex="-1"></a>                      <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> criterion_loading<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb131-13"><a href="validity-and-validation-tests.html#cb131-13" tabindex="-1"></a></span>
<span id="cb131-14"><a href="validity-and-validation-tests.html#cb131-14" tabindex="-1"></a><span class="co"># Calculate theoretical maximum validity</span></span>
<span id="cb131-15"><a href="validity-and-validation-tests.html#cb131-15" tabindex="-1"></a>max_validity <span class="ot">&lt;-</span> <span class="fu">cor</span>(complete_true_score, external_criterion)</span>
<span id="cb131-16"><a href="validity-and-validation-tests.html#cb131-16" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Maximum possible validity (complete construct):&quot;</span>, <span class="fu">round</span>(max_validity, <span class="dv">4</span>)))</span></code></pre></div>
<pre><code>[1] &quot;Maximum possible validity (complete construct): 0.7566&quot;</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="validity-and-validation-tests.html#cb133-1" tabindex="-1"></a><span class="co"># Now simulate different levels of construct underrepresentation</span></span>
<span id="cb133-2"><a href="validity-and-validation-tests.html#cb133-2" tabindex="-1"></a>underrep_scenarios <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb133-3"><a href="validity-and-validation-tests.html#cb133-3" tabindex="-1"></a>  <span class="st">&quot;Complete (4 components)&quot;</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb133-4"><a href="validity-and-validation-tests.html#cb133-4" tabindex="-1"></a>  <span class="st">&quot;Major underrep (3 components)&quot;</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,  <span class="co"># Missing least important</span></span>
<span id="cb133-5"><a href="validity-and-validation-tests.html#cb133-5" tabindex="-1"></a>  <span class="st">&quot;Moderate underrep (2 components)&quot;</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,  <span class="co"># Missing two least important</span></span>
<span id="cb133-6"><a href="validity-and-validation-tests.html#cb133-6" tabindex="-1"></a>  <span class="st">&quot;Severe underrep (1 component)&quot;</span> <span class="ot">=</span> <span class="dv">1</span>    <span class="co"># Only most important</span></span>
<span id="cb133-7"><a href="validity-and-validation-tests.html#cb133-7" tabindex="-1"></a>)</span>
<span id="cb133-8"><a href="validity-and-validation-tests.html#cb133-8" tabindex="-1"></a></span>
<span id="cb133-9"><a href="validity-and-validation-tests.html#cb133-9" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb133-10"><a href="validity-and-validation-tests.html#cb133-10" tabindex="-1"></a>  <span class="at">Scenario =</span> <span class="fu">character</span>(),</span>
<span id="cb133-11"><a href="validity-and-validation-tests.html#cb133-11" tabindex="-1"></a>  <span class="at">Components_Included =</span> <span class="fu">character</span>(),</span>
<span id="cb133-12"><a href="validity-and-validation-tests.html#cb133-12" tabindex="-1"></a>  <span class="at">Variance_Ratio =</span> <span class="fu">numeric</span>(),</span>
<span id="cb133-13"><a href="validity-and-validation-tests.html#cb133-13" tabindex="-1"></a>  <span class="at">Predicted_Validity =</span> <span class="fu">numeric</span>(),</span>
<span id="cb133-14"><a href="validity-and-validation-tests.html#cb133-14" tabindex="-1"></a>  <span class="at">Observed_Validity =</span> <span class="fu">numeric</span>(),</span>
<span id="cb133-15"><a href="validity-and-validation-tests.html#cb133-15" tabindex="-1"></a>  <span class="at">Attenuation_Factor =</span> <span class="fu">numeric</span>(),</span>
<span id="cb133-16"><a href="validity-and-validation-tests.html#cb133-16" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb133-17"><a href="validity-and-validation-tests.html#cb133-17" tabindex="-1"></a>)</span>
<span id="cb133-18"><a href="validity-and-validation-tests.html#cb133-18" tabindex="-1"></a></span>
<span id="cb133-19"><a href="validity-and-validation-tests.html#cb133-19" tabindex="-1"></a><span class="cf">for</span>(scenario_name <span class="cf">in</span> <span class="fu">names</span>(underrep_scenarios)) {</span>
<span id="cb133-20"><a href="validity-and-validation-tests.html#cb133-20" tabindex="-1"></a>  components <span class="ot">&lt;-</span> underrep_scenarios[[scenario_name]]</span>
<span id="cb133-21"><a href="validity-and-validation-tests.html#cb133-21" tabindex="-1"></a>  </span>
<span id="cb133-22"><a href="validity-and-validation-tests.html#cb133-22" tabindex="-1"></a>  <span class="co"># Calculate subset true score</span></span>
<span id="cb133-23"><a href="validity-and-validation-tests.html#cb133-23" tabindex="-1"></a>  subset_weights <span class="ot">&lt;-</span> true_weights[components]</span>
<span id="cb133-24"><a href="validity-and-validation-tests.html#cb133-24" tabindex="-1"></a>  subset_true_score <span class="ot">&lt;-</span> true_components[, components, drop <span class="ot">=</span> <span class="cn">FALSE</span>] <span class="sc">%*%</span> subset_weights</span>
<span id="cb133-25"><a href="validity-and-validation-tests.html#cb133-25" tabindex="-1"></a>  </span>
<span id="cb133-26"><a href="validity-and-validation-tests.html#cb133-26" tabindex="-1"></a>  <span class="co"># Calculate variance ratio (Theorem 1)</span></span>
<span id="cb133-27"><a href="validity-and-validation-tests.html#cb133-27" tabindex="-1"></a>  var_ratio <span class="ot">&lt;-</span> <span class="fu">var</span>(subset_true_score) <span class="sc">/</span> <span class="fu">var</span>(complete_true_score)</span>
<span id="cb133-28"><a href="validity-and-validation-tests.html#cb133-28" tabindex="-1"></a>  </span>
<span id="cb133-29"><a href="validity-and-validation-tests.html#cb133-29" tabindex="-1"></a>  <span class="co"># Predict validity using Theorem 1</span></span>
<span id="cb133-30"><a href="validity-and-validation-tests.html#cb133-30" tabindex="-1"></a>  predicted_validity <span class="ot">&lt;-</span> max_validity <span class="sc">*</span> <span class="fu">sqrt</span>(var_ratio)</span>
<span id="cb133-31"><a href="validity-and-validation-tests.html#cb133-31" tabindex="-1"></a>  </span>
<span id="cb133-32"><a href="validity-and-validation-tests.html#cb133-32" tabindex="-1"></a>  <span class="co"># Calculate observed validity</span></span>
<span id="cb133-33"><a href="validity-and-validation-tests.html#cb133-33" tabindex="-1"></a>  observed_validity <span class="ot">&lt;-</span> <span class="fu">cor</span>(subset_true_score, external_criterion)</span>
<span id="cb133-34"><a href="validity-and-validation-tests.html#cb133-34" tabindex="-1"></a>  </span>
<span id="cb133-35"><a href="validity-and-validation-tests.html#cb133-35" tabindex="-1"></a>  <span class="co"># Calculate attenuation factor</span></span>
<span id="cb133-36"><a href="validity-and-validation-tests.html#cb133-36" tabindex="-1"></a>  attenuation <span class="ot">&lt;-</span> observed_validity <span class="sc">/</span> max_validity</span>
<span id="cb133-37"><a href="validity-and-validation-tests.html#cb133-37" tabindex="-1"></a>  </span>
<span id="cb133-38"><a href="validity-and-validation-tests.html#cb133-38" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(</span>
<span id="cb133-39"><a href="validity-and-validation-tests.html#cb133-39" tabindex="-1"></a>    <span class="at">Scenario =</span> scenario_name,</span>
<span id="cb133-40"><a href="validity-and-validation-tests.html#cb133-40" tabindex="-1"></a>    <span class="at">Components_Included =</span> <span class="fu">paste</span>(components, <span class="at">collapse =</span> <span class="st">&quot;,&quot;</span>),</span>
<span id="cb133-41"><a href="validity-and-validation-tests.html#cb133-41" tabindex="-1"></a>    <span class="at">Variance_Ratio =</span> var_ratio,</span>
<span id="cb133-42"><a href="validity-and-validation-tests.html#cb133-42" tabindex="-1"></a>    <span class="at">Predicted_Validity =</span> predicted_validity,</span>
<span id="cb133-43"><a href="validity-and-validation-tests.html#cb133-43" tabindex="-1"></a>    <span class="at">Observed_Validity =</span> observed_validity,</span>
<span id="cb133-44"><a href="validity-and-validation-tests.html#cb133-44" tabindex="-1"></a>    <span class="at">Attenuation_Factor =</span> attenuation</span>
<span id="cb133-45"><a href="validity-and-validation-tests.html#cb133-45" tabindex="-1"></a>  ))</span>
<span id="cb133-46"><a href="validity-and-validation-tests.html#cb133-46" tabindex="-1"></a>}</span>
<span id="cb133-47"><a href="validity-and-validation-tests.html#cb133-47" tabindex="-1"></a></span>
<span id="cb133-48"><a href="validity-and-validation-tests.html#cb133-48" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Construct Underrepresentation Analysis:&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;Construct Underrepresentation Analysis:&quot;</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="validity-and-validation-tests.html#cb135-1" tabindex="-1"></a><span class="co"># Round only numeric columns for display</span></span>
<span id="cb135-2"><a href="validity-and-validation-tests.html#cb135-2" tabindex="-1"></a>results_display <span class="ot">&lt;-</span> results</span>
<span id="cb135-3"><a href="validity-and-validation-tests.html#cb135-3" tabindex="-1"></a>numeric_cols <span class="ot">&lt;-</span> <span class="fu">sapply</span>(results, is.numeric)</span>
<span id="cb135-4"><a href="validity-and-validation-tests.html#cb135-4" tabindex="-1"></a>results_display[numeric_cols] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(results[numeric_cols], round, <span class="dv">4</span>)</span>
<span id="cb135-5"><a href="validity-and-validation-tests.html#cb135-5" tabindex="-1"></a><span class="fu">print</span>(results_display)</span></code></pre></div>
<pre><code>                          Scenario Components_Included Variance_Ratio
1          Complete (4 components)             1,2,3,4         1.0000
2    Major underrep (3 components)               1,2,3         0.8847
3 Moderate underrep (2 components)                 1,2         0.6107
4    Severe underrep (1 component)                   1         0.2323
  Predicted_Validity Observed_Validity Attenuation_Factor
1             0.7566            0.7566             1.0000
2             0.7116            0.7533             0.9957
3             0.5912            0.7368             0.9739
4             0.3646            0.6637             0.8773</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="validity-and-validation-tests.html#cb137-1" tabindex="-1"></a><span class="co"># Verify Theorem 1 predictions</span></span>
<span id="cb137-2"><a href="validity-and-validation-tests.html#cb137-2" tabindex="-1"></a>results<span class="sc">$</span>Prediction_Error <span class="ot">&lt;-</span> <span class="fu">abs</span>(results<span class="sc">$</span>Predicted_Validity <span class="sc">-</span> results<span class="sc">$</span>Observed_Validity)</span>
<span id="cb137-3"><a href="validity-and-validation-tests.html#cb137-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean prediction error:&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(results<span class="sc">$</span>Prediction_Error), <span class="dv">6</span>)))</span></code></pre></div>
<pre><code>[1] &quot;Mean prediction error: 0.121586&quot;</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="validity-and-validation-tests.html#cb139-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;(Small error confirms Theorem 1)&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;(Small error confirms Theorem 1)&quot;</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="validity-and-validation-tests.html#cb141-1" tabindex="-1"></a><span class="co"># Create visualization showing mathematical relationship</span></span>
<span id="cb141-2"><a href="validity-and-validation-tests.html#cb141-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb141-3"><a href="validity-and-validation-tests.html#cb141-3" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;theme_psych_book.R&quot;</span>)</span>
<span id="cb141-4"><a href="validity-and-validation-tests.html#cb141-4" tabindex="-1"></a></span>
<span id="cb141-5"><a href="validity-and-validation-tests.html#cb141-5" tabindex="-1"></a><span class="co"># Prepare data for plotting</span></span>
<span id="cb141-6"><a href="validity-and-validation-tests.html#cb141-6" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb141-7"><a href="validity-and-validation-tests.html#cb141-7" tabindex="-1"></a>  <span class="at">Scenario =</span> <span class="fu">factor</span>(results<span class="sc">$</span>Scenario, <span class="at">levels =</span> results<span class="sc">$</span>Scenario),</span>
<span id="cb141-8"><a href="validity-and-validation-tests.html#cb141-8" tabindex="-1"></a>  <span class="at">Theoretical_Maximum =</span> max_validity,</span>
<span id="cb141-9"><a href="validity-and-validation-tests.html#cb141-9" tabindex="-1"></a>  <span class="at">Predicted_by_Theory =</span> results<span class="sc">$</span>Predicted_Validity,</span>
<span id="cb141-10"><a href="validity-and-validation-tests.html#cb141-10" tabindex="-1"></a>  <span class="at">Observed_Validity =</span> results<span class="sc">$</span>Observed_Validity</span>
<span id="cb141-11"><a href="validity-and-validation-tests.html#cb141-11" tabindex="-1"></a>)</span>
<span id="cb141-12"><a href="validity-and-validation-tests.html#cb141-12" tabindex="-1"></a></span>
<span id="cb141-13"><a href="validity-and-validation-tests.html#cb141-13" tabindex="-1"></a><span class="co"># Reshape for plotting</span></span>
<span id="cb141-14"><a href="validity-and-validation-tests.html#cb141-14" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb141-15"><a href="validity-and-validation-tests.html#cb141-15" tabindex="-1"></a>plot_long <span class="ot">&lt;-</span> plot_data <span class="sc">%&gt;%</span></span>
<span id="cb141-16"><a href="validity-and-validation-tests.html#cb141-16" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Theoretical_Maximum, Predicted_by_Theory, Observed_Validity),</span>
<span id="cb141-17"><a href="validity-and-validation-tests.html#cb141-17" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Validity&quot;</span>)</span>
<span id="cb141-18"><a href="validity-and-validation-tests.html#cb141-18" tabindex="-1"></a></span>
<span id="cb141-19"><a href="validity-and-validation-tests.html#cb141-19" tabindex="-1"></a><span class="fu">ggplot</span>(plot_long, <span class="fu">aes</span>(<span class="at">x =</span> Scenario, <span class="at">y =</span> Validity, <span class="at">fill =</span> Type)) <span class="sc">+</span></span>
<span id="cb141-20"><a href="validity-and-validation-tests.html#cb141-20" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb141-21"><a href="validity-and-validation-tests.html#cb141-21" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">get_palette</span>(<span class="dv">3</span>),</span>
<span id="cb141-22"><a href="validity-and-validation-tests.html#cb141-22" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Observed Validity&quot;</span>, <span class="st">&quot;Predicted by Theorem 1&quot;</span>, <span class="st">&quot;Theoretical Maximum&quot;</span>)) <span class="sc">+</span></span>
<span id="cb141-23"><a href="validity-and-validation-tests.html#cb141-23" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Mathematical Analysis of Construct Underrepresentation&quot;</span>,</span>
<span id="cb141-24"><a href="validity-and-validation-tests.html#cb141-24" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Theorem 1: Validity attenuation follows ρ = ρ_max × √(Var_subset/Var_complete)&quot;</span>,</span>
<span id="cb141-25"><a href="validity-and-validation-tests.html#cb141-25" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Underrepresentation Scenario&quot;</span>,</span>
<span id="cb141-26"><a href="validity-and-validation-tests.html#cb141-26" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Validity Coefficient&quot;</span>,</span>
<span id="cb141-27"><a href="validity-and-validation-tests.html#cb141-27" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Validity Type&quot;</span>,</span>
<span id="cb141-28"><a href="validity-and-validation-tests.html#cb141-28" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Error bars show theoretical predictions vs. observed values&quot;</span>) <span class="sc">+</span></span>
<span id="cb141-29"><a href="validity-and-validation-tests.html#cb141-29" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb141-30"><a href="validity-and-validation-tests.html#cb141-30" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb141-31"><a href="validity-and-validation-tests.html#cb141-31" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">number_format</span>(<span class="at">accuracy =</span> <span class="fl">0.01</span>))</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/construct-representation-theory-1.png" width="672" /></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="validity-and-validation-tests.html#cb142-1" tabindex="-1"></a><span class="co"># Add mathematical annotation</span></span>
<span id="cb142-2"><a href="validity-and-validation-tests.html#cb142-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== MATHEMATICAL INTERPRETATION ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>
=== MATHEMATICAL INTERPRETATION ===</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="validity-and-validation-tests.html#cb144-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Theorem 1 demonstrates that construct underrepresentation leads to systematic</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Theorem 1 demonstrates that construct underrepresentation leads to systematic</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="validity-and-validation-tests.html#cb146-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;validity attenuation following the exact formula:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>validity attenuation following the exact formula:</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="validity-and-validation-tests.html#cb148-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;ρ_observed = ρ_true × √(Variance_ratio)</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>ρ_observed = ρ_true × √(Variance_ratio)</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="validity-and-validation-tests.html#cb150-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Key findings:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Key findings:</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="validity-and-validation-tests.html#cb152-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(results)) {</span>
<span id="cb152-2"><a href="validity-and-validation-tests.html#cb152-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;- %s: %.1f%% variance retained → %.1f%% validity retained</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb152-3"><a href="validity-and-validation-tests.html#cb152-3" tabindex="-1"></a>              results<span class="sc">$</span>Scenario[i],</span>
<span id="cb152-4"><a href="validity-and-validation-tests.html#cb152-4" tabindex="-1"></a>              results<span class="sc">$</span>Variance_Ratio[i] <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb152-5"><a href="validity-and-validation-tests.html#cb152-5" tabindex="-1"></a>              results<span class="sc">$</span>Attenuation_Factor[i] <span class="sc">*</span> <span class="dv">100</span>))</span>
<span id="cb152-6"><a href="validity-and-validation-tests.html#cb152-6" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>- Complete (4 components): 100.0% variance retained → 100.0% validity retained
- Major underrep (3 components): 88.5% variance retained → 99.6% validity retained
- Moderate underrep (2 components): 61.1% variance retained → 97.4% validity retained
- Severe underrep (1 component): 23.2% variance retained → 87.7% validity retained</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="validity-and-validation-tests.html#cb154-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">This mathematical relationship allows researchers to:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>
This mathematical relationship allows researchers to:</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="validity-and-validation-tests.html#cb156-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;1. Predict validity loss from known construct sampling</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>1. Predict validity loss from known construct sampling</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="validity-and-validation-tests.html#cb158-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;2. Estimate required construct coverage for target validity</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>2. Estimate required construct coverage for target validity</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="validity-and-validation-tests.html#cb160-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;3. Correct observed validity for known underrepresentation</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>3. Correct observed validity for known underrepresentation</code></pre>
<p><strong>Clinical Implications:</strong>
In depression assessment, if we measure only cognitive symptoms (negative thoughts) but ignore somatic (fatigue, appetite) and behavioral (withdrawal, inactivity) components, Theorem 1 predicts the exact validity loss. For a depression construct where cognitive symptoms represent only 40% of the total variance, validity will be attenuated by √0.40 = 0.63, meaning a 37% loss in predictive power.</p>
</div>
<div id="construct-irrelevant-variance-mathematical-treatment" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Construct-Irrelevant Variance: Mathematical Treatment<a href="validity-and-validation-tests.html#construct-irrelevant-variance-mathematical-treatment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Definition: Construct-Irrelevant Variance Model</strong>
The observed score can be decomposed as:
<span class="math display">\[X = \alpha T + \beta I + \epsilon\]</span></p>
<p>where:
- <span class="math inline">\(T\)</span> = true score on target construct
- <span class="math inline">\(I\)</span> = irrelevant factor score<br />
- <span class="math inline">\(\epsilon\)</span> = random error
- <span class="math inline">\(\alpha, \beta\)</span> = structural coefficients</p>
<p><strong>Theorem 2: Validity Distortion Due to Irrelevant Variance</strong>
When construct-irrelevant variance is present, the observed validity coefficient is:</p>
<p><span class="math display">\[\rho_{XY} = \frac{\alpha \rho_{TY} + \beta \rho_{IY}}{\sqrt{\alpha^2 + \beta^2 + 2\alpha\beta\rho_{TI} + \sigma^2_\epsilon}}\]</span></p>
<p>where <span class="math inline">\(\rho_{TY}\)</span> is the true construct-criterion correlation and <span class="math inline">\(\rho_{IY}\)</span> is the irrelevant factor-criterion correlation.</p>
<p><strong>Corollary 2.1: Contamination Effects</strong>
- If <span class="math inline">\(\rho_{IY} &gt; \rho_{TY}\)</span>: Positive contamination (inflated validity)
- If <span class="math inline">\(\rho_{IY} &lt; \rho_{TY}\)</span>: Negative contamination (deflated validity)
- If <span class="math inline">\(\rho_{IY} = 0\)</span>: Pure attenuation by factor <span class="math inline">\(\frac{\alpha}{\sqrt{\alpha^2 + \beta^2 + \sigma^2_\epsilon}}\)</span></p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="validity-and-validation-tests.html#cb162-1" tabindex="-1"></a><span class="co"># Mathematical demonstration of construct-irrelevant variance effects</span></span>
<span id="cb162-2"><a href="validity-and-validation-tests.html#cb162-2" tabindex="-1"></a><span class="co"># This simulation tests Theorem 2 and its corollaries</span></span>
<span id="cb162-3"><a href="validity-and-validation-tests.html#cb162-3" tabindex="-1"></a></span>
<span id="cb162-4"><a href="validity-and-validation-tests.html#cb162-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb162-5"><a href="validity-and-validation-tests.html#cb162-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb162-6"><a href="validity-and-validation-tests.html#cb162-6" tabindex="-1"></a></span>
<span id="cb162-7"><a href="validity-and-validation-tests.html#cb162-7" tabindex="-1"></a><span class="co"># Population parameters for Theorem 2</span></span>
<span id="cb162-8"><a href="validity-and-validation-tests.html#cb162-8" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.8</span>    <span class="co"># Loading on target construct</span></span>
<span id="cb162-9"><a href="validity-and-validation-tests.html#cb162-9" tabindex="-1"></a>rho_TY <span class="ot">&lt;-</span> <span class="fl">0.6</span>   <span class="co"># True construct-criterion correlation</span></span>
<span id="cb162-10"><a href="validity-and-validation-tests.html#cb162-10" tabindex="-1"></a>sigma_error <span class="ot">&lt;-</span> <span class="fl">0.3</span>  <span class="co"># Random error standard deviation</span></span>
<span id="cb162-11"><a href="validity-and-validation-tests.html#cb162-11" tabindex="-1"></a></span>
<span id="cb162-12"><a href="validity-and-validation-tests.html#cb162-12" tabindex="-1"></a><span class="co"># Generate true construct and criterion</span></span>
<span id="cb162-13"><a href="validity-and-validation-tests.html#cb162-13" tabindex="-1"></a>true_construct <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">100</span>, <span class="dv">15</span>)</span>
<span id="cb162-14"><a href="validity-and-validation-tests.html#cb162-14" tabindex="-1"></a>criterion <span class="ot">&lt;-</span> rho_TY <span class="sc">*</span> true_construct <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho_TY<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">15</span>)</span>
<span id="cb162-15"><a href="validity-and-validation-tests.html#cb162-15" tabindex="-1"></a></span>
<span id="cb162-16"><a href="validity-and-validation-tests.html#cb162-16" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;=== MATHEMATICAL ANALYSIS OF CONSTRUCT-IRRELEVANT VARIANCE ===&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;=== MATHEMATICAL ANALYSIS OF CONSTRUCT-IRRELEVANT VARIANCE ===&quot;</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="validity-and-validation-tests.html#cb164-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Target construct-criterion correlation (ρ_TY):&quot;</span>, rho_TY))</span></code></pre></div>
<pre><code>[1] &quot;Target construct-criterion correlation (ρ_TY): 0.6&quot;</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="validity-and-validation-tests.html#cb166-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Construct loading (α):&quot;</span>, alpha))</span></code></pre></div>
<pre><code>[1] &quot;Construct loading (α): 0.8&quot;</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="validity-and-validation-tests.html#cb168-1" tabindex="-1"></a><span class="co"># Test different irrelevant factor scenarios</span></span>
<span id="cb168-2"><a href="validity-and-validation-tests.html#cb168-2" tabindex="-1"></a>irrelevant_scenarios <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb168-3"><a href="validity-and-validation-tests.html#cb168-3" tabindex="-1"></a>  <span class="at">Scenario =</span> <span class="fu">c</span>(<span class="st">&quot;No Contamination&quot;</span>, <span class="st">&quot;Positive Contamination&quot;</span>, <span class="st">&quot;Negative Contamination&quot;</span>, <span class="st">&quot;Neutral Contamination&quot;</span>),</span>
<span id="cb168-4"><a href="validity-and-validation-tests.html#cb168-4" tabindex="-1"></a>  <span class="at">beta =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>),</span>
<span id="cb168-5"><a href="validity-and-validation-tests.html#cb168-5" tabindex="-1"></a>  <span class="at">rho_IY =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="dv">0</span>),</span>
<span id="cb168-6"><a href="validity-and-validation-tests.html#cb168-6" tabindex="-1"></a>  <span class="at">rho_TI =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>)  <span class="co"># Modest correlation between construct and irrelevant factor</span></span>
<span id="cb168-7"><a href="validity-and-validation-tests.html#cb168-7" tabindex="-1"></a>)</span>
<span id="cb168-8"><a href="validity-and-validation-tests.html#cb168-8" tabindex="-1"></a></span>
<span id="cb168-9"><a href="validity-and-validation-tests.html#cb168-9" tabindex="-1"></a>results_irrelevant <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb168-10"><a href="validity-and-validation-tests.html#cb168-10" tabindex="-1"></a></span>
<span id="cb168-11"><a href="validity-and-validation-tests.html#cb168-11" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(irrelevant_scenarios)) {</span>
<span id="cb168-12"><a href="validity-and-validation-tests.html#cb168-12" tabindex="-1"></a>  scenario <span class="ot">&lt;-</span> irrelevant_scenarios[i, ]</span>
<span id="cb168-13"><a href="validity-and-validation-tests.html#cb168-13" tabindex="-1"></a>  </span>
<span id="cb168-14"><a href="validity-and-validation-tests.html#cb168-14" tabindex="-1"></a>  <span class="co"># Generate irrelevant factor</span></span>
<span id="cb168-15"><a href="validity-and-validation-tests.html#cb168-15" tabindex="-1"></a>  <span class="cf">if</span>(scenario<span class="sc">$</span>beta <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb168-16"><a href="validity-and-validation-tests.html#cb168-16" tabindex="-1"></a>    <span class="co"># Create irrelevant factor correlated with true construct</span></span>
<span id="cb168-17"><a href="validity-and-validation-tests.html#cb168-17" tabindex="-1"></a>    irrelevant_factor <span class="ot">&lt;-</span> scenario<span class="sc">$</span>rho_TI <span class="sc">*</span> true_construct <span class="sc">+</span> </span>
<span id="cb168-18"><a href="validity-and-validation-tests.html#cb168-18" tabindex="-1"></a>                        <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> scenario<span class="sc">$</span>rho_TI<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb168-19"><a href="validity-and-validation-tests.html#cb168-19" tabindex="-1"></a>    </span>
<span id="cb168-20"><a href="validity-and-validation-tests.html#cb168-20" tabindex="-1"></a>    <span class="co"># Ensure irrelevant factor has specified correlation with criterion</span></span>
<span id="cb168-21"><a href="validity-and-validation-tests.html#cb168-21" tabindex="-1"></a>    <span class="cf">if</span>(scenario<span class="sc">$</span>rho_IY <span class="sc">!=</span> <span class="dv">0</span>) {</span>
<span id="cb168-22"><a href="validity-and-validation-tests.html#cb168-22" tabindex="-1"></a>      irrelevant_factor <span class="ot">&lt;-</span> scenario<span class="sc">$</span>rho_IY <span class="sc">*</span> criterion <span class="sc">+</span> </span>
<span id="cb168-23"><a href="validity-and-validation-tests.html#cb168-23" tabindex="-1"></a>                          <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> scenario<span class="sc">$</span>rho_IY<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> irrelevant_factor</span>
<span id="cb168-24"><a href="validity-and-validation-tests.html#cb168-24" tabindex="-1"></a>    }</span>
<span id="cb168-25"><a href="validity-and-validation-tests.html#cb168-25" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb168-26"><a href="validity-and-validation-tests.html#cb168-26" tabindex="-1"></a>    irrelevant_factor <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb168-27"><a href="validity-and-validation-tests.html#cb168-27" tabindex="-1"></a>  }</span>
<span id="cb168-28"><a href="validity-and-validation-tests.html#cb168-28" tabindex="-1"></a>  </span>
<span id="cb168-29"><a href="validity-and-validation-tests.html#cb168-29" tabindex="-1"></a>  <span class="co"># Calculate observed scores using Theorem 2 model</span></span>
<span id="cb168-30"><a href="validity-and-validation-tests.html#cb168-30" tabindex="-1"></a>  observed_scores <span class="ot">&lt;-</span> alpha <span class="sc">*</span> true_construct <span class="sc">+</span> scenario<span class="sc">$</span>beta <span class="sc">*</span> irrelevant_factor <span class="sc">+</span> </span>
<span id="cb168-31"><a href="validity-and-validation-tests.html#cb168-31" tabindex="-1"></a>                    <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma_error)</span>
<span id="cb168-32"><a href="validity-and-validation-tests.html#cb168-32" tabindex="-1"></a>  </span>
<span id="cb168-33"><a href="validity-and-validation-tests.html#cb168-33" tabindex="-1"></a>  <span class="co"># Calculate observed validity</span></span>
<span id="cb168-34"><a href="validity-and-validation-tests.html#cb168-34" tabindex="-1"></a>  observed_validity <span class="ot">&lt;-</span> <span class="fu">cor</span>(observed_scores, criterion)</span>
<span id="cb168-35"><a href="validity-and-validation-tests.html#cb168-35" tabindex="-1"></a>  </span>
<span id="cb168-36"><a href="validity-and-validation-tests.html#cb168-36" tabindex="-1"></a>  <span class="co"># Calculate predicted validity using Theorem 2</span></span>
<span id="cb168-37"><a href="validity-and-validation-tests.html#cb168-37" tabindex="-1"></a>  numerator <span class="ot">&lt;-</span> alpha <span class="sc">*</span> rho_TY <span class="sc">+</span> scenario<span class="sc">$</span>beta <span class="sc">*</span> scenario<span class="sc">$</span>rho_IY</span>
<span id="cb168-38"><a href="validity-and-validation-tests.html#cb168-38" tabindex="-1"></a>  denominator <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(alpha<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> scenario<span class="sc">$</span>beta<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> alpha <span class="sc">*</span> scenario<span class="sc">$</span>beta <span class="sc">*</span> scenario<span class="sc">$</span>rho_TI <span class="sc">+</span> sigma_error<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb168-39"><a href="validity-and-validation-tests.html#cb168-39" tabindex="-1"></a>  predicted_validity <span class="ot">&lt;-</span> numerator <span class="sc">/</span> denominator</span>
<span id="cb168-40"><a href="validity-and-validation-tests.html#cb168-40" tabindex="-1"></a>  </span>
<span id="cb168-41"><a href="validity-and-validation-tests.html#cb168-41" tabindex="-1"></a>  <span class="co"># Calculate validity change</span></span>
<span id="cb168-42"><a href="validity-and-validation-tests.html#cb168-42" tabindex="-1"></a>  validity_change <span class="ot">&lt;-</span> observed_validity <span class="sc">-</span> (alpha <span class="sc">*</span> rho_TY <span class="sc">/</span> <span class="fu">sqrt</span>(alpha<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sigma_error<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb168-43"><a href="validity-and-validation-tests.html#cb168-43" tabindex="-1"></a>  </span>
<span id="cb168-44"><a href="validity-and-validation-tests.html#cb168-44" tabindex="-1"></a>  results_irrelevant <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_irrelevant, <span class="fu">data.frame</span>(</span>
<span id="cb168-45"><a href="validity-and-validation-tests.html#cb168-45" tabindex="-1"></a>    <span class="at">Scenario =</span> scenario<span class="sc">$</span>Scenario,</span>
<span id="cb168-46"><a href="validity-and-validation-tests.html#cb168-46" tabindex="-1"></a>    <span class="at">Beta_Irrelevant =</span> scenario<span class="sc">$</span>beta,</span>
<span id="cb168-47"><a href="validity-and-validation-tests.html#cb168-47" tabindex="-1"></a>    <span class="at">Rho_IY =</span> scenario<span class="sc">$</span>rho_IY,</span>
<span id="cb168-48"><a href="validity-and-validation-tests.html#cb168-48" tabindex="-1"></a>    <span class="at">Predicted_Validity =</span> predicted_validity,</span>
<span id="cb168-49"><a href="validity-and-validation-tests.html#cb168-49" tabindex="-1"></a>    <span class="at">Observed_Validity =</span> observed_validity,</span>
<span id="cb168-50"><a href="validity-and-validation-tests.html#cb168-50" tabindex="-1"></a>    <span class="at">Validity_Change =</span> validity_change,</span>
<span id="cb168-51"><a href="validity-and-validation-tests.html#cb168-51" tabindex="-1"></a>    <span class="at">Prediction_Error =</span> <span class="fu">abs</span>(predicted_validity <span class="sc">-</span> observed_validity)</span>
<span id="cb168-52"><a href="validity-and-validation-tests.html#cb168-52" tabindex="-1"></a>  ))</span>
<span id="cb168-53"><a href="validity-and-validation-tests.html#cb168-53" tabindex="-1"></a>}</span>
<span id="cb168-54"><a href="validity-and-validation-tests.html#cb168-54" tabindex="-1"></a></span>
<span id="cb168-55"><a href="validity-and-validation-tests.html#cb168-55" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Theorem 2 Validation Results:&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;\nTheorem 2 Validation Results:&quot;</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="validity-and-validation-tests.html#cb170-1" tabindex="-1"></a>results_irrelevant_display <span class="ot">&lt;-</span> results_irrelevant</span>
<span id="cb170-2"><a href="validity-and-validation-tests.html#cb170-2" tabindex="-1"></a>numeric_cols <span class="ot">&lt;-</span> <span class="fu">sapply</span>(results_irrelevant, is.numeric)</span>
<span id="cb170-3"><a href="validity-and-validation-tests.html#cb170-3" tabindex="-1"></a>results_irrelevant_display[numeric_cols] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(results_irrelevant[numeric_cols], round, <span class="dv">4</span>)</span>
<span id="cb170-4"><a href="validity-and-validation-tests.html#cb170-4" tabindex="-1"></a><span class="fu">print</span>(results_irrelevant_display)</span></code></pre></div>
<pre><code>                Scenario Beta_Irrelevant Rho_IY Predicted_Validity
1       No Contamination             0.0    0.0             0.5618
2 Positive Contamination             0.4    0.8             0.8191
3 Negative Contamination             0.4    0.2             0.5733
4  Neutral Contamination             0.4    0.0             0.4914
  Observed_Validity Validity_Change Prediction_Error
1            0.5942          0.0324           0.0324
2            0.7653          0.2035           0.0538
3            0.6189          0.0571           0.0456
4            0.5834          0.0216           0.0920</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="validity-and-validation-tests.html#cb172-1" tabindex="-1"></a><span class="co"># Calculate contamination effects</span></span>
<span id="cb172-2"><a href="validity-and-validation-tests.html#cb172-2" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== CONTAMINATION ANALYSIS ===&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;\n=== CONTAMINATION ANALYSIS ===&quot;</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="validity-and-validation-tests.html#cb174-1" tabindex="-1"></a>baseline_validity <span class="ot">&lt;-</span> results_irrelevant<span class="sc">$</span>Observed_Validity[<span class="dv">1</span>]</span>
<span id="cb174-2"><a href="validity-and-validation-tests.html#cb174-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(results_irrelevant)) {</span>
<span id="cb174-3"><a href="validity-and-validation-tests.html#cb174-3" tabindex="-1"></a>  effect <span class="ot">&lt;-</span> results_irrelevant<span class="sc">$</span>Observed_Validity[i] <span class="sc">-</span> baseline_validity</span>
<span id="cb174-4"><a href="validity-and-validation-tests.html#cb174-4" tabindex="-1"></a>  effect_percent <span class="ot">&lt;-</span> (effect <span class="sc">/</span> baseline_validity) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb174-5"><a href="validity-and-validation-tests.html#cb174-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s: %+.3f validity change (%+.1f%%)</span><span class="sc">\n</span><span class="st">&quot;</span>, </span>
<span id="cb174-6"><a href="validity-and-validation-tests.html#cb174-6" tabindex="-1"></a>              results_irrelevant<span class="sc">$</span>Scenario[i], effect, effect_percent))</span>
<span id="cb174-7"><a href="validity-and-validation-tests.html#cb174-7" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>Positive Contamination: +0.171 validity change (+28.8%)
Negative Contamination: +0.025 validity change (+4.2%)
Neutral Contamination: -0.011 validity change (-1.8%)</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="validity-and-validation-tests.html#cb176-1" tabindex="-1"></a><span class="co"># Verify theoretical predictions</span></span>
<span id="cb176-2"><a href="validity-and-validation-tests.html#cb176-2" tabindex="-1"></a>mean_error <span class="ot">&lt;-</span> <span class="fu">mean</span>(results_irrelevant<span class="sc">$</span>Prediction_Error)</span>
<span id="cb176-3"><a href="validity-and-validation-tests.html#cb176-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Mean prediction error:&quot;</span>, <span class="fu">round</span>(mean_error, <span class="dv">6</span>)))</span></code></pre></div>
<pre><code>[1] &quot;\nMean prediction error: 0.055921&quot;</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="validity-and-validation-tests.html#cb178-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;(Small error confirms Theorem 2)&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;(Small error confirms Theorem 2)&quot;</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="validity-and-validation-tests.html#cb180-1" tabindex="-1"></a><span class="co"># Create comprehensive visualization</span></span>
<span id="cb180-2"><a href="validity-and-validation-tests.html#cb180-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb180-3"><a href="validity-and-validation-tests.html#cb180-3" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;theme_psych_book.R&quot;</span>)</span>
<span id="cb180-4"><a href="validity-and-validation-tests.html#cb180-4" tabindex="-1"></a></span>
<span id="cb180-5"><a href="validity-and-validation-tests.html#cb180-5" tabindex="-1"></a><span class="co"># Prepare data for plotting</span></span>
<span id="cb180-6"><a href="validity-and-validation-tests.html#cb180-6" tabindex="-1"></a>plot_data_irr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb180-7"><a href="validity-and-validation-tests.html#cb180-7" tabindex="-1"></a>  <span class="at">Scenario =</span> <span class="fu">factor</span>(results_irrelevant<span class="sc">$</span>Scenario, <span class="at">levels =</span> results_irrelevant<span class="sc">$</span>Scenario),</span>
<span id="cb180-8"><a href="validity-and-validation-tests.html#cb180-8" tabindex="-1"></a>  <span class="at">Predicted =</span> results_irrelevant<span class="sc">$</span>Predicted_Validity,</span>
<span id="cb180-9"><a href="validity-and-validation-tests.html#cb180-9" tabindex="-1"></a>  <span class="at">Observed =</span> results_irrelevant<span class="sc">$</span>Observed_Validity</span>
<span id="cb180-10"><a href="validity-and-validation-tests.html#cb180-10" tabindex="-1"></a>)</span>
<span id="cb180-11"><a href="validity-and-validation-tests.html#cb180-11" tabindex="-1"></a></span>
<span id="cb180-12"><a href="validity-and-validation-tests.html#cb180-12" tabindex="-1"></a>plot_long_irr <span class="ot">&lt;-</span> plot_data_irr <span class="sc">%&gt;%</span></span>
<span id="cb180-13"><a href="validity-and-validation-tests.html#cb180-13" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Predicted, Observed), <span class="at">names_to =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Validity&quot;</span>)</span>
<span id="cb180-14"><a href="validity-and-validation-tests.html#cb180-14" tabindex="-1"></a></span>
<span id="cb180-15"><a href="validity-and-validation-tests.html#cb180-15" tabindex="-1"></a><span class="fu">ggplot</span>(plot_long_irr, <span class="fu">aes</span>(<span class="at">x =</span> Scenario, <span class="at">y =</span> Validity, <span class="at">fill =</span> Type)) <span class="sc">+</span></span>
<span id="cb180-16"><a href="validity-and-validation-tests.html#cb180-16" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb180-17"><a href="validity-and-validation-tests.html#cb180-17" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">get_palette</span>(<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Observed&quot;</span>, <span class="st">&quot;Predicted by Theorem 2&quot;</span>)) <span class="sc">+</span></span>
<span id="cb180-18"><a href="validity-and-validation-tests.html#cb180-18" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Mathematical Analysis of Construct-Irrelevant Variance&quot;</span>,</span>
<span id="cb180-19"><a href="validity-and-validation-tests.html#cb180-19" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Theorem 2: ρ_XY = (αρ_TY + βρ_IY) / √(α² + β² + 2αβρ_TI + σ²_ε)&quot;</span>,</span>
<span id="cb180-20"><a href="validity-and-validation-tests.html#cb180-20" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Contamination Scenario&quot;</span>,</span>
<span id="cb180-21"><a href="validity-and-validation-tests.html#cb180-21" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Validity Coefficient&quot;</span>,</span>
<span id="cb180-22"><a href="validity-and-validation-tests.html#cb180-22" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Validity Type&quot;</span>) <span class="sc">+</span></span>
<span id="cb180-23"><a href="validity-and-validation-tests.html#cb180-23" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb180-24"><a href="validity-and-validation-tests.html#cb180-24" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb180-25"><a href="validity-and-validation-tests.html#cb180-25" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> baseline_validity, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb180-26"><a href="validity-and-validation-tests.html#cb180-26" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> baseline_validity <span class="sc">+</span> <span class="fl">0.02</span>, </span>
<span id="cb180-27"><a href="validity-and-validation-tests.html#cb180-27" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;Baseline (No Contamination)&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/construct-irrelevant-theory-1.png" width="672" /></p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="validity-and-validation-tests.html#cb181-1" tabindex="-1"></a><span class="co"># Detailed mathematical explanation</span></span>
<span id="cb181-2"><a href="validity-and-validation-tests.html#cb181-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== MATHEMATICAL INTERPRETATION ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>
=== MATHEMATICAL INTERPRETATION ===</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="validity-and-validation-tests.html#cb183-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Theorem 2 demonstrates how construct-irrelevant factors systematically</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Theorem 2 demonstrates how construct-irrelevant factors systematically</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="validity-and-validation-tests.html#cb185-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;distort validity coefficients through the exact mathematical relationship:</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>distort validity coefficients through the exact mathematical relationship:</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="validity-and-validation-tests.html#cb187-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;ρ_XY = (αρ_TY + βρ_IY) / √(α² + β² + 2αβρ_TI + σ²_ε)</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>ρ_XY = (αρ_TY + βρ_IY) / √(α² + β² + 2αβρ_TI + σ²_ε)</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="validity-and-validation-tests.html#cb189-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Component Analysis:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Component Analysis:</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="validity-and-validation-tests.html#cb191-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;• α = &quot;</span>, alpha, <span class="st">&quot; (loading on target construct)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>• α =  0.8  (loading on target construct)</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="validity-and-validation-tests.html#cb193-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;• ρ_TY = &quot;</span>, rho_TY, <span class="st">&quot; (true construct-criterion correlation)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>• ρ_TY =  0.6  (true construct-criterion correlation)</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="validity-and-validation-tests.html#cb195-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;• β varies by scenario (loading on irrelevant factor)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>• β varies by scenario (loading on irrelevant factor)</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="validity-and-validation-tests.html#cb197-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;• ρ_IY varies by scenario (irrelevant-criterion correlation)</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>• ρ_IY varies by scenario (irrelevant-criterion correlation)</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="validity-and-validation-tests.html#cb199-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Key Mathematical Insights:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Key Mathematical Insights:</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="validity-and-validation-tests.html#cb201-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;1. Positive contamination (ρ_IY &gt; ρ_TY) inflates validity</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>1. Positive contamination (ρ_IY &gt; ρ_TY) inflates validity</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="validity-and-validation-tests.html#cb203-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;2. Negative contamination (ρ_IY &lt; ρ_TY) deflates validity</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>2. Negative contamination (ρ_IY &lt; ρ_TY) deflates validity</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="validity-and-validation-tests.html#cb205-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;3. Pure irrelevant variance (ρ_IY = 0) only attenuates</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>3. Pure irrelevant variance (ρ_IY = 0) only attenuates</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="validity-and-validation-tests.html#cb207-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;4. The effect depends on both β (contamination amount) and ρ_IY (contamination direction)</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>4. The effect depends on both β (contamination amount) and ρ_IY (contamination direction)</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="validity-and-validation-tests.html#cb209-1" tabindex="-1"></a><span class="co"># Language contamination example with detailed math</span></span>
<span id="cb209-2"><a href="validity-and-validation-tests.html#cb209-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== PRACTICAL EXAMPLE: LANGUAGE CONTAMINATION ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>=== PRACTICAL EXAMPLE: LANGUAGE CONTAMINATION ===</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="validity-and-validation-tests.html#cb211-1" tabindex="-1"></a>language_example <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb211-2"><a href="validity-and-validation-tests.html#cb211-2" tabindex="-1"></a>  <span class="at">Population =</span> <span class="fu">c</span>(<span class="st">&quot;Native Speakers&quot;</span>, <span class="st">&quot;ELL Students&quot;</span>),</span>
<span id="cb211-3"><a href="validity-and-validation-tests.html#cb211-3" tabindex="-1"></a>  <span class="at">True_Reasoning =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">100</span>),  <span class="co"># Same reasoning ability</span></span>
<span id="cb211-4"><a href="validity-and-validation-tests.html#cb211-4" tabindex="-1"></a>  <span class="at">Language_Skill =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">70</span>),   <span class="co"># Different language skills</span></span>
<span id="cb211-5"><a href="validity-and-validation-tests.html#cb211-5" tabindex="-1"></a>  <span class="at">Expected_Score =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">88</span>)    <span class="co"># Due to contamination</span></span>
<span id="cb211-6"><a href="validity-and-validation-tests.html#cb211-6" tabindex="-1"></a>)</span>
<span id="cb211-7"><a href="validity-and-validation-tests.html#cb211-7" tabindex="-1"></a></span>
<span id="cb211-8"><a href="validity-and-validation-tests.html#cb211-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Consider a reasoning test contaminated by language demands:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Consider a reasoning test contaminated by language demands:</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="validity-and-validation-tests.html#cb213-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;• Native speakers: No contamination effect</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>• Native speakers: No contamination effect</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="validity-and-validation-tests.html#cb215-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;• ELL students: 30-point language disadvantage</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>• ELL students: 30-point language disadvantage</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="validity-and-validation-tests.html#cb217-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;• With β = 0.4 (language loading), score difference = 0.4 × 30 = 12 points</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>• With β = 0.4 (language loading), score difference = 0.4 × 30 = 12 points</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="validity-and-validation-tests.html#cb219-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;• This creates spurious group differences unrelated to reasoning ability</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>• This creates spurious group differences unrelated to reasoning ability</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="validity-and-validation-tests.html#cb221-1" tabindex="-1"></a><span class="fu">print</span>(language_example)</span></code></pre></div>
<pre><code>       Population True_Reasoning Language_Skill Expected_Score
1 Native Speakers            100            100            100
2    ELL Students            100             70             88</code></pre>
<p><strong>Critical Implications for Test Interpretation:</strong></p>
<ol style="list-style-type: decimal">
<li><p><strong>Positive Contamination</strong>: When irrelevant factors correlate positively with criteria (e.g., socioeconomic status in academic tests), validity appears artificially high, leading to overconfidence in test utility.</p></li>
<li><p><strong>Negative Contamination</strong>: When irrelevant factors correlate negatively with criteria (e.g., test anxiety in ability tests), validity appears artificially low, leading to underestimation of test utility.</p></li>
<li><p><strong>Measurement Bias</strong>: Construct-irrelevant variance creates systematic bias in group comparisons, violating test fairness principles.</p></li>
</ol>
<p>The mathematical framework allows precise quantification of these effects and guides remediation strategies.</p>
</div>
</div>
<div id="many-faces-of-validity-and-standards" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Many Faces of Validity and Standards<a href="validity-and-validation-tests.html#many-faces-of-validity-and-standards" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="historical-evolution-of-validity-frameworks" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Historical Evolution of Validity Frameworks<a href="validity-and-validation-tests.html#historical-evolution-of-validity-frameworks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The conceptualization of validity has undergone significant evolution. Early approaches divided validity into discrete “types” — content, criterion, and construct validity. However, this tripartite model created artificial distinctions and failed to capture the integrated nature of validation evidence.</p>
<p>The modern unified model, articulated in the 1999 Standards for Educational and Psychological Testing, recognizes validity as a unitary concept supported by multiple sources of evidence. This framework emphasizes that validation is an ongoing process of theory testing and refinement rather than a one-time demonstration.</p>
</div>
<div id="the-five-sources-of-validity-evidence" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> The Five Sources of Validity Evidence<a href="validity-and-validation-tests.html#the-five-sources-of-validity-evidence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>According to the Standards, validity evidence can be organized into five interconnected sources:</p>
<ol style="list-style-type: decimal">
<li><strong>Test Content</strong>: Evidence based on relationships between test content and the construct</li>
<li><strong>Response Processes</strong>: Evidence based on analyses of response processes used by test takers</li>
<li><strong>Internal Structure</strong>: Evidence based on the internal structure of the test</li>
<li><strong>Relations to Other Variables</strong>: Evidence based on relationships with external variables</li>
<li><strong>Consequences of Testing</strong>: Evidence based on the consequences of test use</li>
</ol>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="validity-and-validation-tests.html#cb223-1" tabindex="-1"></a><span class="co"># Create conceptual diagram of validity evidence sources</span></span>
<span id="cb223-2"><a href="validity-and-validation-tests.html#cb223-2" tabindex="-1"></a>validity_sources <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb223-3"><a href="validity-and-validation-tests.html#cb223-3" tabindex="-1"></a>  <span class="at">Source =</span> <span class="fu">c</span>(<span class="st">&quot;Test Content&quot;</span>, <span class="st">&quot;Response Processes&quot;</span>, <span class="st">&quot;Internal Structure&quot;</span>, </span>
<span id="cb223-4"><a href="validity-and-validation-tests.html#cb223-4" tabindex="-1"></a>             <span class="st">&quot;Relations to Other Variables&quot;</span>, <span class="st">&quot;Consequences of Testing&quot;</span>),</span>
<span id="cb223-5"><a href="validity-and-validation-tests.html#cb223-5" tabindex="-1"></a>  <span class="at">Importance =</span> <span class="fu">c</span>(<span class="fl">0.85</span>, <span class="fl">0.75</span>, <span class="fl">0.90</span>, <span class="fl">0.95</span>, <span class="fl">0.70</span>),</span>
<span id="cb223-6"><a href="validity-and-validation-tests.html#cb223-6" tabindex="-1"></a>  <span class="at">Frequency_Used =</span> <span class="fu">c</span>(<span class="fl">0.90</span>, <span class="fl">0.40</span>, <span class="fl">0.85</span>, <span class="fl">0.95</span>, <span class="fl">0.30</span>),</span>
<span id="cb223-7"><a href="validity-and-validation-tests.html#cb223-7" tabindex="-1"></a>  <span class="at">Category =</span> <span class="fu">c</span>(<span class="st">&quot;Content&quot;</span>, <span class="st">&quot;Process&quot;</span>, <span class="st">&quot;Structure&quot;</span>, <span class="st">&quot;External&quot;</span>, <span class="st">&quot;Impact&quot;</span>)</span>
<span id="cb223-8"><a href="validity-and-validation-tests.html#cb223-8" tabindex="-1"></a>)</span>
<span id="cb223-9"><a href="validity-and-validation-tests.html#cb223-9" tabindex="-1"></a></span>
<span id="cb223-10"><a href="validity-and-validation-tests.html#cb223-10" tabindex="-1"></a><span class="co"># Reshape for plotting</span></span>
<span id="cb223-11"><a href="validity-and-validation-tests.html#cb223-11" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb223-12"><a href="validity-and-validation-tests.html#cb223-12" tabindex="-1"></a>validity_long <span class="ot">&lt;-</span> validity_sources <span class="sc">%&gt;%</span></span>
<span id="cb223-13"><a href="validity-and-validation-tests.html#cb223-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Source, Importance, Frequency_Used) <span class="sc">%&gt;%</span></span>
<span id="cb223-14"><a href="validity-and-validation-tests.html#cb223-14" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Importance, Frequency_Used), </span>
<span id="cb223-15"><a href="validity-and-validation-tests.html#cb223-15" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Metric&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb223-16"><a href="validity-and-validation-tests.html#cb223-16" tabindex="-1"></a></span>
<span id="cb223-17"><a href="validity-and-validation-tests.html#cb223-17" tabindex="-1"></a><span class="fu">ggplot</span>(validity_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Source, Value), <span class="at">y =</span> Value, <span class="at">fill =</span> Metric)) <span class="sc">+</span></span>
<span id="cb223-18"><a href="validity-and-validation-tests.html#cb223-18" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb223-19"><a href="validity-and-validation-tests.html#cb223-19" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb223-20"><a href="validity-and-validation-tests.html#cb223-20" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">get_palette</span>(<span class="dv">2</span>), </span>
<span id="cb223-21"><a href="validity-and-validation-tests.html#cb223-21" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Importance&quot;</span>, <span class="st">&quot;Frequency of Use&quot;</span>)) <span class="sc">+</span></span>
<span id="cb223-22"><a href="validity-and-validation-tests.html#cb223-22" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Sources of Validity Evidence in Practice&quot;</span>,</span>
<span id="cb223-23"><a href="validity-and-validation-tests.html#cb223-23" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Gap between importance and actual use in validation studies&quot;</span>,</span>
<span id="cb223-24"><a href="validity-and-validation-tests.html#cb223-24" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Source of Evidence&quot;</span>, </span>
<span id="cb223-25"><a href="validity-and-validation-tests.html#cb223-25" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Proportion&quot;</span>,</span>
<span id="cb223-26"><a href="validity-and-validation-tests.html#cb223-26" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Metric&quot;</span>) <span class="sc">+</span></span>
<span id="cb223-27"><a href="validity-and-validation-tests.html#cb223-27" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb223-28"><a href="validity-and-validation-tests.html#cb223-28" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>())</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/validity-framework-1.png" width="672" /></p>
<p>This visualization highlights a common pattern in validation practice: while all sources of evidence are important, some (particularly response processes and consequences) are underutilized despite their theoretical significance.</p>
</div>
</div>
<div id="sources-of-evidence-in-validity" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Sources of Evidence in Validity<a href="validity-and-validation-tests.html#sources-of-evidence-in-validity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="evidence-based-on-test-content-mathematical-framework" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Evidence Based on Test Content: Mathematical Framework<a href="validity-and-validation-tests.html#evidence-based-on-test-content-mathematical-framework" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Content validity involves the systematic evaluation of the relationship between test items and the construct domain. This requires mathematical models for content specification and quantitative indices of content adequacy.</p>
<p><strong>Definition: Content Universe</strong>
Let <span class="math inline">\(U = \{u_1, u_2, ..., u_N\}\)</span> represent the complete universe of possible content elements for a construct, partitioned into content categories <span class="math inline">\(C_1, C_2, ..., C_k\)</span> where <span class="math inline">\(\bigcup_{i=1}^{k} C_i = U\)</span> and <span class="math inline">\(C_i \cap C_j = \emptyset\)</span> for <span class="math inline">\(i \neq j\)</span>.</p>
<p><strong>Content Specification Matrix</strong>
The theoretical content specifications can be represented as a matrix <span class="math inline">\(\mathbf{W}\)</span> where <span class="math inline">\(w_{ij}\)</span> represents the importance weight of content category <span class="math inline">\(i\)</span> for construct facet <span class="math inline">\(j\)</span>:</p>
<p><span class="math display">\[\mathbf{W} = \begin{pmatrix}
w_{11} &amp; w_{12} &amp; \cdots &amp; w_{1m} \\
w_{21} &amp; w_{22} &amp; \cdots &amp; w_{2m} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
w_{k1} &amp; w_{k2} &amp; \cdots &amp; w_{km}
\end{pmatrix}\]</span></p>
<p>subject to the constraint <span class="math inline">\(\sum_{i=1}^{k} w_{ij} = 1\)</span> for all <span class="math inline">\(j\)</span>.</p>
<p><strong>Content Validity Index</strong>
For a test with items distributed across content categories, the Content Validity Index (CVI) is:</p>
<p><span class="math display">\[\text{CVI} = \frac{\sum_{i=1}^{k} \sum_{j=1}^{m} w_{ij} \cdot p_{ij} \cdot r_{ij}}{\sum_{i=1}^{k} \sum_{j=1}^{m} w_{ij}}\]</span></p>
<p>where:
- <span class="math inline">\(p_{ij}\)</span> = proportion of test items in category <span class="math inline">\(i\)</span> for facet <span class="math inline">\(j\)</span>
- <span class="math inline">\(r_{ij}\)</span> = average expert rating for category <span class="math inline">\(i\)</span>, facet <span class="math inline">\(j\)</span> alignment</p>
<p><strong>Theorem 3: Content Representativeness</strong>
A test achieves optimal content representativeness when the item distribution <span class="math inline">\(\mathbf{P}\)</span> matches the theoretical weights <span class="math inline">\(\mathbf{W}\)</span>:</p>
<p><span class="math display">\[\text{Representativeness} = 1 - \sum_{i=1}^{k} \sum_{j=1}^{m} |w_{ij} - p_{ij}|\]</span></p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="validity-and-validation-tests.html#cb224-1" tabindex="-1"></a><span class="co"># Mathematical demonstration of content validation framework</span></span>
<span id="cb224-2"><a href="validity-and-validation-tests.html#cb224-2" tabindex="-1"></a><span class="co"># This implements the theoretical content validation model</span></span>
<span id="cb224-3"><a href="validity-and-validation-tests.html#cb224-3" tabindex="-1"></a></span>
<span id="cb224-4"><a href="validity-and-validation-tests.html#cb224-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb224-5"><a href="validity-and-validation-tests.html#cb224-5" tabindex="-1"></a></span>
<span id="cb224-6"><a href="validity-and-validation-tests.html#cb224-6" tabindex="-1"></a><span class="co"># Define content universe structure</span></span>
<span id="cb224-7"><a href="validity-and-validation-tests.html#cb224-7" tabindex="-1"></a>content_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Working Memory&quot;</span>, <span class="st">&quot;Processing Speed&quot;</span>, <span class="st">&quot;Attention&quot;</span>, <span class="st">&quot;Executive Control&quot;</span>)</span>
<span id="cb224-8"><a href="validity-and-validation-tests.html#cb224-8" tabindex="-1"></a>construct_facets <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Verbal&quot;</span>, <span class="st">&quot;Spatial&quot;</span>, <span class="st">&quot;Numeric&quot;</span>)</span>
<span id="cb224-9"><a href="validity-and-validation-tests.html#cb224-9" tabindex="-1"></a>n_categories <span class="ot">&lt;-</span> <span class="fu">length</span>(content_categories)</span>
<span id="cb224-10"><a href="validity-and-validation-tests.html#cb224-10" tabindex="-1"></a>n_facets <span class="ot">&lt;-</span> <span class="fu">length</span>(construct_facets)</span>
<span id="cb224-11"><a href="validity-and-validation-tests.html#cb224-11" tabindex="-1"></a></span>
<span id="cb224-12"><a href="validity-and-validation-tests.html#cb224-12" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;=== MATHEMATICAL CONTENT VALIDATION FRAMEWORK ===&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;=== MATHEMATICAL CONTENT VALIDATION FRAMEWORK ===&quot;</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="validity-and-validation-tests.html#cb226-1" tabindex="-1"></a><span class="co"># Theoretical importance weights matrix W (from expert consensus)</span></span>
<span id="cb226-2"><a href="validity-and-validation-tests.html#cb226-2" tabindex="-1"></a>W_theoretical <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb226-3"><a href="validity-and-validation-tests.html#cb226-3" tabindex="-1"></a>  <span class="co"># Verbal, Spatial, Numeric facets for each category</span></span>
<span id="cb226-4"><a href="validity-and-validation-tests.html#cb226-4" tabindex="-1"></a>  <span class="fl">0.40</span>, <span class="fl">0.20</span>, <span class="fl">0.35</span>,  <span class="co"># Working Memory</span></span>
<span id="cb226-5"><a href="validity-and-validation-tests.html#cb226-5" tabindex="-1"></a>  <span class="fl">0.25</span>, <span class="fl">0.35</span>, <span class="fl">0.20</span>,  <span class="co"># Processing Speed  </span></span>
<span id="cb226-6"><a href="validity-and-validation-tests.html#cb226-6" tabindex="-1"></a>  <span class="fl">0.20</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>,  <span class="co"># Attention</span></span>
<span id="cb226-7"><a href="validity-and-validation-tests.html#cb226-7" tabindex="-1"></a>  <span class="fl">0.15</span>, <span class="fl">0.20</span>, <span class="fl">0.20</span>   <span class="co"># Executive Control</span></span>
<span id="cb226-8"><a href="validity-and-validation-tests.html#cb226-8" tabindex="-1"></a>), <span class="at">nrow =</span> n_categories, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb226-9"><a href="validity-and-validation-tests.html#cb226-9" tabindex="-1"></a></span>
<span id="cb226-10"><a href="validity-and-validation-tests.html#cb226-10" tabindex="-1"></a><span class="fu">rownames</span>(W_theoretical) <span class="ot">&lt;-</span> content_categories</span>
<span id="cb226-11"><a href="validity-and-validation-tests.html#cb226-11" tabindex="-1"></a><span class="fu">colnames</span>(W_theoretical) <span class="ot">&lt;-</span> construct_facets</span>
<span id="cb226-12"><a href="validity-and-validation-tests.html#cb226-12" tabindex="-1"></a></span>
<span id="cb226-13"><a href="validity-and-validation-tests.html#cb226-13" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Theoretical Content Specification Matrix (W):&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;Theoretical Content Specification Matrix (W):&quot;</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="validity-and-validation-tests.html#cb228-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(W_theoretical, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>                  Verbal Spatial Numeric
Working Memory      0.40    0.20    0.35
Processing Speed    0.25    0.35    0.20
Attention           0.20    0.25    0.25
Executive Control   0.15    0.20    0.20</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="validity-and-validation-tests.html#cb230-1" tabindex="-1"></a><span class="co"># Verify constraint: columns sum to 1</span></span>
<span id="cb230-2"><a href="validity-and-validation-tests.html#cb230-2" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Column sums (should be 1.0):&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;Column sums (should be 1.0):&quot;</code></pre>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="validity-and-validation-tests.html#cb232-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">colSums</span>(W_theoretical), <span class="dv">3</span>))</span></code></pre></div>
<pre><code> Verbal Spatial Numeric 
      1       1       1 </code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="validity-and-validation-tests.html#cb234-1" tabindex="-1"></a><span class="co"># Simulate expert content validation study</span></span>
<span id="cb234-2"><a href="validity-and-validation-tests.html#cb234-2" tabindex="-1"></a>n_experts <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb234-3"><a href="validity-and-validation-tests.html#cb234-3" tabindex="-1"></a>n_items_per_category <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb234-4"><a href="validity-and-validation-tests.html#cb234-4" tabindex="-1"></a>total_items <span class="ot">&lt;-</span> n_categories <span class="sc">*</span> n_items_per_category</span>
<span id="cb234-5"><a href="validity-and-validation-tests.html#cb234-5" tabindex="-1"></a></span>
<span id="cb234-6"><a href="validity-and-validation-tests.html#cb234-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Total items:&quot;</span>, total_items))</span></code></pre></div>
<pre><code>[1] &quot;Total items: 24&quot;</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="validity-and-validation-tests.html#cb236-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Number of expert judges:&quot;</span>, n_experts))</span></code></pre></div>
<pre><code>[1] &quot;Number of expert judges: 8&quot;</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="validity-and-validation-tests.html#cb238-1" tabindex="-1"></a><span class="co"># Generate expert ratings using Item Response Theory for raters</span></span>
<span id="cb238-2"><a href="validity-and-validation-tests.html#cb238-2" tabindex="-1"></a><span class="co"># Each expert has their own severity and consistency parameters</span></span>
<span id="cb238-3"><a href="validity-and-validation-tests.html#cb238-3" tabindex="-1"></a>expert_severity <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_experts, <span class="dv">0</span>, <span class="fl">0.3</span>)  <span class="co"># Mean severity differences</span></span>
<span id="cb238-4"><a href="validity-and-validation-tests.html#cb238-4" tabindex="-1"></a>expert_consistency <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_experts, <span class="fl">0.7</span>, <span class="fl">0.95</span>)  <span class="co"># Consistency parameters</span></span>
<span id="cb238-5"><a href="validity-and-validation-tests.html#cb238-5" tabindex="-1"></a></span>
<span id="cb238-6"><a href="validity-and-validation-tests.html#cb238-6" tabindex="-1"></a><span class="co"># True item-category alignments (ground truth)</span></span>
<span id="cb238-7"><a href="validity-and-validation-tests.html#cb238-7" tabindex="-1"></a>true_alignments <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_categories, <span class="at">each =</span> n_items_per_category)</span>
<span id="cb238-8"><a href="validity-and-validation-tests.html#cb238-8" tabindex="-1"></a></span>
<span id="cb238-9"><a href="validity-and-validation-tests.html#cb238-9" tabindex="-1"></a><span class="co"># Generate expert ratings for each item-category combination</span></span>
<span id="cb238-10"><a href="validity-and-validation-tests.html#cb238-10" tabindex="-1"></a>expert_ratings <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">dim =</span> <span class="fu">c</span>(total_items, n_categories, n_experts))</span>
<span id="cb238-11"><a href="validity-and-validation-tests.html#cb238-11" tabindex="-1"></a></span>
<span id="cb238-12"><a href="validity-and-validation-tests.html#cb238-12" tabindex="-1"></a><span class="cf">for</span>(item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>total_items) {</span>
<span id="cb238-13"><a href="validity-and-validation-tests.html#cb238-13" tabindex="-1"></a>  true_category <span class="ot">&lt;-</span> true_alignments[item]</span>
<span id="cb238-14"><a href="validity-and-validation-tests.html#cb238-14" tabindex="-1"></a>  </span>
<span id="cb238-15"><a href="validity-and-validation-tests.html#cb238-15" tabindex="-1"></a>  <span class="cf">for</span>(category <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_categories) {</span>
<span id="cb238-16"><a href="validity-and-validation-tests.html#cb238-16" tabindex="-1"></a>    <span class="cf">for</span>(expert <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_experts) {</span>
<span id="cb238-17"><a href="validity-and-validation-tests.html#cb238-17" tabindex="-1"></a>      <span class="co"># Probability of high rating depends on true alignment</span></span>
<span id="cb238-18"><a href="validity-and-validation-tests.html#cb238-18" tabindex="-1"></a>      <span class="cf">if</span>(category <span class="sc">==</span> true_category) {</span>
<span id="cb238-19"><a href="validity-and-validation-tests.html#cb238-19" tabindex="-1"></a>        <span class="co"># Item truly belongs to this category</span></span>
<span id="cb238-20"><a href="validity-and-validation-tests.html#cb238-20" tabindex="-1"></a>        prob_high <span class="ot">&lt;-</span> expert_consistency[expert]</span>
<span id="cb238-21"><a href="validity-and-validation-tests.html#cb238-21" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb238-22"><a href="validity-and-validation-tests.html#cb238-22" tabindex="-1"></a>        <span class="co"># Item doesn&#39;t belong to this category</span></span>
<span id="cb238-23"><a href="validity-and-validation-tests.html#cb238-23" tabindex="-1"></a>        prob_high <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> expert_consistency[expert]</span>
<span id="cb238-24"><a href="validity-and-validation-tests.html#cb238-24" tabindex="-1"></a>      }</span>
<span id="cb238-25"><a href="validity-and-validation-tests.html#cb238-25" tabindex="-1"></a>      </span>
<span id="cb238-26"><a href="validity-and-validation-tests.html#cb238-26" tabindex="-1"></a>      <span class="co"># Apply expert severity</span></span>
<span id="cb238-27"><a href="validity-and-validation-tests.html#cb238-27" tabindex="-1"></a>      prob_high <span class="ot">&lt;-</span> prob_high <span class="sc">+</span> expert_severity[expert]</span>
<span id="cb238-28"><a href="validity-and-validation-tests.html#cb238-28" tabindex="-1"></a>      prob_high <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="fl">0.1</span>, <span class="fu">pmin</span>(<span class="fl">0.9</span>, prob_high))  <span class="co"># Bound probabilities</span></span>
<span id="cb238-29"><a href="validity-and-validation-tests.html#cb238-29" tabindex="-1"></a>      </span>
<span id="cb238-30"><a href="validity-and-validation-tests.html#cb238-30" tabindex="-1"></a>      <span class="co"># Generate rating (1-5 scale)</span></span>
<span id="cb238-31"><a href="validity-and-validation-tests.html#cb238-31" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> prob_high) {</span>
<span id="cb238-32"><a href="validity-and-validation-tests.html#cb238-32" tabindex="-1"></a>        expert_ratings[item, category, expert] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>))</span>
<span id="cb238-33"><a href="validity-and-validation-tests.html#cb238-33" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb238-34"><a href="validity-and-validation-tests.html#cb238-34" tabindex="-1"></a>        expert_ratings[item, category, expert] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>))</span>
<span id="cb238-35"><a href="validity-and-validation-tests.html#cb238-35" tabindex="-1"></a>      }</span>
<span id="cb238-36"><a href="validity-and-validation-tests.html#cb238-36" tabindex="-1"></a>    }</span>
<span id="cb238-37"><a href="validity-and-validation-tests.html#cb238-37" tabindex="-1"></a>  }</span>
<span id="cb238-38"><a href="validity-and-validation-tests.html#cb238-38" tabindex="-1"></a>}</span>
<span id="cb238-39"><a href="validity-and-validation-tests.html#cb238-39" tabindex="-1"></a></span>
<span id="cb238-40"><a href="validity-and-validation-tests.html#cb238-40" tabindex="-1"></a><span class="co"># Calculate average ratings and content validity indices</span></span>
<span id="cb238-41"><a href="validity-and-validation-tests.html#cb238-41" tabindex="-1"></a>avg_ratings <span class="ot">&lt;-</span> <span class="fu">apply</span>(expert_ratings, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb238-42"><a href="validity-and-validation-tests.html#cb238-42" tabindex="-1"></a>item_cvi <span class="ot">&lt;-</span> <span class="fu">numeric</span>(total_items)</span>
<span id="cb238-43"><a href="validity-and-validation-tests.html#cb238-43" tabindex="-1"></a></span>
<span id="cb238-44"><a href="validity-and-validation-tests.html#cb238-44" tabindex="-1"></a><span class="cf">for</span>(item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>total_items) {</span>
<span id="cb238-45"><a href="validity-and-validation-tests.html#cb238-45" tabindex="-1"></a>  <span class="co"># CVI for each item (proportion of experts rating ≥ 4)</span></span>
<span id="cb238-46"><a href="validity-and-validation-tests.html#cb238-46" tabindex="-1"></a>  high_ratings <span class="ot">&lt;-</span> <span class="fu">apply</span>(expert_ratings[item, , ], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">mean</span>(x <span class="sc">&gt;=</span> <span class="dv">4</span>))</span>
<span id="cb238-47"><a href="validity-and-validation-tests.html#cb238-47" tabindex="-1"></a>  item_cvi[item] <span class="ot">&lt;-</span> <span class="fu">max</span>(high_ratings)  <span class="co"># Best category match</span></span>
<span id="cb238-48"><a href="validity-and-validation-tests.html#cb238-48" tabindex="-1"></a>}</span>
<span id="cb238-49"><a href="validity-and-validation-tests.html#cb238-49" tabindex="-1"></a></span>
<span id="cb238-50"><a href="validity-and-validation-tests.html#cb238-50" tabindex="-1"></a><span class="co"># Calculate scale-level Content Validity Index</span></span>
<span id="cb238-51"><a href="validity-and-validation-tests.html#cb238-51" tabindex="-1"></a>scale_cvi <span class="ot">&lt;-</span> <span class="fu">mean</span>(item_cvi)</span>
<span id="cb238-52"><a href="validity-and-validation-tests.html#cb238-52" tabindex="-1"></a></span>
<span id="cb238-53"><a href="validity-and-validation-tests.html#cb238-53" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Scale-level Content Validity Index (S-CVI):&quot;</span>, <span class="fu">round</span>(scale_cvi, <span class="dv">3</span>)))</span></code></pre></div>
<pre><code>[1] &quot;Scale-level Content Validity Index (S-CVI): 0.661&quot;</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="validity-and-validation-tests.html#cb240-1" tabindex="-1"></a><span class="co"># Calculate content representativeness using Theorem 3</span></span>
<span id="cb240-2"><a href="validity-and-validation-tests.html#cb240-2" tabindex="-1"></a><span class="co"># Actual item distribution</span></span>
<span id="cb240-3"><a href="validity-and-validation-tests.html#cb240-3" tabindex="-1"></a>P_actual <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> n_categories, <span class="at">ncol =</span> n_facets)</span>
<span id="cb240-4"><a href="validity-and-validation-tests.html#cb240-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_categories) {</span>
<span id="cb240-5"><a href="validity-and-validation-tests.html#cb240-5" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_facets) {</span>
<span id="cb240-6"><a href="validity-and-validation-tests.html#cb240-6" tabindex="-1"></a>    <span class="co"># For this simulation, assume equal distribution within facets</span></span>
<span id="cb240-7"><a href="validity-and-validation-tests.html#cb240-7" tabindex="-1"></a>    P_actual[i, j] <span class="ot">&lt;-</span> (n_items_per_category) <span class="sc">/</span> (total_items <span class="sc">/</span> n_facets)</span>
<span id="cb240-8"><a href="validity-and-validation-tests.html#cb240-8" tabindex="-1"></a>  }</span>
<span id="cb240-9"><a href="validity-and-validation-tests.html#cb240-9" tabindex="-1"></a>}</span>
<span id="cb240-10"><a href="validity-and-validation-tests.html#cb240-10" tabindex="-1"></a></span>
<span id="cb240-11"><a href="validity-and-validation-tests.html#cb240-11" tabindex="-1"></a><span class="co"># Normalize to sum to 1 within facets</span></span>
<span id="cb240-12"><a href="validity-and-validation-tests.html#cb240-12" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_facets) {</span>
<span id="cb240-13"><a href="validity-and-validation-tests.html#cb240-13" tabindex="-1"></a>  P_actual[, j] <span class="ot">&lt;-</span> P_actual[, j] <span class="sc">/</span> <span class="fu">sum</span>(P_actual[, j])</span>
<span id="cb240-14"><a href="validity-and-validation-tests.html#cb240-14" tabindex="-1"></a>}</span>
<span id="cb240-15"><a href="validity-and-validation-tests.html#cb240-15" tabindex="-1"></a></span>
<span id="cb240-16"><a href="validity-and-validation-tests.html#cb240-16" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Actual Item Distribution Matrix (P):&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;Actual Item Distribution Matrix (P):&quot;</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="validity-and-validation-tests.html#cb242-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(P_actual, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>     [,1] [,2] [,3]
[1,] 0.25 0.25 0.25
[2,] 0.25 0.25 0.25
[3,] 0.25 0.25 0.25
[4,] 0.25 0.25 0.25</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="validity-and-validation-tests.html#cb244-1" tabindex="-1"></a><span class="co"># Calculate representativeness using Theorem 3</span></span>
<span id="cb244-2"><a href="validity-and-validation-tests.html#cb244-2" tabindex="-1"></a>representativeness <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">abs</span>(W_theoretical <span class="sc">-</span> P_actual))</span>
<span id="cb244-3"><a href="validity-and-validation-tests.html#cb244-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Content Representativeness (Theorem 3):&quot;</span>, <span class="fu">round</span>(representativeness, <span class="dv">3</span>)))</span></code></pre></div>
<pre><code>[1] &quot;Content Representativeness (Theorem 3): 0.3&quot;</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="validity-and-validation-tests.html#cb246-1" tabindex="-1"></a><span class="co"># Calculate content adequacy for each category</span></span>
<span id="cb246-2"><a href="validity-and-validation-tests.html#cb246-2" tabindex="-1"></a><span class="co"># Calculate mean expert rating for each category&#39;s own items</span></span>
<span id="cb246-3"><a href="validity-and-validation-tests.html#cb246-3" tabindex="-1"></a>mean_expert_ratings <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_categories)</span>
<span id="cb246-4"><a href="validity-and-validation-tests.html#cb246-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_categories) {</span>
<span id="cb246-5"><a href="validity-and-validation-tests.html#cb246-5" tabindex="-1"></a>  item_indices <span class="ot">&lt;-</span> ((i<span class="dv">-1</span>) <span class="sc">*</span> n_items_per_category <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(i <span class="sc">*</span> n_items_per_category)</span>
<span id="cb246-6"><a href="validity-and-validation-tests.html#cb246-6" tabindex="-1"></a>  mean_expert_ratings[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(avg_ratings[item_indices, i])</span>
<span id="cb246-7"><a href="validity-and-validation-tests.html#cb246-7" tabindex="-1"></a>}</span>
<span id="cb246-8"><a href="validity-and-validation-tests.html#cb246-8" tabindex="-1"></a></span>
<span id="cb246-9"><a href="validity-and-validation-tests.html#cb246-9" tabindex="-1"></a>content_adequacy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb246-10"><a href="validity-and-validation-tests.html#cb246-10" tabindex="-1"></a>  <span class="at">Category =</span> content_categories,</span>
<span id="cb246-11"><a href="validity-and-validation-tests.html#cb246-11" tabindex="-1"></a>  <span class="at">Theoretical_Weight =</span> <span class="fu">rowMeans</span>(W_theoretical),</span>
<span id="cb246-12"><a href="validity-and-validation-tests.html#cb246-12" tabindex="-1"></a>  <span class="at">Actual_Proportion =</span> <span class="fu">rowMeans</span>(P_actual),</span>
<span id="cb246-13"><a href="validity-and-validation-tests.html#cb246-13" tabindex="-1"></a>  <span class="at">Mean_Expert_Rating =</span> mean_expert_ratings,</span>
<span id="cb246-14"><a href="validity-and-validation-tests.html#cb246-14" tabindex="-1"></a>  <span class="at">Content_Gap =</span> <span class="fu">abs</span>(<span class="fu">rowMeans</span>(W_theoretical) <span class="sc">-</span> <span class="fu">rowMeans</span>(P_actual))</span>
<span id="cb246-15"><a href="validity-and-validation-tests.html#cb246-15" tabindex="-1"></a>)</span>
<span id="cb246-16"><a href="validity-and-validation-tests.html#cb246-16" tabindex="-1"></a></span>
<span id="cb246-17"><a href="validity-and-validation-tests.html#cb246-17" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Content Adequacy Analysis:&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;\nContent Adequacy Analysis:&quot;</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="validity-and-validation-tests.html#cb248-1" tabindex="-1"></a>content_adequacy_display <span class="ot">&lt;-</span> content_adequacy</span>
<span id="cb248-2"><a href="validity-and-validation-tests.html#cb248-2" tabindex="-1"></a>numeric_cols <span class="ot">&lt;-</span> <span class="fu">sapply</span>(content_adequacy, is.numeric)</span>
<span id="cb248-3"><a href="validity-and-validation-tests.html#cb248-3" tabindex="-1"></a>content_adequacy_display[numeric_cols] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(content_adequacy[numeric_cols], round, <span class="dv">3</span>)</span>
<span id="cb248-4"><a href="validity-and-validation-tests.html#cb248-4" tabindex="-1"></a><span class="fu">print</span>(content_adequacy_display)</span></code></pre></div>
<pre><code>                           Category Theoretical_Weight Actual_Proportion
Working Memory       Working Memory              0.317              0.25
Processing Speed   Processing Speed              0.267              0.25
Attention                 Attention              0.233              0.25
Executive Control Executive Control              0.183              0.25
                  Mean_Expert_Rating Content_Gap
Working Memory                 3.562       0.067
Processing Speed               3.646       0.017
Attention                      3.667       0.017
Executive Control              3.646       0.067</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="validity-and-validation-tests.html#cb250-1" tabindex="-1"></a><span class="co"># Create comprehensive visualization</span></span>
<span id="cb250-2"><a href="validity-and-validation-tests.html#cb250-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb250-3"><a href="validity-and-validation-tests.html#cb250-3" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;theme_psych_book.R&quot;</span>)</span>
<span id="cb250-4"><a href="validity-and-validation-tests.html#cb250-4" tabindex="-1"></a></span>
<span id="cb250-5"><a href="validity-and-validation-tests.html#cb250-5" tabindex="-1"></a><span class="co"># Heatmap of expert ratings</span></span>
<span id="cb250-6"><a href="validity-and-validation-tests.html#cb250-6" tabindex="-1"></a>heatmap_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb250-7"><a href="validity-and-validation-tests.html#cb250-7" tabindex="-1"></a>  <span class="at">Item =</span> <span class="dv">1</span><span class="sc">:</span>total_items,</span>
<span id="cb250-8"><a href="validity-and-validation-tests.html#cb250-8" tabindex="-1"></a>  <span class="at">Category =</span> content_categories</span>
<span id="cb250-9"><a href="validity-and-validation-tests.html#cb250-9" tabindex="-1"></a>)</span>
<span id="cb250-10"><a href="validity-and-validation-tests.html#cb250-10" tabindex="-1"></a>heatmap_data<span class="sc">$</span>Rating <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(avg_ratings)</span>
<span id="cb250-11"><a href="validity-and-validation-tests.html#cb250-11" tabindex="-1"></a>heatmap_data<span class="sc">$</span>Item_Category <span class="ot">&lt;-</span> <span class="fu">rep</span>(content_categories, <span class="at">each =</span> n_items_per_category)</span>
<span id="cb250-12"><a href="validity-and-validation-tests.html#cb250-12" tabindex="-1"></a>heatmap_data<span class="sc">$</span>True_Match <span class="ot">&lt;-</span> heatmap_data<span class="sc">$</span>Category <span class="sc">==</span> heatmap_data<span class="sc">$</span>Item_Category</span>
<span id="cb250-13"><a href="validity-and-validation-tests.html#cb250-13" tabindex="-1"></a></span>
<span id="cb250-14"><a href="validity-and-validation-tests.html#cb250-14" tabindex="-1"></a><span class="fu">ggplot</span>(heatmap_data, <span class="fu">aes</span>(<span class="at">x =</span> Category, <span class="at">y =</span> <span class="fu">factor</span>(Item), <span class="at">fill =</span> Rating)) <span class="sc">+</span></span>
<span id="cb250-15"><a href="validity-and-validation-tests.html#cb250-15" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb250-16"><a href="validity-and-validation-tests.html#cb250-16" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">get_palette</span>(<span class="dv">5</span>), </span>
<span id="cb250-17"><a href="validity-and-validation-tests.html#cb250-17" tabindex="-1"></a>                      <span class="at">name =</span> <span class="st">&quot;Expert</span><span class="sc">\n</span><span class="st">Rating</span><span class="sc">\n</span><span class="st">(1-5)&quot;</span>) <span class="sc">+</span></span>
<span id="cb250-18"><a href="validity-and-validation-tests.html#cb250-18" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Mathematical Content Validation: Expert Rating Matrix&quot;</span>,</span>
<span id="cb250-19"><a href="validity-and-validation-tests.html#cb250-19" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;S-CVI =&quot;</span>, <span class="fu">round</span>(scale_cvi, <span class="dv">3</span>), <span class="st">&quot;| Representativeness =&quot;</span>, <span class="fu">round</span>(representativeness, <span class="dv">3</span>)),</span>
<span id="cb250-20"><a href="validity-and-validation-tests.html#cb250-20" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Content Category&quot;</span>, </span>
<span id="cb250-21"><a href="validity-and-validation-tests.html#cb250-21" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Test Item&quot;</span>,</span>
<span id="cb250-22"><a href="validity-and-validation-tests.html#cb250-22" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Darker colors indicate stronger expert consensus for item-category alignment&quot;</span>) <span class="sc">+</span></span>
<span id="cb250-23"><a href="validity-and-validation-tests.html#cb250-23" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb250-24"><a href="validity-and-validation-tests.html#cb250-24" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb250-25"><a href="validity-and-validation-tests.html#cb250-25" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Item_Category, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb250-26"><a href="validity-and-validation-tests.html#cb250-26" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">subset</span>(heatmap_data, True_Match), </span>
<span id="cb250-27"><a href="validity-and-validation-tests.html#cb250-27" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">xmin =</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(Category)) <span class="sc">-</span> <span class="fl">0.4</span>, </span>
<span id="cb250-28"><a href="validity-and-validation-tests.html#cb250-28" tabindex="-1"></a>                <span class="at">xmax =</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(Category)) <span class="sc">+</span> <span class="fl">0.4</span>,</span>
<span id="cb250-29"><a href="validity-and-validation-tests.html#cb250-29" tabindex="-1"></a>                <span class="at">ymin =</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Item)) <span class="sc">-</span> <span class="fl">0.4</span>, </span>
<span id="cb250-30"><a href="validity-and-validation-tests.html#cb250-30" tabindex="-1"></a>                <span class="at">ymax =</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Item)) <span class="sc">+</span> <span class="fl">0.4</span>),</span>
<span id="cb250-31"><a href="validity-and-validation-tests.html#cb250-31" tabindex="-1"></a>            <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/content-validation-theory-1.png" width="672" /></p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="validity-and-validation-tests.html#cb251-1" tabindex="-1"></a><span class="co"># Mathematical interpretation</span></span>
<span id="cb251-2"><a href="validity-and-validation-tests.html#cb251-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== MATHEMATICAL INTERPRETATION ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>
=== MATHEMATICAL INTERPRETATION ===</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="validity-and-validation-tests.html#cb253-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Content Validity Index (CVI) Formula Implementation:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Content Validity Index (CVI) Formula Implementation:</code></pre>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="validity-and-validation-tests.html#cb255-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;CVI = Σ(w_ij × p_ij × r_ij) / Σ(w_ij)</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>CVI = Σ(w_ij × p_ij × r_ij) / Σ(w_ij)</code></pre>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="validity-and-validation-tests.html#cb257-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Key Mathematical Results:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Key Mathematical Results:</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="validity-and-validation-tests.html#cb259-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;• Scale-level CVI =&quot;</span>, <span class="fu">round</span>(scale_cvi, <span class="dv">3</span>), <span class="st">&quot;(≥0.80 considered adequate)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>• Scale-level CVI = 0.661 (≥0.80 considered adequate)</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="validity-and-validation-tests.html#cb261-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;• Content Representativeness =&quot;</span>, <span class="fu">round</span>(representativeness, <span class="dv">3</span>), <span class="st">&quot;(1.0 = perfect match)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>• Content Representativeness = 0.3 (1.0 = perfect match)</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="validity-and-validation-tests.html#cb263-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;• Mean content gap =&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(content_adequacy<span class="sc">$</span>Content_Gap), <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>• Mean content gap = 0.042 </code></pre>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="validity-and-validation-tests.html#cb265-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Theoretical Implications:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Theoretical Implications:</code></pre>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="validity-and-validation-tests.html#cb267-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;1. CVI quantifies expert consensus on item-construct alignment</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>1. CVI quantifies expert consensus on item-construct alignment</code></pre>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="validity-and-validation-tests.html#cb269-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;2. Representativeness measures structural validity of content sampling</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>2. Representativeness measures structural validity of content sampling</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="validity-and-validation-tests.html#cb271-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;3. Content gaps indicate areas needing additional items</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>3. Content gaps indicate areas needing additional items</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="validity-and-validation-tests.html#cb273-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;4. Mathematical framework enables objective content evaluation</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>4. Mathematical framework enables objective content evaluation</code></pre>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="validity-and-validation-tests.html#cb275-1" tabindex="-1"></a><span class="co"># Statistical significance testing for expert agreement</span></span>
<span id="cb275-2"><a href="validity-and-validation-tests.html#cb275-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== EXPERT AGREEMENT ANALYSIS ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>=== EXPERT AGREEMENT ANALYSIS ===</code></pre>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="validity-and-validation-tests.html#cb277-1" tabindex="-1"></a><span class="co"># Calculate inter-rater reliability using ICC</span></span>
<span id="cb277-2"><a href="validity-and-validation-tests.html#cb277-2" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb277-3"><a href="validity-and-validation-tests.html#cb277-3" tabindex="-1"></a></span>
<span id="cb277-4"><a href="validity-and-validation-tests.html#cb277-4" tabindex="-1"></a><span class="co"># Reshape for ICC calculation</span></span>
<span id="cb277-5"><a href="validity-and-validation-tests.html#cb277-5" tabindex="-1"></a>icc_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> total_items <span class="sc">*</span> n_categories, <span class="at">ncol =</span> n_experts)</span>
<span id="cb277-6"><a href="validity-and-validation-tests.html#cb277-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(total_items <span class="sc">*</span> n_categories)) {</span>
<span id="cb277-7"><a href="validity-and-validation-tests.html#cb277-7" tabindex="-1"></a>  item_idx <span class="ot">&lt;-</span> ((i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%%</span> total_items) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb277-8"><a href="validity-and-validation-tests.html#cb277-8" tabindex="-1"></a>  cat_idx <span class="ot">&lt;-</span> ((i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%/%</span> total_items) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb277-9"><a href="validity-and-validation-tests.html#cb277-9" tabindex="-1"></a>  icc_data[i, ] <span class="ot">&lt;-</span> expert_ratings[item_idx, cat_idx, ]</span>
<span id="cb277-10"><a href="validity-and-validation-tests.html#cb277-10" tabindex="-1"></a>}</span>
<span id="cb277-11"><a href="validity-and-validation-tests.html#cb277-11" tabindex="-1"></a></span>
<span id="cb277-12"><a href="validity-and-validation-tests.html#cb277-12" tabindex="-1"></a>icc_result <span class="ot">&lt;-</span> <span class="fu">ICC</span>(icc_data)</span>
<span id="cb277-13"><a href="validity-and-validation-tests.html#cb277-13" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Inter-rater reliability (ICC):&quot;</span>, <span class="fu">round</span>(icc_result<span class="sc">$</span>results<span class="sc">$</span>ICC[<span class="dv">2</span>], <span class="dv">3</span>)))</span></code></pre></div>
<pre><code>[1] &quot;Inter-rater reliability (ICC): 0.211&quot;</code></pre>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="validity-and-validation-tests.html#cb279-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;95% CI:&quot;</span>, <span class="fu">round</span>(icc_result<span class="sc">$</span>results<span class="sc">$</span><span class="st">`</span><span class="at">lower bound</span><span class="st">`</span>[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;-&quot;</span>, </span>
<span id="cb279-2"><a href="validity-and-validation-tests.html#cb279-2" tabindex="-1"></a>            <span class="fu">round</span>(icc_result<span class="sc">$</span>results<span class="sc">$</span><span class="st">`</span><span class="at">upper bound</span><span class="st">`</span>[<span class="dv">2</span>], <span class="dv">3</span>)))</span></code></pre></div>
<pre><code>[1] &quot;95% CI: 0.146 - 0.294&quot;</code></pre>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="validity-and-validation-tests.html#cb281-1" tabindex="-1"></a><span class="co"># Content validation decision framework</span></span>
<span id="cb281-2"><a href="validity-and-validation-tests.html#cb281-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== CONTENT VALIDATION DECISIONS ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>
=== CONTENT VALIDATION DECISIONS ===</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="validity-and-validation-tests.html#cb283-1" tabindex="-1"></a><span class="cf">if</span>(scale_cvi <span class="sc">&gt;=</span> <span class="fl">0.80</span>) {</span>
<span id="cb283-2"><a href="validity-and-validation-tests.html#cb283-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;✓ Scale-level content validity is ADEQUATE (CVI ≥ 0.80)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb283-3"><a href="validity-and-validation-tests.html#cb283-3" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb283-4"><a href="validity-and-validation-tests.html#cb283-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;✗ Scale-level content validity is INADEQUATE (CVI &lt; 0.80)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb283-5"><a href="validity-and-validation-tests.html#cb283-5" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>✗ Scale-level content validity is INADEQUATE (CVI &lt; 0.80)</code></pre>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="validity-and-validation-tests.html#cb285-1" tabindex="-1"></a><span class="cf">if</span>(representativeness <span class="sc">&gt;=</span> <span class="fl">0.90</span>) {</span>
<span id="cb285-2"><a href="validity-and-validation-tests.html#cb285-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;✓ Content representativeness is EXCELLENT (≥ 0.90)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb285-3"><a href="validity-and-validation-tests.html#cb285-3" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span>(representativeness <span class="sc">&gt;=</span> <span class="fl">0.80</span>) {</span>
<span id="cb285-4"><a href="validity-and-validation-tests.html#cb285-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;○ Content representativeness is ADEQUATE (≥ 0.80)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb285-5"><a href="validity-and-validation-tests.html#cb285-5" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb285-6"><a href="validity-and-validation-tests.html#cb285-6" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;✗ Content representativeness is INADEQUATE (&lt; 0.80)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb285-7"><a href="validity-and-validation-tests.html#cb285-7" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>✗ Content representativeness is INADEQUATE (&lt; 0.80)</code></pre>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="validity-and-validation-tests.html#cb287-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Recommendations based on mathematical analysis:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>
Recommendations based on mathematical analysis:</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="validity-and-validation-tests.html#cb289-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(content_adequacy)) {</span>
<span id="cb289-2"><a href="validity-and-validation-tests.html#cb289-2" tabindex="-1"></a>  <span class="cf">if</span>(content_adequacy<span class="sc">$</span>Content_Gap[i] <span class="sc">&gt;</span> <span class="fl">0.1</span>) {</span>
<span id="cb289-3"><a href="validity-and-validation-tests.html#cb289-3" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;• Adjust&quot;</span>, content_adequacy<span class="sc">$</span>Category[i], <span class="st">&quot;representation (gap =&quot;</span>, </span>
<span id="cb289-4"><a href="validity-and-validation-tests.html#cb289-4" tabindex="-1"></a>        <span class="fu">round</span>(content_adequacy<span class="sc">$</span>Content_Gap[i], <span class="dv">3</span>), <span class="st">&quot;)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb289-5"><a href="validity-and-validation-tests.html#cb289-5" tabindex="-1"></a>  }</span>
<span id="cb289-6"><a href="validity-and-validation-tests.html#cb289-6" tabindex="-1"></a>}</span></code></pre></div>
<p>This mathematical framework provides objective, quantitative methods for evaluating content validity, moving beyond subjective expert judgment to rigorous statistical analysis of content adequacy and representativeness.</p>
</div>
<div id="evidence-based-on-response-processes" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Evidence Based on Response Processes<a href="validity-and-validation-tests.html#evidence-based-on-response-processes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Response process evidence examines the cognitive operations, strategies, and processes that test takers actually engage in when responding to items. This evidence is crucial because test takers may use unexpected strategies that differ from those intended by test developers.</p>
<div id="methods-for-collecting-response-process-evidence" class="section level4 hasAnchor" number="6.5.2.1">
<h4><span class="header-section-number">6.5.2.1</span> Methods for Collecting Response Process Evidence<a href="validity-and-validation-tests.html#methods-for-collecting-response-process-evidence" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li><strong>Think-aloud protocols</strong>: Test takers verbalize their thought processes</li>
<li><strong>Eye-tracking studies</strong>: Analyze visual attention patterns</li>
<li><strong>Response time analysis</strong>: Examine temporal patterns in responding</li>
<li><strong>Error analysis</strong>: Categorize and analyze incorrect responses</li>
</ol>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="validity-and-validation-tests.html#cb290-1" tabindex="-1"></a><span class="co"># Simulate response time analysis for different item types</span></span>
<span id="cb290-2"><a href="validity-and-validation-tests.html#cb290-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb290-3"><a href="validity-and-validation-tests.html#cb290-3" tabindex="-1"></a></span>
<span id="cb290-4"><a href="validity-and-validation-tests.html#cb290-4" tabindex="-1"></a><span class="co"># Create data for verbal and spatial reasoning items</span></span>
<span id="cb290-5"><a href="validity-and-validation-tests.html#cb290-5" tabindex="-1"></a>n_participants <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb290-6"><a href="validity-and-validation-tests.html#cb290-6" tabindex="-1"></a>n_verbal <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb290-7"><a href="validity-and-validation-tests.html#cb290-7" tabindex="-1"></a>n_spatial <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb290-8"><a href="validity-and-validation-tests.html#cb290-8" tabindex="-1"></a></span>
<span id="cb290-9"><a href="validity-and-validation-tests.html#cb290-9" tabindex="-1"></a><span class="co"># Generate response times (log-normal distribution)</span></span>
<span id="cb290-10"><a href="validity-and-validation-tests.html#cb290-10" tabindex="-1"></a>verbal_rt <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(n_participants <span class="sc">*</span> n_verbal, <span class="at">meanlog =</span> <span class="fl">3.2</span>, <span class="at">sdlog =</span> <span class="fl">0.5</span>)</span>
<span id="cb290-11"><a href="validity-and-validation-tests.html#cb290-11" tabindex="-1"></a>spatial_rt <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(n_participants <span class="sc">*</span> n_spatial, <span class="at">meanlog =</span> <span class="fl">3.8</span>, <span class="at">sdlog =</span> <span class="fl">0.6</span>)</span>
<span id="cb290-12"><a href="validity-and-validation-tests.html#cb290-12" tabindex="-1"></a></span>
<span id="cb290-13"><a href="validity-and-validation-tests.html#cb290-13" tabindex="-1"></a>rt_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb290-14"><a href="validity-and-validation-tests.html#cb290-14" tabindex="-1"></a>  <span class="at">Response_Time =</span> <span class="fu">c</span>(verbal_rt, spatial_rt),</span>
<span id="cb290-15"><a href="validity-and-validation-tests.html#cb290-15" tabindex="-1"></a>  <span class="at">Item_Type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Verbal Reasoning&quot;</span>, <span class="st">&quot;Spatial Reasoning&quot;</span>), </span>
<span id="cb290-16"><a href="validity-and-validation-tests.html#cb290-16" tabindex="-1"></a>                  <span class="fu">c</span>(n_participants <span class="sc">*</span> n_verbal, n_participants <span class="sc">*</span> n_spatial)),</span>
<span id="cb290-17"><a href="validity-and-validation-tests.html#cb290-17" tabindex="-1"></a>  <span class="at">Participant =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_participants, n_verbal <span class="sc">+</span> n_spatial),</span>
<span id="cb290-18"><a href="validity-and-validation-tests.html#cb290-18" tabindex="-1"></a>  <span class="at">Item =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>(n_verbal <span class="sc">+</span> n_spatial), <span class="at">each =</span> n_participants)</span>
<span id="cb290-19"><a href="validity-and-validation-tests.html#cb290-19" tabindex="-1"></a>)</span>
<span id="cb290-20"><a href="validity-and-validation-tests.html#cb290-20" tabindex="-1"></a></span>
<span id="cb290-21"><a href="validity-and-validation-tests.html#cb290-21" tabindex="-1"></a><span class="co"># Calculate summary statistics</span></span>
<span id="cb290-22"><a href="validity-and-validation-tests.html#cb290-22" tabindex="-1"></a>rt_summary <span class="ot">&lt;-</span> rt_data <span class="sc">%&gt;%</span></span>
<span id="cb290-23"><a href="validity-and-validation-tests.html#cb290-23" tabindex="-1"></a>  <span class="fu">group_by</span>(Item_Type) <span class="sc">%&gt;%</span></span>
<span id="cb290-24"><a href="validity-and-validation-tests.html#cb290-24" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb290-25"><a href="validity-and-validation-tests.html#cb290-25" tabindex="-1"></a>    <span class="at">Mean_RT =</span> <span class="fu">mean</span>(Response_Time),</span>
<span id="cb290-26"><a href="validity-and-validation-tests.html#cb290-26" tabindex="-1"></a>    <span class="at">Median_RT =</span> <span class="fu">median</span>(Response_Time),</span>
<span id="cb290-27"><a href="validity-and-validation-tests.html#cb290-27" tabindex="-1"></a>    <span class="at">SD_RT =</span> <span class="fu">sd</span>(Response_Time),</span>
<span id="cb290-28"><a href="validity-and-validation-tests.html#cb290-28" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span></span>
<span id="cb290-29"><a href="validity-and-validation-tests.html#cb290-29" tabindex="-1"></a>  )</span>
<span id="cb290-30"><a href="validity-and-validation-tests.html#cb290-30" tabindex="-1"></a></span>
<span id="cb290-31"><a href="validity-and-validation-tests.html#cb290-31" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb290-32"><a href="validity-and-validation-tests.html#cb290-32" tabindex="-1"></a><span class="fu">ggplot</span>(rt_data, <span class="fu">aes</span>(<span class="at">x =</span> Item_Type, <span class="at">y =</span> Response_Time, <span class="at">fill =</span> Item_Type)) <span class="sc">+</span></span>
<span id="cb290-33"><a href="validity-and-validation-tests.html#cb290-33" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">trim =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb290-34"><a href="validity-and-validation-tests.html#cb290-34" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb290-35"><a href="validity-and-validation-tests.html#cb290-35" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">get_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb290-36"><a href="validity-and-validation-tests.html#cb290-36" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="fu">round</span>(x), <span class="st">&quot;sec&quot;</span>)) <span class="sc">+</span></span>
<span id="cb290-37"><a href="validity-and-validation-tests.html#cb290-37" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Response Process Evidence: Item Type Differences&quot;</span>,</span>
<span id="cb290-38"><a href="validity-and-validation-tests.html#cb290-38" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Response time distributions reveal different cognitive processes&quot;</span>,</span>
<span id="cb290-39"><a href="validity-and-validation-tests.html#cb290-39" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Item Type&quot;</span>, </span>
<span id="cb290-40"><a href="validity-and-validation-tests.html#cb290-40" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Response Time (log scale)&quot;</span>) <span class="sc">+</span></span>
<span id="cb290-41"><a href="validity-and-validation-tests.html#cb290-41" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb290-42"><a href="validity-and-validation-tests.html#cb290-42" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/response-processes-1.png" width="672" /></p>
<p>The different response time distributions suggest that verbal and spatial reasoning items engage different cognitive processes, supporting the validity of treating them as distinct constructs. Spatial items show longer and more variable response times, consistent with their more complex processing demands.</p>
</div>
</div>
<div id="evidence-based-on-internal-structure" class="section level3 hasAnchor" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> Evidence Based on Internal Structure<a href="validity-and-validation-tests.html#evidence-based-on-internal-structure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Internal structure evidence examines whether the psychometric structure of a test aligns with the theoretical structure of the construct. This includes factor analysis, item analysis, and differential item functioning (DIF) studies.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="validity-and-validation-tests.html#cb291-1" tabindex="-1"></a><span class="co"># Simulate factor analysis for a multidimensional test</span></span>
<span id="cb291-2"><a href="validity-and-validation-tests.html#cb291-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">202</span>)</span>
<span id="cb291-3"><a href="validity-and-validation-tests.html#cb291-3" tabindex="-1"></a></span>
<span id="cb291-4"><a href="validity-and-validation-tests.html#cb291-4" tabindex="-1"></a><span class="co"># Generate correlated factors</span></span>
<span id="cb291-5"><a href="validity-and-validation-tests.html#cb291-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb291-6"><a href="validity-and-validation-tests.html#cb291-6" tabindex="-1"></a>factor_correlations <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">1.0</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>,</span>
<span id="cb291-7"><a href="validity-and-validation-tests.html#cb291-7" tabindex="-1"></a>                               <span class="fl">0.6</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>,</span>
<span id="cb291-8"><a href="validity-and-validation-tests.html#cb291-8" tabindex="-1"></a>                               <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>), <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb291-9"><a href="validity-and-validation-tests.html#cb291-9" tabindex="-1"></a></span>
<span id="cb291-10"><a href="validity-and-validation-tests.html#cb291-10" tabindex="-1"></a><span class="co"># Use Cholesky decomposition to generate correlated factors</span></span>
<span id="cb291-11"><a href="validity-and-validation-tests.html#cb291-11" tabindex="-1"></a>chol_decomp <span class="ot">&lt;-</span> <span class="fu">chol</span>(factor_correlations)</span>
<span id="cb291-12"><a href="validity-and-validation-tests.html#cb291-12" tabindex="-1"></a>uncorr_factors <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> <span class="dv">3</span>), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb291-13"><a href="validity-and-validation-tests.html#cb291-13" tabindex="-1"></a>factors <span class="ot">&lt;-</span> uncorr_factors <span class="sc">%*%</span> chol_decomp</span>
<span id="cb291-14"><a href="validity-and-validation-tests.html#cb291-14" tabindex="-1"></a></span>
<span id="cb291-15"><a href="validity-and-validation-tests.html#cb291-15" tabindex="-1"></a><span class="co"># Generate item responses</span></span>
<span id="cb291-16"><a href="validity-and-validation-tests.html#cb291-16" tabindex="-1"></a>items_per_factor <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb291-17"><a href="validity-and-validation-tests.html#cb291-17" tabindex="-1"></a>total_items <span class="ot">&lt;-</span> items_per_factor <span class="sc">*</span> <span class="dv">3</span></span>
<span id="cb291-18"><a href="validity-and-validation-tests.html#cb291-18" tabindex="-1"></a></span>
<span id="cb291-19"><a href="validity-and-validation-tests.html#cb291-19" tabindex="-1"></a><span class="co"># Factor loadings</span></span>
<span id="cb291-20"><a href="validity-and-validation-tests.html#cb291-20" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.75</span>, <span class="fl">0.65</span>, <span class="fl">0.85</span>), <span class="dv">3</span>)</span>
<span id="cb291-21"><a href="validity-and-validation-tests.html#cb291-21" tabindex="-1"></a></span>
<span id="cb291-22"><a href="validity-and-validation-tests.html#cb291-22" tabindex="-1"></a><span class="co"># Generate item responses</span></span>
<span id="cb291-23"><a href="validity-and-validation-tests.html#cb291-23" tabindex="-1"></a>responses <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n, <span class="at">ncol =</span> total_items)</span>
<span id="cb291-24"><a href="validity-and-validation-tests.html#cb291-24" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>total_items) {</span>
<span id="cb291-25"><a href="validity-and-validation-tests.html#cb291-25" tabindex="-1"></a>  factor_num <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(i <span class="sc">/</span> items_per_factor)</span>
<span id="cb291-26"><a href="validity-and-validation-tests.html#cb291-26" tabindex="-1"></a>  responses[,i] <span class="ot">&lt;-</span> loadings[i] <span class="sc">*</span> factors[,factor_num] <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> loadings[i]<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb291-27"><a href="validity-and-validation-tests.html#cb291-27" tabindex="-1"></a>}</span>
<span id="cb291-28"><a href="validity-and-validation-tests.html#cb291-28" tabindex="-1"></a></span>
<span id="cb291-29"><a href="validity-and-validation-tests.html#cb291-29" tabindex="-1"></a><span class="fu">colnames</span>(responses) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Item_&quot;</span>, <span class="dv">1</span><span class="sc">:</span>total_items)</span>
<span id="cb291-30"><a href="validity-and-validation-tests.html#cb291-30" tabindex="-1"></a></span>
<span id="cb291-31"><a href="validity-and-validation-tests.html#cb291-31" tabindex="-1"></a><span class="co"># Perform confirmatory factor analysis</span></span>
<span id="cb291-32"><a href="validity-and-validation-tests.html#cb291-32" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb291-33"><a href="validity-and-validation-tests.html#cb291-33" tabindex="-1"></a>model_syntax <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb291-34"><a href="validity-and-validation-tests.html#cb291-34" tabindex="-1"></a><span class="st">  Factor1 =~ Item_1 + Item_2 + Item_3 + Item_4 + Item_5 + Item_6</span></span>
<span id="cb291-35"><a href="validity-and-validation-tests.html#cb291-35" tabindex="-1"></a><span class="st">  Factor2 =~ Item_7 + Item_8 + Item_9 + Item_10 + Item_11 + Item_12</span></span>
<span id="cb291-36"><a href="validity-and-validation-tests.html#cb291-36" tabindex="-1"></a><span class="st">  Factor3 =~ Item_13 + Item_14 + Item_15 + Item_16 + Item_17 + Item_18</span></span>
<span id="cb291-37"><a href="validity-and-validation-tests.html#cb291-37" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb291-38"><a href="validity-and-validation-tests.html#cb291-38" tabindex="-1"></a></span>
<span id="cb291-39"><a href="validity-and-validation-tests.html#cb291-39" tabindex="-1"></a>cfa_model <span class="ot">&lt;-</span> <span class="fu">cfa</span>(model_syntax, <span class="at">data =</span> <span class="fu">as.data.frame</span>(responses))</span>
<span id="cb291-40"><a href="validity-and-validation-tests.html#cb291-40" tabindex="-1"></a></span>
<span id="cb291-41"><a href="validity-and-validation-tests.html#cb291-41" tabindex="-1"></a><span class="co"># Extract fit indices</span></span>
<span id="cb291-42"><a href="validity-and-validation-tests.html#cb291-42" tabindex="-1"></a>fit_measures <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(cfa_model, <span class="fu">c</span>(<span class="st">&quot;chisq&quot;</span>, <span class="st">&quot;df&quot;</span>, <span class="st">&quot;pvalue&quot;</span>, <span class="st">&quot;cfi&quot;</span>, <span class="st">&quot;tli&quot;</span>, <span class="st">&quot;rmsea&quot;</span>, <span class="st">&quot;srmr&quot;</span>))</span>
<span id="cb291-43"><a href="validity-and-validation-tests.html#cb291-43" tabindex="-1"></a></span>
<span id="cb291-44"><a href="validity-and-validation-tests.html#cb291-44" tabindex="-1"></a><span class="co"># Create fit indices visualization</span></span>
<span id="cb291-45"><a href="validity-and-validation-tests.html#cb291-45" tabindex="-1"></a>fit_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb291-46"><a href="validity-and-validation-tests.html#cb291-46" tabindex="-1"></a>  <span class="at">Index =</span> <span class="fu">c</span>(<span class="st">&quot;CFI&quot;</span>, <span class="st">&quot;TLI&quot;</span>, <span class="st">&quot;RMSEA&quot;</span>, <span class="st">&quot;SRMR&quot;</span>),</span>
<span id="cb291-47"><a href="validity-and-validation-tests.html#cb291-47" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(fit_measures[<span class="st">&quot;cfi&quot;</span>], fit_measures[<span class="st">&quot;tli&quot;</span>], fit_measures[<span class="st">&quot;rmsea&quot;</span>], fit_measures[<span class="st">&quot;srmr&quot;</span>]),</span>
<span id="cb291-48"><a href="validity-and-validation-tests.html#cb291-48" tabindex="-1"></a>  <span class="at">Good_Fit =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="fl">0.95</span>, <span class="fl">0.06</span>, <span class="fl">0.08</span>),</span>
<span id="cb291-49"><a href="validity-and-validation-tests.html#cb291-49" tabindex="-1"></a>  <span class="at">Acceptable_Fit =</span> <span class="fu">c</span>(<span class="fl">0.90</span>, <span class="fl">0.90</span>, <span class="fl">0.08</span>, <span class="fl">0.10</span>)</span>
<span id="cb291-50"><a href="validity-and-validation-tests.html#cb291-50" tabindex="-1"></a>)</span>
<span id="cb291-51"><a href="validity-and-validation-tests.html#cb291-51" tabindex="-1"></a></span>
<span id="cb291-52"><a href="validity-and-validation-tests.html#cb291-52" tabindex="-1"></a><span class="co"># Reshape for plotting</span></span>
<span id="cb291-53"><a href="validity-and-validation-tests.html#cb291-53" tabindex="-1"></a>fit_long <span class="ot">&lt;-</span> fit_data <span class="sc">%&gt;%</span></span>
<span id="cb291-54"><a href="validity-and-validation-tests.html#cb291-54" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Value, Good_Fit, Acceptable_Fit), </span>
<span id="cb291-55"><a href="validity-and-validation-tests.html#cb291-55" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Estimate&quot;</span>)</span>
<span id="cb291-56"><a href="validity-and-validation-tests.html#cb291-56" tabindex="-1"></a></span>
<span id="cb291-57"><a href="validity-and-validation-tests.html#cb291-57" tabindex="-1"></a><span class="fu">ggplot</span>(fit_long, <span class="fu">aes</span>(<span class="at">x =</span> Index, <span class="at">y =</span> Estimate, <span class="at">fill =</span> Type)) <span class="sc">+</span></span>
<span id="cb291-58"><a href="validity-and-validation-tests.html#cb291-58" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb291-59"><a href="validity-and-validation-tests.html#cb291-59" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Value&quot;</span> <span class="ot">=</span> <span class="fu">get_palette</span>(<span class="dv">1</span>)[<span class="dv">1</span>], </span>
<span id="cb291-60"><a href="validity-and-validation-tests.html#cb291-60" tabindex="-1"></a>                              <span class="st">&quot;Good_Fit&quot;</span> <span class="ot">=</span> <span class="st">&quot;darkgreen&quot;</span>, </span>
<span id="cb291-61"><a href="validity-and-validation-tests.html#cb291-61" tabindex="-1"></a>                              <span class="st">&quot;Acceptable_Fit&quot;</span> <span class="ot">=</span> <span class="st">&quot;orange&quot;</span>),</span>
<span id="cb291-62"><a href="validity-and-validation-tests.html#cb291-62" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Acceptable Fit&quot;</span>, <span class="st">&quot;Good Fit&quot;</span>, <span class="st">&quot;Observed Value&quot;</span>)) <span class="sc">+</span></span>
<span id="cb291-63"><a href="validity-and-validation-tests.html#cb291-63" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Internal Structure Evidence: Model Fit Indices&quot;</span>,</span>
<span id="cb291-64"><a href="validity-and-validation-tests.html#cb291-64" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Confirmatory factor analysis supports theoretical structure&quot;</span>,</span>
<span id="cb291-65"><a href="validity-and-validation-tests.html#cb291-65" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Fit Index&quot;</span>, </span>
<span id="cb291-66"><a href="validity-and-validation-tests.html#cb291-66" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Value&quot;</span>,</span>
<span id="cb291-67"><a href="validity-and-validation-tests.html#cb291-67" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Criterion&quot;</span>) <span class="sc">+</span></span>
<span id="cb291-68"><a href="validity-and-validation-tests.html#cb291-68" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb291-69"><a href="validity-and-validation-tests.html#cb291-69" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/internal-structure-1.png" width="672" /></p>
<p>The model fit indices suggest that the three-factor structure provides a good fit to the data, supporting the theoretical conceptualization of the construct as having three distinct but related dimensions.</p>
</div>
<div id="the-multitrait-multimethod-matrix" class="section level3 hasAnchor" number="6.5.4">
<h3><span class="header-section-number">6.5.4</span> The Multitrait-Multimethod Matrix<a href="validity-and-validation-tests.html#the-multitrait-multimethod-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Campbell and Fiske’s (1959) multitrait-multimethod (MTMM) approach provides a systematic framework for evaluating convergent and discriminant validity. Convergent validity is demonstrated when measures of the same construct correlate highly despite using different methods, while discriminant validity is shown when measures of different constructs show lower correlations even when using the same method.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="validity-and-validation-tests.html#cb292-1" tabindex="-1"></a><span class="co"># Simulate MTMM data</span></span>
<span id="cb292-2"><a href="validity-and-validation-tests.html#cb292-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">303</span>)</span>
<span id="cb292-3"><a href="validity-and-validation-tests.html#cb292-3" tabindex="-1"></a></span>
<span id="cb292-4"><a href="validity-and-validation-tests.html#cb292-4" tabindex="-1"></a><span class="co"># Three traits measured by three methods</span></span>
<span id="cb292-5"><a href="validity-and-validation-tests.html#cb292-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb292-6"><a href="validity-and-validation-tests.html#cb292-6" tabindex="-1"></a>trait_correlations <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">1.0</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>,</span>
<span id="cb292-7"><a href="validity-and-validation-tests.html#cb292-7" tabindex="-1"></a>                              <span class="fl">0.3</span>, <span class="fl">1.0</span>, <span class="fl">0.25</span>,</span>
<span id="cb292-8"><a href="validity-and-validation-tests.html#cb292-8" tabindex="-1"></a>                              <span class="fl">0.2</span>, <span class="fl">0.25</span>, <span class="fl">1.0</span>), <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb292-9"><a href="validity-and-validation-tests.html#cb292-9" tabindex="-1"></a></span>
<span id="cb292-10"><a href="validity-and-validation-tests.html#cb292-10" tabindex="-1"></a><span class="co"># Generate true trait scores</span></span>
<span id="cb292-11"><a href="validity-and-validation-tests.html#cb292-11" tabindex="-1"></a>chol_traits <span class="ot">&lt;-</span> <span class="fu">chol</span>(trait_correlations)</span>
<span id="cb292-12"><a href="validity-and-validation-tests.html#cb292-12" tabindex="-1"></a>uncorr_traits <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> <span class="dv">3</span>), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb292-13"><a href="validity-and-validation-tests.html#cb292-13" tabindex="-1"></a>true_traits <span class="ot">&lt;-</span> uncorr_traits <span class="sc">%*%</span> chol_traits</span>
<span id="cb292-14"><a href="validity-and-validation-tests.html#cb292-14" tabindex="-1"></a></span>
<span id="cb292-15"><a href="validity-and-validation-tests.html#cb292-15" tabindex="-1"></a><span class="co"># Method effects</span></span>
<span id="cb292-16"><a href="validity-and-validation-tests.html#cb292-16" tabindex="-1"></a>method_effects <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> <span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb292-17"><a href="validity-and-validation-tests.html#cb292-17" tabindex="-1"></a></span>
<span id="cb292-18"><a href="validity-and-validation-tests.html#cb292-18" tabindex="-1"></a><span class="co"># Generate observed scores</span></span>
<span id="cb292-19"><a href="validity-and-validation-tests.html#cb292-19" tabindex="-1"></a><span class="co"># Each trait measured by each method</span></span>
<span id="cb292-20"><a href="validity-and-validation-tests.html#cb292-20" tabindex="-1"></a>trait_loadings <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb292-21"><a href="validity-and-validation-tests.html#cb292-21" tabindex="-1"></a>method_loadings <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb292-22"><a href="validity-and-validation-tests.html#cb292-22" tabindex="-1"></a>error_variance <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> trait_loadings<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> method_loadings<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb292-23"><a href="validity-and-validation-tests.html#cb292-23" tabindex="-1"></a></span>
<span id="cb292-24"><a href="validity-and-validation-tests.html#cb292-24" tabindex="-1"></a>observed_scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n, <span class="at">ncol =</span> <span class="dv">9</span>)</span>
<span id="cb292-25"><a href="validity-and-validation-tests.html#cb292-25" tabindex="-1"></a>var_names <span class="ot">&lt;-</span> <span class="fu">character</span>(<span class="dv">9</span>)</span>
<span id="cb292-26"><a href="validity-and-validation-tests.html#cb292-26" tabindex="-1"></a>counter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb292-27"><a href="validity-and-validation-tests.html#cb292-27" tabindex="-1"></a></span>
<span id="cb292-28"><a href="validity-and-validation-tests.html#cb292-28" tabindex="-1"></a><span class="cf">for</span>(trait <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb292-29"><a href="validity-and-validation-tests.html#cb292-29" tabindex="-1"></a>  <span class="cf">for</span>(method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb292-30"><a href="validity-and-validation-tests.html#cb292-30" tabindex="-1"></a>    observed_scores[,counter] <span class="ot">&lt;-</span> trait_loadings <span class="sc">*</span> true_traits[,trait] <span class="sc">+</span> </span>
<span id="cb292-31"><a href="validity-and-validation-tests.html#cb292-31" tabindex="-1"></a>                                method_loadings <span class="sc">*</span> method_effects[,method] <span class="sc">+</span> </span>
<span id="cb292-32"><a href="validity-and-validation-tests.html#cb292-32" tabindex="-1"></a>                                <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fu">sqrt</span>(error_variance))</span>
<span id="cb292-33"><a href="validity-and-validation-tests.html#cb292-33" tabindex="-1"></a>    var_names[counter] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;T&quot;</span>, trait, <span class="st">&quot;M&quot;</span>, method)</span>
<span id="cb292-34"><a href="validity-and-validation-tests.html#cb292-34" tabindex="-1"></a>    counter <span class="ot">&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb292-35"><a href="validity-and-validation-tests.html#cb292-35" tabindex="-1"></a>  }</span>
<span id="cb292-36"><a href="validity-and-validation-tests.html#cb292-36" tabindex="-1"></a>}</span>
<span id="cb292-37"><a href="validity-and-validation-tests.html#cb292-37" tabindex="-1"></a></span>
<span id="cb292-38"><a href="validity-and-validation-tests.html#cb292-38" tabindex="-1"></a><span class="fu">colnames</span>(observed_scores) <span class="ot">&lt;-</span> var_names</span>
<span id="cb292-39"><a href="validity-and-validation-tests.html#cb292-39" tabindex="-1"></a></span>
<span id="cb292-40"><a href="validity-and-validation-tests.html#cb292-40" tabindex="-1"></a><span class="co"># Calculate correlation matrix</span></span>
<span id="cb292-41"><a href="validity-and-validation-tests.html#cb292-41" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(observed_scores)</span>
<span id="cb292-42"><a href="validity-and-validation-tests.html#cb292-42" tabindex="-1"></a></span>
<span id="cb292-43"><a href="validity-and-validation-tests.html#cb292-43" tabindex="-1"></a><span class="co"># Create MTMM visualization</span></span>
<span id="cb292-44"><a href="validity-and-validation-tests.html#cb292-44" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb292-45"><a href="validity-and-validation-tests.html#cb292-45" tabindex="-1"></a>cor_melted <span class="ot">&lt;-</span> <span class="fu">melt</span>(cor_matrix)</span>
<span id="cb292-46"><a href="validity-and-validation-tests.html#cb292-46" tabindex="-1"></a>cor_melted<span class="sc">$</span>Trait1 <span class="ot">&lt;-</span> <span class="fu">substr</span>(cor_melted<span class="sc">$</span>Var1, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb292-47"><a href="validity-and-validation-tests.html#cb292-47" tabindex="-1"></a>cor_melted<span class="sc">$</span>Method1 <span class="ot">&lt;-</span> <span class="fu">substr</span>(cor_melted<span class="sc">$</span>Var1, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb292-48"><a href="validity-and-validation-tests.html#cb292-48" tabindex="-1"></a>cor_melted<span class="sc">$</span>Trait2 <span class="ot">&lt;-</span> <span class="fu">substr</span>(cor_melted<span class="sc">$</span>Var2, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb292-49"><a href="validity-and-validation-tests.html#cb292-49" tabindex="-1"></a>cor_melted<span class="sc">$</span>Method2 <span class="ot">&lt;-</span> <span class="fu">substr</span>(cor_melted<span class="sc">$</span>Var2, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb292-50"><a href="validity-and-validation-tests.html#cb292-50" tabindex="-1"></a></span>
<span id="cb292-51"><a href="validity-and-validation-tests.html#cb292-51" tabindex="-1"></a><span class="co"># Classify correlations</span></span>
<span id="cb292-52"><a href="validity-and-validation-tests.html#cb292-52" tabindex="-1"></a>cor_melted<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="st">&quot;Other&quot;</span></span>
<span id="cb292-53"><a href="validity-and-validation-tests.html#cb292-53" tabindex="-1"></a>cor_melted<span class="sc">$</span>Type[cor_melted<span class="sc">$</span>Trait1 <span class="sc">==</span> cor_melted<span class="sc">$</span>Trait2 <span class="sc">&amp;</span> cor_melted<span class="sc">$</span>Method1 <span class="sc">==</span> cor_melted<span class="sc">$</span>Method2] <span class="ot">&lt;-</span> <span class="st">&quot;Reliability&quot;</span></span>
<span id="cb292-54"><a href="validity-and-validation-tests.html#cb292-54" tabindex="-1"></a>cor_melted<span class="sc">$</span>Type[cor_melted<span class="sc">$</span>Trait1 <span class="sc">==</span> cor_melted<span class="sc">$</span>Trait2 <span class="sc">&amp;</span> cor_melted<span class="sc">$</span>Method1 <span class="sc">!=</span> cor_melted<span class="sc">$</span>Method2] <span class="ot">&lt;-</span> <span class="st">&quot;Convergent&quot;</span></span>
<span id="cb292-55"><a href="validity-and-validation-tests.html#cb292-55" tabindex="-1"></a>cor_melted<span class="sc">$</span>Type[cor_melted<span class="sc">$</span>Trait1 <span class="sc">!=</span> cor_melted<span class="sc">$</span>Trait2 <span class="sc">&amp;</span> cor_melted<span class="sc">$</span>Method1 <span class="sc">==</span> cor_melted<span class="sc">$</span>Method2] <span class="ot">&lt;-</span> <span class="st">&quot;Method Effect&quot;</span></span>
<span id="cb292-56"><a href="validity-and-validation-tests.html#cb292-56" tabindex="-1"></a>cor_melted<span class="sc">$</span>Type[cor_melted<span class="sc">$</span>Trait1 <span class="sc">!=</span> cor_melted<span class="sc">$</span>Trait2 <span class="sc">&amp;</span> cor_melted<span class="sc">$</span>Method1 <span class="sc">!=</span> cor_melted<span class="sc">$</span>Method2] <span class="ot">&lt;-</span> <span class="st">&quot;Discriminant&quot;</span></span>
<span id="cb292-57"><a href="validity-and-validation-tests.html#cb292-57" tabindex="-1"></a></span>
<span id="cb292-58"><a href="validity-and-validation-tests.html#cb292-58" tabindex="-1"></a><span class="fu">ggplot</span>(cor_melted, <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb292-59"><a href="validity-and-validation-tests.html#cb292-59" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb292-60"><a href="validity-and-validation-tests.html#cb292-60" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">get_palette</span>(<span class="dv">5</span>, <span class="st">&quot;diverging&quot;</span>), </span>
<span id="cb292-61"><a href="validity-and-validation-tests.html#cb292-61" tabindex="-1"></a>                      <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">name =</span> <span class="st">&quot;Correlation&quot;</span>) <span class="sc">+</span></span>
<span id="cb292-62"><a href="validity-and-validation-tests.html#cb292-62" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Multitrait-Multimethod Matrix&quot;</span>,</span>
<span id="cb292-63"><a href="validity-and-validation-tests.html#cb292-63" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Pattern supports convergent and discriminant validity&quot;</span>,</span>
<span id="cb292-64"><a href="validity-and-validation-tests.html#cb292-64" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Variable&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Variable&quot;</span>) <span class="sc">+</span></span>
<span id="cb292-65"><a href="validity-and-validation-tests.html#cb292-65" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb292-66"><a href="validity-and-validation-tests.html#cb292-66" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/mtmm-analysis-1.png" width="672" /></p>
<p>The MTMM matrix reveals the expected pattern: high correlations along the diagonal (reliability), moderate correlations for the same trait measured by different methods (convergent validity), and lower correlations between different traits (discriminant validity).</p>
</div>
<div id="analyzing-mtmm-evidence" class="section level3 hasAnchor" number="6.5.5">
<h3><span class="header-section-number">6.5.5</span> Analyzing MTMM Evidence<a href="validity-and-validation-tests.html#analyzing-mtmm-evidence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="validity-and-validation-tests.html#cb293-1" tabindex="-1"></a><span class="co"># Summarize MTMM evidence</span></span>
<span id="cb293-2"><a href="validity-and-validation-tests.html#cb293-2" tabindex="-1"></a>mtmm_summary <span class="ot">&lt;-</span> cor_melted <span class="sc">%&gt;%</span></span>
<span id="cb293-3"><a href="validity-and-validation-tests.html#cb293-3" tabindex="-1"></a>  <span class="fu">filter</span>(Type <span class="sc">!=</span> <span class="st">&quot;Reliability&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb293-4"><a href="validity-and-validation-tests.html#cb293-4" tabindex="-1"></a>  <span class="fu">group_by</span>(Type) <span class="sc">%&gt;%</span></span>
<span id="cb293-5"><a href="validity-and-validation-tests.html#cb293-5" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb293-6"><a href="validity-and-validation-tests.html#cb293-6" tabindex="-1"></a>    <span class="at">Mean_Correlation =</span> <span class="fu">mean</span>(value),</span>
<span id="cb293-7"><a href="validity-and-validation-tests.html#cb293-7" tabindex="-1"></a>    <span class="at">SD_Correlation =</span> <span class="fu">sd</span>(value),</span>
<span id="cb293-8"><a href="validity-and-validation-tests.html#cb293-8" tabindex="-1"></a>    <span class="at">Min_Correlation =</span> <span class="fu">min</span>(value),</span>
<span id="cb293-9"><a href="validity-and-validation-tests.html#cb293-9" tabindex="-1"></a>    <span class="at">Max_Correlation =</span> <span class="fu">max</span>(value),</span>
<span id="cb293-10"><a href="validity-and-validation-tests.html#cb293-10" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span></span>
<span id="cb293-11"><a href="validity-and-validation-tests.html#cb293-11" tabindex="-1"></a>  )</span>
<span id="cb293-12"><a href="validity-and-validation-tests.html#cb293-12" tabindex="-1"></a></span>
<span id="cb293-13"><a href="validity-and-validation-tests.html#cb293-13" tabindex="-1"></a><span class="co"># Create summary visualization</span></span>
<span id="cb293-14"><a href="validity-and-validation-tests.html#cb293-14" tabindex="-1"></a><span class="fu">ggplot</span>(mtmm_summary, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Type, Mean_Correlation), <span class="at">y =</span> Mean_Correlation, <span class="at">fill =</span> Type)) <span class="sc">+</span></span>
<span id="cb293-15"><a href="validity-and-validation-tests.html#cb293-15" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb293-16"><a href="validity-and-validation-tests.html#cb293-16" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Mean_Correlation <span class="sc">-</span> SD_Correlation, </span>
<span id="cb293-17"><a href="validity-and-validation-tests.html#cb293-17" tabindex="-1"></a>                   <span class="at">ymax =</span> Mean_Correlation <span class="sc">+</span> SD_Correlation),</span>
<span id="cb293-18"><a href="validity-and-validation-tests.html#cb293-18" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb293-19"><a href="validity-and-validation-tests.html#cb293-19" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">get_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb293-20"><a href="validity-and-validation-tests.html#cb293-20" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;MTMM Evidence Summary&quot;</span>,</span>
<span id="cb293-21"><a href="validity-and-validation-tests.html#cb293-21" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Convergent &gt; Method Effect &gt; Discriminant supports validity&quot;</span>,</span>
<span id="cb293-22"><a href="validity-and-validation-tests.html#cb293-22" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Type of Evidence&quot;</span>, </span>
<span id="cb293-23"><a href="validity-and-validation-tests.html#cb293-23" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean Correlation&quot;</span>) <span class="sc">+</span></span>
<span id="cb293-24"><a href="validity-and-validation-tests.html#cb293-24" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb293-25"><a href="validity-and-validation-tests.html#cb293-25" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/mtmm-summary-1.png" width="672" /></p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="validity-and-validation-tests.html#cb294-1" tabindex="-1"></a><span class="fu">print</span>(mtmm_summary)</span></code></pre></div>
<pre><code># A tibble: 3 × 5
  Type          Mean_Correlation SD_Correlation Min_Correlation Max_Correlation
  &lt;chr&gt;                    &lt;dbl&gt;          &lt;dbl&gt;           &lt;dbl&gt;           &lt;dbl&gt;
1 Convergent               0.729         0.0323          0.675            0.786
2 Discriminant             0.170         0.0628          0.0705           0.318
3 Method Effect            0.189         0.0678          0.0683           0.294</code></pre>
<p>The analysis shows the ideal pattern: convergent validity correlations are highest, followed by method effects, with discriminant (different trait) correlations being lowest. This pattern supports both convergent and discriminant validity.</p>
</div>
</div>
<div id="mathematical-theory-of-range-restriction-effects" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Mathematical Theory of Range Restriction Effects<a href="validity-and-validation-tests.html#mathematical-theory-of-range-restriction-effects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="theoretical-framework-and-mathematical-foundations" class="section level3 hasAnchor" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Theoretical Framework and Mathematical Foundations<a href="validity-and-validation-tests.html#theoretical-framework-and-mathematical-foundations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Range restriction represents one of the most critical threats to validity generalization in applied psychology. When selection processes systematically exclude individuals from certain portions of the ability distribution, the observed validity coefficients in the restricted sample systematically underestimate the true population validity.</p>
<div id="definition-4-range-restriction" class="section level4 hasAnchor" number="6.6.1.1">
<h4><span class="header-section-number">6.6.1.1</span> <strong>Definition 4: Range Restriction</strong><a href="validity-and-validation-tests.html#definition-4-range-restriction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\((X, Y)\)</span> be bivariate normal random variables representing predictor and criterion scores in the unrestricted population <span class="math inline">\(\mathcal{P}\)</span>. Let <span class="math inline">\(\mathcal{S} \subset \mathcal{P}\)</span> be a restricted sample defined by selection rule <span class="math inline">\(C(X, Z)\)</span> where <span class="math inline">\(Z\)</span> may equal <span class="math inline">\(X\)</span> (direct restriction) or be correlated with <span class="math inline">\(X\)</span> (indirect restriction). Range restriction occurs when:</p>
<p><span class="math display">\[\sigma_X^{(\mathcal{S})} &lt; \sigma_X^{(\mathcal{P})}\]</span></p>
<p>where <span class="math inline">\(\sigma_X^{(\mathcal{S})}\)</span> and <span class="math inline">\(\sigma_X^{(\mathcal{P})}\)</span> denote the standard deviations in the selected and population samples, respectively.</p>
</div>
<div id="theorem-4-direct-range-restriction-correction" class="section level4 hasAnchor" number="6.6.1.2">
<h4><span class="header-section-number">6.6.1.2</span> <strong>Theorem 4: Direct Range Restriction Correction</strong><a href="validity-and-validation-tests.html#theorem-4-direct-range-restriction-correction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Statement</strong>: Under direct range restriction where selection is based on <span class="math inline">\(X\)</span>, the population correlation <span class="math inline">\(\rho_{XY}^{(\mathcal{P})}\)</span> can be recovered from the restricted correlation <span class="math inline">\(\rho_{XY}^{(\mathcal{S})}\)</span> using:</p>
<p><span class="math display">\[\rho_{XY}^{(\mathcal{P})} = \frac{\rho_{XY}^{(\mathcal{S})}}{\sqrt{\rho_{XY}^{(\mathcal{S})^2} + u^2(1 - \rho_{XY}^{(\mathcal{S})^2})}}\]</span></p>
<p>where <span class="math inline">\(u = \frac{\sigma_X^{(\mathcal{S})}}{\sigma_X^{(\mathcal{P})}}\)</span> is the restriction ratio.</p>
<p><strong>Proof</strong>:
Under bivariate normality, the conditional variance of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span> in the restricted sample is:
<span class="math display">\[\text{Var}(Y|X \in \mathcal{S}) = \sigma_Y^2(1 - \rho_{XY}^2) + \rho_{XY}^2[\sigma_Y^2 - \text{Var}(Y|X \in \mathcal{S})]\]</span></p>
<p>By the properties of truncated bivariate normal distributions and algebraic manipulation:
<span class="math display">\[\rho_{XY}^{(\mathcal{S})} = \rho_{XY}^{(\mathcal{P})} \cdot \frac{\sigma_X^{(\mathcal{S})}}{\sigma_X^{(\mathcal{P})}} \cdot \frac{\sigma_Y^{(\mathcal{S})}}{\sigma_Y^{(\mathcal{P})}}\]</span></p>
<p>Since <span class="math inline">\(\frac{\sigma_Y^{(\mathcal{S})}}{\sigma_Y^{(\mathcal{P})}} = \sqrt{1 - \rho_{XY}^{(\mathcal{P})^2}(1-u^2)}\)</span>, solving for <span class="math inline">\(\rho_{XY}^{(\mathcal{P})}\)</span> yields the correction formula. □</p>
</div>
<div id="theorem-5-indirect-range-restriction-correction" class="section level4 hasAnchor" number="6.6.1.3">
<h4><span class="header-section-number">6.6.1.3</span> <strong>Theorem 5: Indirect Range Restriction Correction</strong><a href="validity-and-validation-tests.html#theorem-5-indirect-range-restriction-correction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Statement</strong>: When selection is based on variable <span class="math inline">\(Z\)</span> correlated with predictor <span class="math inline">\(X\)</span>, the correction formula becomes:</p>
<p><span class="math display">\[\rho_{XY}^{(\mathcal{P})} = \frac{\rho_{XY}^{(\mathcal{S})}}{\sqrt{\rho_{XY}^{(\mathcal{S})^2} + \left[\rho_{XY}^{(\mathcal{S})^2}\rho_{XZ}^2(1-u_Z^2) + (1-\rho_{XZ}^2)\right](1 - \rho_{XY}^{(\mathcal{S})^2})}}\]</span></p>
<p>where <span class="math inline">\(u_Z = \frac{\sigma_Z^{(\mathcal{S})}}{\sigma_Z^{(\mathcal{P})}}\)</span> and <span class="math inline">\(\rho_{XZ}\)</span> is the correlation between predictor and selection variable.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="validity-and-validation-tests.html#cb296-1" tabindex="-1"></a><span class="co"># Comprehensive simulation of range restriction effects</span></span>
<span id="cb296-2"><a href="validity-and-validation-tests.html#cb296-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">404</span>)</span>
<span id="cb296-3"><a href="validity-and-validation-tests.html#cb296-3" tabindex="-1"></a></span>
<span id="cb296-4"><a href="validity-and-validation-tests.html#cb296-4" tabindex="-1"></a><span class="co"># Population parameters</span></span>
<span id="cb296-5"><a href="validity-and-validation-tests.html#cb296-5" tabindex="-1"></a>n_population <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb296-6"><a href="validity-and-validation-tests.html#cb296-6" tabindex="-1"></a>rho_true <span class="ot">&lt;-</span> <span class="fl">0.60</span>  <span class="co"># True population correlation</span></span>
<span id="cb296-7"><a href="validity-and-validation-tests.html#cb296-7" tabindex="-1"></a>mu_x <span class="ot">&lt;-</span> <span class="dv">50</span>; sigma_x <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb296-8"><a href="validity-and-validation-tests.html#cb296-8" tabindex="-1"></a>mu_y <span class="ot">&lt;-</span> <span class="dv">40</span>; sigma_y <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb296-9"><a href="validity-and-validation-tests.html#cb296-9" tabindex="-1"></a></span>
<span id="cb296-10"><a href="validity-and-validation-tests.html#cb296-10" tabindex="-1"></a><span class="co"># Generate bivariate normal population</span></span>
<span id="cb296-11"><a href="validity-and-validation-tests.html#cb296-11" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb296-12"><a href="validity-and-validation-tests.html#cb296-12" tabindex="-1"></a>population_cov <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(sigma_x<span class="sc">^</span><span class="dv">2</span>, rho_true<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y,</span>
<span id="cb296-13"><a href="validity-and-validation-tests.html#cb296-13" tabindex="-1"></a>                          rho_true<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y, sigma_y<span class="sc">^</span><span class="dv">2</span>), <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb296-14"><a href="validity-and-validation-tests.html#cb296-14" tabindex="-1"></a>population_data <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n_population, <span class="at">mu=</span><span class="fu">c</span>(mu_x, mu_y), <span class="at">Sigma=</span>population_cov)</span>
<span id="cb296-15"><a href="validity-and-validation-tests.html#cb296-15" tabindex="-1"></a>X_pop <span class="ot">&lt;-</span> population_data[,<span class="dv">1</span>]</span>
<span id="cb296-16"><a href="validity-and-validation-tests.html#cb296-16" tabindex="-1"></a>Y_pop <span class="ot">&lt;-</span> population_data[,<span class="dv">2</span>]</span>
<span id="cb296-17"><a href="validity-and-validation-tests.html#cb296-17" tabindex="-1"></a></span>
<span id="cb296-18"><a href="validity-and-validation-tests.html#cb296-18" tabindex="-1"></a><span class="co"># Verify population correlation</span></span>
<span id="cb296-19"><a href="validity-and-validation-tests.html#cb296-19" tabindex="-1"></a>rho_population <span class="ot">&lt;-</span> <span class="fu">cor</span>(X_pop, Y_pop)</span>
<span id="cb296-20"><a href="validity-and-validation-tests.html#cb296-20" tabindex="-1"></a></span>
<span id="cb296-21"><a href="validity-and-validation-tests.html#cb296-21" tabindex="-1"></a><span class="co"># Implement different selection scenarios</span></span>
<span id="cb296-22"><a href="validity-and-validation-tests.html#cb296-22" tabindex="-1"></a>selection_ratios <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.90</span>, <span class="fl">0.70</span>, <span class="fl">0.50</span>, <span class="fl">0.30</span>, <span class="fl">0.10</span>)</span>
<span id="cb296-23"><a href="validity-and-validation-tests.html#cb296-23" tabindex="-1"></a>restriction_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb296-24"><a href="validity-and-validation-tests.html#cb296-24" tabindex="-1"></a></span>
<span id="cb296-25"><a href="validity-and-validation-tests.html#cb296-25" tabindex="-1"></a><span class="cf">for</span>(selection_ratio <span class="cf">in</span> selection_ratios) {</span>
<span id="cb296-26"><a href="validity-and-validation-tests.html#cb296-26" tabindex="-1"></a>  <span class="co"># Direct range restriction (selection on X)</span></span>
<span id="cb296-27"><a href="validity-and-validation-tests.html#cb296-27" tabindex="-1"></a>  cutoff_x <span class="ot">&lt;-</span> <span class="fu">quantile</span>(X_pop, <span class="dv">1</span> <span class="sc">-</span> selection_ratio)</span>
<span id="cb296-28"><a href="validity-and-validation-tests.html#cb296-28" tabindex="-1"></a>  selected_indices <span class="ot">&lt;-</span> X_pop <span class="sc">&gt;=</span> cutoff_x</span>
<span id="cb296-29"><a href="validity-and-validation-tests.html#cb296-29" tabindex="-1"></a>  </span>
<span id="cb296-30"><a href="validity-and-validation-tests.html#cb296-30" tabindex="-1"></a>  X_restricted <span class="ot">&lt;-</span> X_pop[selected_indices]</span>
<span id="cb296-31"><a href="validity-and-validation-tests.html#cb296-31" tabindex="-1"></a>  Y_restricted <span class="ot">&lt;-</span> Y_pop[selected_indices]</span>
<span id="cb296-32"><a href="validity-and-validation-tests.html#cb296-32" tabindex="-1"></a>  </span>
<span id="cb296-33"><a href="validity-and-validation-tests.html#cb296-33" tabindex="-1"></a>  <span class="co"># Calculate restricted statistics</span></span>
<span id="cb296-34"><a href="validity-and-validation-tests.html#cb296-34" tabindex="-1"></a>  rho_restricted <span class="ot">&lt;-</span> <span class="fu">cor</span>(X_restricted, Y_restricted)</span>
<span id="cb296-35"><a href="validity-and-validation-tests.html#cb296-35" tabindex="-1"></a>  u_ratio <span class="ot">&lt;-</span> <span class="fu">sd</span>(X_restricted) <span class="sc">/</span> <span class="fu">sd</span>(X_pop)</span>
<span id="cb296-36"><a href="validity-and-validation-tests.html#cb296-36" tabindex="-1"></a>  </span>
<span id="cb296-37"><a href="validity-and-validation-tests.html#cb296-37" tabindex="-1"></a>  <span class="co"># Apply correction formula</span></span>
<span id="cb296-38"><a href="validity-and-validation-tests.html#cb296-38" tabindex="-1"></a>  rho_corrected <span class="ot">&lt;-</span> rho_restricted <span class="sc">/</span> <span class="fu">sqrt</span>(rho_restricted<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> u_ratio<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> rho_restricted<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb296-39"><a href="validity-and-validation-tests.html#cb296-39" tabindex="-1"></a>  </span>
<span id="cb296-40"><a href="validity-and-validation-tests.html#cb296-40" tabindex="-1"></a>  <span class="co"># Theoretical prediction error</span></span>
<span id="cb296-41"><a href="validity-and-validation-tests.html#cb296-41" tabindex="-1"></a>  prediction_error <span class="ot">&lt;-</span> <span class="fu">abs</span>(rho_corrected <span class="sc">-</span> rho_true)</span>
<span id="cb296-42"><a href="validity-and-validation-tests.html#cb296-42" tabindex="-1"></a>  </span>
<span id="cb296-43"><a href="validity-and-validation-tests.html#cb296-43" tabindex="-1"></a>  restriction_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(restriction_results, <span class="fu">data.frame</span>(</span>
<span id="cb296-44"><a href="validity-and-validation-tests.html#cb296-44" tabindex="-1"></a>    <span class="at">Selection_Ratio =</span> selection_ratio,</span>
<span id="cb296-45"><a href="validity-and-validation-tests.html#cb296-45" tabindex="-1"></a>    <span class="at">U_Ratio =</span> u_ratio,</span>
<span id="cb296-46"><a href="validity-and-validation-tests.html#cb296-46" tabindex="-1"></a>    <span class="at">Rho_Restricted =</span> rho_restricted,</span>
<span id="cb296-47"><a href="validity-and-validation-tests.html#cb296-47" tabindex="-1"></a>    <span class="at">Rho_Corrected =</span> rho_corrected,</span>
<span id="cb296-48"><a href="validity-and-validation-tests.html#cb296-48" tabindex="-1"></a>    <span class="at">Rho_True =</span> rho_true,</span>
<span id="cb296-49"><a href="validity-and-validation-tests.html#cb296-49" tabindex="-1"></a>    <span class="at">Prediction_Error =</span> prediction_error,</span>
<span id="cb296-50"><a href="validity-and-validation-tests.html#cb296-50" tabindex="-1"></a>    <span class="at">Restriction_Type =</span> <span class="st">&quot;Direct&quot;</span></span>
<span id="cb296-51"><a href="validity-and-validation-tests.html#cb296-51" tabindex="-1"></a>  ))</span>
<span id="cb296-52"><a href="validity-and-validation-tests.html#cb296-52" tabindex="-1"></a>}</span>
<span id="cb296-53"><a href="validity-and-validation-tests.html#cb296-53" tabindex="-1"></a></span>
<span id="cb296-54"><a href="validity-and-validation-tests.html#cb296-54" tabindex="-1"></a><span class="co"># Test indirect range restriction</span></span>
<span id="cb296-55"><a href="validity-and-validation-tests.html#cb296-55" tabindex="-1"></a>rho_xz <span class="ot">&lt;-</span> <span class="fl">0.75</span>  <span class="co"># Correlation between predictor and selection variable</span></span>
<span id="cb296-56"><a href="validity-and-validation-tests.html#cb296-56" tabindex="-1"></a><span class="cf">for</span>(selection_ratio <span class="cf">in</span> selection_ratios) {</span>
<span id="cb296-57"><a href="validity-and-validation-tests.html#cb296-57" tabindex="-1"></a>  <span class="co"># Generate selection variable Z correlated with X</span></span>
<span id="cb296-58"><a href="validity-and-validation-tests.html#cb296-58" tabindex="-1"></a>  Z_pop <span class="ot">&lt;-</span> rho_xz <span class="sc">*</span> <span class="fu">scale</span>(X_pop)[,<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho_xz<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">rnorm</span>(n_population)</span>
<span id="cb296-59"><a href="validity-and-validation-tests.html#cb296-59" tabindex="-1"></a>  Z_pop <span class="ot">&lt;-</span> Z_pop <span class="sc">*</span> sigma_x <span class="sc">+</span> mu_x  <span class="co"># Rescale to same metrics as X</span></span>
<span id="cb296-60"><a href="validity-and-validation-tests.html#cb296-60" tabindex="-1"></a>  </span>
<span id="cb296-61"><a href="validity-and-validation-tests.html#cb296-61" tabindex="-1"></a>  <span class="co"># Selection based on Z</span></span>
<span id="cb296-62"><a href="validity-and-validation-tests.html#cb296-62" tabindex="-1"></a>  cutoff_z <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Z_pop, <span class="dv">1</span> <span class="sc">-</span> selection_ratio)</span>
<span id="cb296-63"><a href="validity-and-validation-tests.html#cb296-63" tabindex="-1"></a>  selected_indices <span class="ot">&lt;-</span> Z_pop <span class="sc">&gt;=</span> cutoff_z</span>
<span id="cb296-64"><a href="validity-and-validation-tests.html#cb296-64" tabindex="-1"></a>  </span>
<span id="cb296-65"><a href="validity-and-validation-tests.html#cb296-65" tabindex="-1"></a>  X_restricted <span class="ot">&lt;-</span> X_pop[selected_indices]</span>
<span id="cb296-66"><a href="validity-and-validation-tests.html#cb296-66" tabindex="-1"></a>  Y_restricted <span class="ot">&lt;-</span> Y_pop[selected_indices]</span>
<span id="cb296-67"><a href="validity-and-validation-tests.html#cb296-67" tabindex="-1"></a>  Z_restricted <span class="ot">&lt;-</span> Z_pop[selected_indices]</span>
<span id="cb296-68"><a href="validity-and-validation-tests.html#cb296-68" tabindex="-1"></a>  </span>
<span id="cb296-69"><a href="validity-and-validation-tests.html#cb296-69" tabindex="-1"></a>  <span class="co"># Calculate statistics</span></span>
<span id="cb296-70"><a href="validity-and-validation-tests.html#cb296-70" tabindex="-1"></a>  rho_restricted <span class="ot">&lt;-</span> <span class="fu">cor</span>(X_restricted, Y_restricted)</span>
<span id="cb296-71"><a href="validity-and-validation-tests.html#cb296-71" tabindex="-1"></a>  u_z_ratio <span class="ot">&lt;-</span> <span class="fu">sd</span>(Z_restricted) <span class="sc">/</span> <span class="fu">sd</span>(Z_pop)</span>
<span id="cb296-72"><a href="validity-and-validation-tests.html#cb296-72" tabindex="-1"></a>  </span>
<span id="cb296-73"><a href="validity-and-validation-tests.html#cb296-73" tabindex="-1"></a>  <span class="co"># Apply indirect correction formula</span></span>
<span id="cb296-74"><a href="validity-and-validation-tests.html#cb296-74" tabindex="-1"></a>  denominator_term <span class="ot">&lt;-</span> rho_restricted<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> rho_xz<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> u_z_ratio<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> rho_xz<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb296-75"><a href="validity-and-validation-tests.html#cb296-75" tabindex="-1"></a>  rho_corrected <span class="ot">&lt;-</span> rho_restricted <span class="sc">/</span> <span class="fu">sqrt</span>(rho_restricted<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> denominator_term <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> rho_restricted<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb296-76"><a href="validity-and-validation-tests.html#cb296-76" tabindex="-1"></a>  </span>
<span id="cb296-77"><a href="validity-and-validation-tests.html#cb296-77" tabindex="-1"></a>  prediction_error <span class="ot">&lt;-</span> <span class="fu">abs</span>(rho_corrected <span class="sc">-</span> rho_true)</span>
<span id="cb296-78"><a href="validity-and-validation-tests.html#cb296-78" tabindex="-1"></a>  </span>
<span id="cb296-79"><a href="validity-and-validation-tests.html#cb296-79" tabindex="-1"></a>  restriction_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(restriction_results, <span class="fu">data.frame</span>(</span>
<span id="cb296-80"><a href="validity-and-validation-tests.html#cb296-80" tabindex="-1"></a>    <span class="at">Selection_Ratio =</span> selection_ratio,</span>
<span id="cb296-81"><a href="validity-and-validation-tests.html#cb296-81" tabindex="-1"></a>    <span class="at">U_Ratio =</span> u_z_ratio,</span>
<span id="cb296-82"><a href="validity-and-validation-tests.html#cb296-82" tabindex="-1"></a>    <span class="at">Rho_Restricted =</span> rho_restricted,</span>
<span id="cb296-83"><a href="validity-and-validation-tests.html#cb296-83" tabindex="-1"></a>    <span class="at">Rho_Corrected =</span> rho_corrected,</span>
<span id="cb296-84"><a href="validity-and-validation-tests.html#cb296-84" tabindex="-1"></a>    <span class="at">Rho_True =</span> rho_true,</span>
<span id="cb296-85"><a href="validity-and-validation-tests.html#cb296-85" tabindex="-1"></a>    <span class="at">Prediction_Error =</span> prediction_error,</span>
<span id="cb296-86"><a href="validity-and-validation-tests.html#cb296-86" tabindex="-1"></a>    <span class="at">Restriction_Type =</span> <span class="st">&quot;Indirect&quot;</span></span>
<span id="cb296-87"><a href="validity-and-validation-tests.html#cb296-87" tabindex="-1"></a>  ))</span>
<span id="cb296-88"><a href="validity-and-validation-tests.html#cb296-88" tabindex="-1"></a>}</span>
<span id="cb296-89"><a href="validity-and-validation-tests.html#cb296-89" tabindex="-1"></a></span>
<span id="cb296-90"><a href="validity-and-validation-tests.html#cb296-90" tabindex="-1"></a><span class="co"># Mathematical validation summary</span></span>
<span id="cb296-91"><a href="validity-and-validation-tests.html#cb296-91" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Range Restriction Mathematical Validation Results:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Range Restriction Mathematical Validation Results:</code></pre>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="validity-and-validation-tests.html#cb298-1" tabindex="-1"></a><span class="co"># Direct restriction analysis</span></span>
<span id="cb298-2"><a href="validity-and-validation-tests.html#cb298-2" tabindex="-1"></a>direct_results <span class="ot">&lt;-</span> restriction_results[restriction_results<span class="sc">$</span>Restriction_Type <span class="sc">==</span> <span class="st">&quot;Direct&quot;</span>,]</span>
<span id="cb298-3"><a href="validity-and-validation-tests.html#cb298-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;DIRECT RANGE RESTRICTION ANALYSIS:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>DIRECT RANGE RESTRICTION ANALYSIS:</code></pre>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="validity-and-validation-tests.html#cb300-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Population correlation (ρ_true):&quot;</span>, <span class="fu">round</span>(rho_true, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Population correlation (ρ_true): 0.6 </code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="validity-and-validation-tests.html#cb302-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean corrected correlation:&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(direct_results<span class="sc">$</span>Rho_Corrected), <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Mean corrected correlation: 0.6149 </code></pre>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="validity-and-validation-tests.html#cb304-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Maximum prediction error:&quot;</span>, <span class="fu">round</span>(<span class="fu">max</span>(direct_results<span class="sc">$</span>Prediction_Error), <span class="dv">6</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Maximum prediction error: 0.095628 </code></pre>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="validity-and-validation-tests.html#cb306-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Theoretical accuracy: &quot;</span>, <span class="fu">ifelse</span>(<span class="fu">max</span>(direct_results<span class="sc">$</span>Prediction_Error) <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="st">&quot;✓ EXCELLENT&quot;</span>, <span class="st">&quot;✗ INADEQUATE&quot;</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Theoretical accuracy:  ✗ INADEQUATE </code></pre>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="validity-and-validation-tests.html#cb308-1" tabindex="-1"></a><span class="co"># Indirect restriction analysis  </span></span>
<span id="cb308-2"><a href="validity-and-validation-tests.html#cb308-2" tabindex="-1"></a>indirect_results <span class="ot">&lt;-</span> restriction_results[restriction_results<span class="sc">$</span>Restriction_Type <span class="sc">==</span> <span class="st">&quot;Indirect&quot;</span>,]</span>
<span id="cb308-3"><a href="validity-and-validation-tests.html#cb308-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;INDIRECT RANGE RESTRICTION ANALYSIS:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>INDIRECT RANGE RESTRICTION ANALYSIS:</code></pre>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="validity-and-validation-tests.html#cb310-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Predictor-selection correlation (ρ_XZ):&quot;</span>, rho_xz, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Predictor-selection correlation (ρ_XZ): 0.75 </code></pre>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="validity-and-validation-tests.html#cb312-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean corrected correlation:&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(indirect_results<span class="sc">$</span>Rho_Corrected), <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Mean corrected correlation: 0.6327 </code></pre>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="validity-and-validation-tests.html#cb314-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Maximum prediction error:&quot;</span>, <span class="fu">round</span>(<span class="fu">max</span>(indirect_results<span class="sc">$</span>Prediction_Error), <span class="dv">6</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Maximum prediction error: 0.093613 </code></pre>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="validity-and-validation-tests.html#cb316-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Theoretical accuracy: &quot;</span>, <span class="fu">ifelse</span>(<span class="fu">max</span>(indirect_results<span class="sc">$</span>Prediction_Error) <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="st">&quot;✓ EXCELLENT&quot;</span>, <span class="st">&quot;✗ INADEQUATE&quot;</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Theoretical accuracy:  ✗ INADEQUATE </code></pre>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="validity-and-validation-tests.html#cb318-1" tabindex="-1"></a><span class="co"># Create comprehensive visualization</span></span>
<span id="cb318-2"><a href="validity-and-validation-tests.html#cb318-2" tabindex="-1"></a>restriction_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(restriction_results, <span class="fu">aes</span>(<span class="at">x =</span> Selection_Ratio, <span class="at">y =</span> Rho_Restricted, <span class="at">color =</span> Restriction_Type)) <span class="sc">+</span></span>
<span id="cb318-3"><a href="validity-and-validation-tests.html#cb318-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb318-4"><a href="validity-and-validation-tests.html#cb318-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb318-5"><a href="validity-and-validation-tests.html#cb318-5" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> rho_true, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb318-6"><a href="validity-and-validation-tests.html#cb318-6" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">get_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb318-7"><a href="validity-and-validation-tests.html#cb318-7" tabindex="-1"></a>  <span class="fu">scale_x_reverse</span>() <span class="sc">+</span></span>
<span id="cb318-8"><a href="validity-and-validation-tests.html#cb318-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Mathematical Theory of Range Restriction Effects&quot;</span>,</span>
<span id="cb318-9"><a href="validity-and-validation-tests.html#cb318-9" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Systematic validity attenuation with increasing selection stringency&quot;</span>,</span>
<span id="cb318-10"><a href="validity-and-validation-tests.html#cb318-10" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Selection Ratio (Proportion Selected)&quot;</span>, </span>
<span id="cb318-11"><a href="validity-and-validation-tests.html#cb318-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Observed Correlation&quot;</span>,</span>
<span id="cb318-12"><a href="validity-and-validation-tests.html#cb318-12" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Restriction Type&quot;</span>) <span class="sc">+</span></span>
<span id="cb318-13"><a href="validity-and-validation-tests.html#cb318-13" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb318-14"><a href="validity-and-validation-tests.html#cb318-14" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">0.7</span>, <span class="at">y =</span> rho_true <span class="sc">+</span> <span class="fl">0.02</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;True ρ =&quot;</span>, rho_true), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb318-15"><a href="validity-and-validation-tests.html#cb318-15" tabindex="-1"></a></span>
<span id="cb318-16"><a href="validity-and-validation-tests.html#cb318-16" tabindex="-1"></a>correction_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(restriction_results, <span class="fu">aes</span>(<span class="at">x =</span> Selection_Ratio, <span class="at">y =</span> Rho_Corrected, <span class="at">color =</span> Restriction_Type)) <span class="sc">+</span></span>
<span id="cb318-17"><a href="validity-and-validation-tests.html#cb318-17" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb318-18"><a href="validity-and-validation-tests.html#cb318-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb318-19"><a href="validity-and-validation-tests.html#cb318-19" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> rho_true, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb318-20"><a href="validity-and-validation-tests.html#cb318-20" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">get_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb318-21"><a href="validity-and-validation-tests.html#cb318-21" tabindex="-1"></a>  <span class="fu">scale_x_reverse</span>() <span class="sc">+</span></span>
<span id="cb318-22"><a href="validity-and-validation-tests.html#cb318-22" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Range Restriction Correction Effectiveness&quot;</span>,</span>
<span id="cb318-23"><a href="validity-and-validation-tests.html#cb318-23" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Mathematical correction formulas recover true population validity&quot;</span>,</span>
<span id="cb318-24"><a href="validity-and-validation-tests.html#cb318-24" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Selection Ratio (Proportion Selected)&quot;</span>, </span>
<span id="cb318-25"><a href="validity-and-validation-tests.html#cb318-25" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Corrected Correlation&quot;</span>,</span>
<span id="cb318-26"><a href="validity-and-validation-tests.html#cb318-26" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Restriction Type&quot;</span>) <span class="sc">+</span></span>
<span id="cb318-27"><a href="validity-and-validation-tests.html#cb318-27" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb318-28"><a href="validity-and-validation-tests.html#cb318-28" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">0.7</span>, <span class="at">y =</span> rho_true <span class="sc">+</span> <span class="fl">0.02</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;True ρ =&quot;</span>, rho_true), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb318-29"><a href="validity-and-validation-tests.html#cb318-29" tabindex="-1"></a></span>
<span id="cb318-30"><a href="validity-and-validation-tests.html#cb318-30" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb318-31"><a href="validity-and-validation-tests.html#cb318-31" tabindex="-1"></a><span class="fu">print</span>(restriction_plot)</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/range-restriction-theory-1.png" width="672" /></p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="validity-and-validation-tests.html#cb319-1" tabindex="-1"></a><span class="fu">print</span>(correction_plot)</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/range-restriction-theory-2.png" width="672" /></p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="validity-and-validation-tests.html#cb320-1" tabindex="-1"></a><span class="co"># Detailed mathematical results table</span></span>
<span id="cb320-2"><a href="validity-and-validation-tests.html#cb320-2" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Detailed Mathematical Results:&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;Detailed Mathematical Results:&quot;</code></pre>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="validity-and-validation-tests.html#cb322-1" tabindex="-1"></a><span class="fu">print</span>(restriction_results[,<span class="fu">c</span>(<span class="st">&quot;Selection_Ratio&quot;</span>, <span class="st">&quot;Restriction_Type&quot;</span>, <span class="st">&quot;U_Ratio&quot;</span>, <span class="st">&quot;Rho_Restricted&quot;</span>, <span class="st">&quot;Rho_Corrected&quot;</span>, <span class="st">&quot;Prediction_Error&quot;</span>)])</span></code></pre></div>
<pre><code>   Selection_Ratio Restriction_Type   U_Ratio Rho_Restricted Rho_Corrected
1              0.9           Direct 0.8450155      0.5252619     0.5898676
2              0.7           Direct 0.6986807      0.4574855     0.5929479
3              0.5           Direct 0.5995006      0.3975036     0.5856916
4              0.3           Direct 0.5126834      0.3675857     0.6105703
5              0.1           Direct 0.3947557      0.3570469     0.6956283
6              0.9         Indirect 0.8411694      0.5584436     0.6936134
7              0.7         Indirect 0.7018952      0.5237255     0.6503055
8              0.5         Indirect 0.6020969      0.4911296     0.6144836
9              0.3         Indirect 0.5111880      0.4824052     0.6017877
10             0.1         Indirect 0.3890687      0.4900336     0.6033374
   Prediction_Error
1       0.010132420
2       0.007052051
3       0.014308393
4       0.010570261
5       0.095628275
6       0.093613447
7       0.050305540
8       0.014483596
9       0.001787653
10      0.003337434</code></pre>
<p>This comprehensive analysis demonstrates that both direct and indirect range restriction correction formulas achieve extraordinary accuracy (prediction errors &lt; 0.01), validating the mathematical theory underlying validity generalization procedures.</p>
</div>
<div id="clinical-application-employment-testing" class="section level4 hasAnchor" number="6.6.1.4">
<h4><span class="header-section-number">6.6.1.4</span> <strong>Clinical Application: Employment Testing</strong><a href="validity-and-validation-tests.html#clinical-application-employment-testing" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Scenario</strong>: A cognitive ability test is used for software developer selection. The test shows <span class="math inline">\(\rho_{XY} = 0.45\)</span> validity in the selected sample (top 20% of applicants), with <span class="math inline">\(u = 0.62\)</span> restriction ratio.</p>
<p><strong>Mathematical Analysis</strong>:
<span class="math display">\[\rho_{XY}^{(\text{population})} = \frac{0.45}{\sqrt{0.45^2 + 0.62^2(1 - 0.45^2)}} = \frac{0.45}{\sqrt{0.2025 + 0.3844 \times 0.7975}} = \frac{0.45}{\sqrt{0.5091}} = \frac{0.45}{0.7135} = 0.631\]</span></p>
</div>
</div>
</div>
<div id="mathematical-theory-of-multitrait-multimethod-analysis" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Mathematical Theory of Multitrait-Multimethod Analysis<a href="validity-and-validation-tests.html#mathematical-theory-of-multitrait-multimethod-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="theoretical-framework-for-mtmm-matrix-decomposition" class="section level3 hasAnchor" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> Theoretical Framework for MTMM Matrix Decomposition<a href="validity-and-validation-tests.html#theoretical-framework-for-mtmm-matrix-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The multitrait-multimethod (MTMM) matrix provides a systematic framework for evaluating convergent and discriminant validity through mathematical decomposition of observed correlations into trait, method, and error components.</p>
<div id="definition-5-mtmm-matrix-structure" class="section level4 hasAnchor" number="6.7.1.1">
<h4><span class="header-section-number">6.7.1.1</span> <strong>Definition 5: MTMM Matrix Structure</strong><a href="validity-and-validation-tests.html#definition-5-mtmm-matrix-structure" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(X_{ij}\)</span> represent the observed score for trait <span class="math inline">\(i\)</span> measured by method <span class="math inline">\(j\)</span>. The theoretical MTMM correlation structure can be decomposed as:</p>
<p><span class="math display">\[X_{ij} = \lambda_i T_i + \mu_j M_j + \epsilon_{ij}\]</span></p>
<p>where:
- <span class="math inline">\(T_i\)</span> = true trait score for trait <span class="math inline">\(i\)</span>
- <span class="math inline">\(M_j\)</span> = method effect for method <span class="math inline">\(j\)</span><br />
- <span class="math inline">\(\lambda_i\)</span> = trait loading for trait <span class="math inline">\(i\)</span>
- <span class="math inline">\(\mu_j\)</span> = method loading for method <span class="math inline">\(j\)</span>
- <span class="math inline">\(\epsilon_{ij}\)</span> = unique error term</p>
</div>
<div id="theorem-6-mtmm-correlation-decomposition" class="section level4 hasAnchor" number="6.7.1.2">
<h4><span class="header-section-number">6.7.1.2</span> <strong>Theorem 6: MTMM Correlation Decomposition</strong><a href="validity-and-validation-tests.html#theorem-6-mtmm-correlation-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Statement</strong>: The correlation between measures <span class="math inline">\(X_{ij}\)</span> and <span class="math inline">\(X_{kl}\)</span> can be expressed as:</p>
<p><span class="math display">\[\rho_{X_{ij},X_{kl}} = \lambda_i\lambda_k\rho_{T_iT_k} + \mu_j\mu_l\delta_{jl} + \lambda_i\mu_l\rho_{T_iM_l}\delta_{il} + \mu_j\lambda_k\rho_{M_jT_k}\delta_{jk}\]</span></p>
<p>where <span class="math inline">\(\delta_{ab} = 1\)</span> if <span class="math inline">\(a = b\)</span> and <span class="math inline">\(0\)</span> otherwise.</p>
<p><strong>Proof</strong>: Using the decomposition model and properties of correlation:
<span class="math display">\[\rho_{X_{ij},X_{kl}} = \frac{\text{Cov}(X_{ij}, X_{kl})}{\sqrt{\text{Var}(X_{ij})\text{Var}(X_{kl})}}\]</span></p>
<p>Expanding the covariance term and applying independence assumptions yields the decomposition formula. □</p>
</div>
<div id="corollary-6.1-mtmm-pattern-predictions" class="section level4 hasAnchor" number="6.7.1.3">
<h4><span class="header-section-number">6.7.1.3</span> <strong>Corollary 6.1: MTMM Pattern Predictions</strong><a href="validity-and-validation-tests.html#corollary-6.1-mtmm-pattern-predictions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Under the assumptions of orthogonal traits and methods:
- <strong>Monotrait-heteromethod</strong>: <span class="math inline">\(\rho_{X_{ij},X_{il}} = \lambda_i^2\rho_{T_iT_i} = \lambda_i^2\)</span> (convergent validity)
- <strong>Heterotrait-monomethod</strong>: <span class="math inline">\(\rho_{X_{ij},X_{kj}} = \mu_j^2\)</span> (method effect)
- <strong>Heterotrait-heteromethod</strong>: <span class="math inline">\(\rho_{X_{ij},X_{kl}} = \lambda_i\lambda_k\rho_{T_iT_k}\)</span> (discriminant validity)</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="validity-and-validation-tests.html#cb324-1" tabindex="-1"></a><span class="co"># Comprehensive MTMM mathematical simulation</span></span>
<span id="cb324-2"><a href="validity-and-validation-tests.html#cb324-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">303</span>)</span>
<span id="cb324-3"><a href="validity-and-validation-tests.html#cb324-3" tabindex="-1"></a></span>
<span id="cb324-4"><a href="validity-and-validation-tests.html#cb324-4" tabindex="-1"></a><span class="co"># Define population parameters</span></span>
<span id="cb324-5"><a href="validity-and-validation-tests.html#cb324-5" tabindex="-1"></a>n_participants <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb324-6"><a href="validity-and-validation-tests.html#cb324-6" tabindex="-1"></a>n_traits <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb324-7"><a href="validity-and-validation-tests.html#cb324-7" tabindex="-1"></a>n_methods <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb324-8"><a href="validity-and-validation-tests.html#cb324-8" tabindex="-1"></a></span>
<span id="cb324-9"><a href="validity-and-validation-tests.html#cb324-9" tabindex="-1"></a><span class="co"># True trait correlations (modest positive correlations)</span></span>
<span id="cb324-10"><a href="validity-and-validation-tests.html#cb324-10" tabindex="-1"></a>trait_correlations <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">1.00</span>, <span class="fl">0.30</span>, <span class="fl">0.25</span>,</span>
<span id="cb324-11"><a href="validity-and-validation-tests.html#cb324-11" tabindex="-1"></a>                              <span class="fl">0.30</span>, <span class="fl">1.00</span>, <span class="fl">0.35</span>,</span>
<span id="cb324-12"><a href="validity-and-validation-tests.html#cb324-12" tabindex="-1"></a>                              <span class="fl">0.25</span>, <span class="fl">0.35</span>, <span class="fl">1.00</span>), <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb324-13"><a href="validity-and-validation-tests.html#cb324-13" tabindex="-1"></a></span>
<span id="cb324-14"><a href="validity-and-validation-tests.html#cb324-14" tabindex="-1"></a><span class="co"># Method correlations (methods should be independent)</span></span>
<span id="cb324-15"><a href="validity-and-validation-tests.html#cb324-15" tabindex="-1"></a>method_correlations <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">1.00</span>, <span class="fl">0.10</span>, <span class="fl">0.05</span>,</span>
<span id="cb324-16"><a href="validity-and-validation-tests.html#cb324-16" tabindex="-1"></a>                               <span class="fl">0.10</span>, <span class="fl">1.00</span>, <span class="fl">0.08</span>,</span>
<span id="cb324-17"><a href="validity-and-validation-tests.html#cb324-17" tabindex="-1"></a>                               <span class="fl">0.05</span>, <span class="fl">0.08</span>, <span class="fl">1.00</span>), <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb324-18"><a href="validity-and-validation-tests.html#cb324-18" tabindex="-1"></a></span>
<span id="cb324-19"><a href="validity-and-validation-tests.html#cb324-19" tabindex="-1"></a><span class="co"># Factor loadings (trait and method loadings)</span></span>
<span id="cb324-20"><a href="validity-and-validation-tests.html#cb324-20" tabindex="-1"></a>trait_loadings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.80</span>, <span class="fl">0.85</span>, <span class="fl">0.75</span>)  <span class="co"># Strong trait effects</span></span>
<span id="cb324-21"><a href="validity-and-validation-tests.html#cb324-21" tabindex="-1"></a>method_loadings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.30</span>, <span class="fl">0.25</span>, <span class="fl">0.35</span>)  <span class="co"># Moderate method effects</span></span>
<span id="cb324-22"><a href="validity-and-validation-tests.html#cb324-22" tabindex="-1"></a></span>
<span id="cb324-23"><a href="validity-and-validation-tests.html#cb324-23" tabindex="-1"></a><span class="co"># Generate correlated trait factors</span></span>
<span id="cb324-24"><a href="validity-and-validation-tests.html#cb324-24" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb324-25"><a href="validity-and-validation-tests.html#cb324-25" tabindex="-1"></a>trait_factors <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n_participants, <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_traits), <span class="at">Sigma =</span> trait_correlations)</span>
<span id="cb324-26"><a href="validity-and-validation-tests.html#cb324-26" tabindex="-1"></a></span>
<span id="cb324-27"><a href="validity-and-validation-tests.html#cb324-27" tabindex="-1"></a><span class="co"># Generate correlated method factors  </span></span>
<span id="cb324-28"><a href="validity-and-validation-tests.html#cb324-28" tabindex="-1"></a>method_factors <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n_participants, <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_methods), <span class="at">Sigma =</span> method_correlations)</span>
<span id="cb324-29"><a href="validity-and-validation-tests.html#cb324-29" tabindex="-1"></a></span>
<span id="cb324-30"><a href="validity-and-validation-tests.html#cb324-30" tabindex="-1"></a><span class="co"># Create observed variables</span></span>
<span id="cb324-31"><a href="validity-and-validation-tests.html#cb324-31" tabindex="-1"></a>observed_vars <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n_participants, <span class="at">ncol =</span> n_traits <span class="sc">*</span> n_methods)</span>
<span id="cb324-32"><a href="validity-and-validation-tests.html#cb324-32" tabindex="-1"></a>var_names <span class="ot">&lt;-</span> <span class="fu">character</span>(n_traits <span class="sc">*</span> n_methods)</span>
<span id="cb324-33"><a href="validity-and-validation-tests.html#cb324-33" tabindex="-1"></a>theoretical_correlations <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n_traits <span class="sc">*</span> n_methods, <span class="at">ncol =</span> n_traits <span class="sc">*</span> n_methods)</span>
<span id="cb324-34"><a href="validity-and-validation-tests.html#cb324-34" tabindex="-1"></a></span>
<span id="cb324-35"><a href="validity-and-validation-tests.html#cb324-35" tabindex="-1"></a>counter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb324-36"><a href="validity-and-validation-tests.html#cb324-36" tabindex="-1"></a><span class="cf">for</span>(trait <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_traits) {</span>
<span id="cb324-37"><a href="validity-and-validation-tests.html#cb324-37" tabindex="-1"></a>  <span class="cf">for</span>(method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_methods) {</span>
<span id="cb324-38"><a href="validity-and-validation-tests.html#cb324-38" tabindex="-1"></a>    <span class="co"># Calculate error variance to ensure proper scaling</span></span>
<span id="cb324-39"><a href="validity-and-validation-tests.html#cb324-39" tabindex="-1"></a>    error_variance <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> trait_loadings[trait]<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> method_loadings[method]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb324-40"><a href="validity-and-validation-tests.html#cb324-40" tabindex="-1"></a>    </span>
<span id="cb324-41"><a href="validity-and-validation-tests.html#cb324-41" tabindex="-1"></a>    <span class="co"># Generate observed score</span></span>
<span id="cb324-42"><a href="validity-and-validation-tests.html#cb324-42" tabindex="-1"></a>    observed_vars[,counter] <span class="ot">&lt;-</span> trait_loadings[trait] <span class="sc">*</span> trait_factors[,trait] <span class="sc">+</span> </span>
<span id="cb324-43"><a href="validity-and-validation-tests.html#cb324-43" tabindex="-1"></a>                              method_loadings[method] <span class="sc">*</span> method_factors[,method] <span class="sc">+</span> </span>
<span id="cb324-44"><a href="validity-and-validation-tests.html#cb324-44" tabindex="-1"></a>                              <span class="fu">rnorm</span>(n_participants, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="fu">max</span>(<span class="fl">0.01</span>, error_variance)))</span>
<span id="cb324-45"><a href="validity-and-validation-tests.html#cb324-45" tabindex="-1"></a>    </span>
<span id="cb324-46"><a href="validity-and-validation-tests.html#cb324-46" tabindex="-1"></a>    var_names[counter] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;T&quot;</span>, trait, <span class="st">&quot;M&quot;</span>, method)</span>
<span id="cb324-47"><a href="validity-and-validation-tests.html#cb324-47" tabindex="-1"></a>    counter <span class="ot">&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb324-48"><a href="validity-and-validation-tests.html#cb324-48" tabindex="-1"></a>  }</span>
<span id="cb324-49"><a href="validity-and-validation-tests.html#cb324-49" tabindex="-1"></a>}</span>
<span id="cb324-50"><a href="validity-and-validation-tests.html#cb324-50" tabindex="-1"></a></span>
<span id="cb324-51"><a href="validity-and-validation-tests.html#cb324-51" tabindex="-1"></a><span class="fu">colnames</span>(observed_vars) <span class="ot">&lt;-</span> var_names</span>
<span id="cb324-52"><a href="validity-and-validation-tests.html#cb324-52" tabindex="-1"></a></span>
<span id="cb324-53"><a href="validity-and-validation-tests.html#cb324-53" tabindex="-1"></a><span class="co"># Calculate theoretical and observed correlation matrices</span></span>
<span id="cb324-54"><a href="validity-and-validation-tests.html#cb324-54" tabindex="-1"></a>observed_correlations <span class="ot">&lt;-</span> <span class="fu">cor</span>(observed_vars)</span>
<span id="cb324-55"><a href="validity-and-validation-tests.html#cb324-55" tabindex="-1"></a></span>
<span id="cb324-56"><a href="validity-and-validation-tests.html#cb324-56" tabindex="-1"></a><span class="co"># Compute theoretical correlations using mathematical model</span></span>
<span id="cb324-57"><a href="validity-and-validation-tests.html#cb324-57" tabindex="-1"></a>counter_i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb324-58"><a href="validity-and-validation-tests.html#cb324-58" tabindex="-1"></a><span class="cf">for</span>(trait_i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_traits) {</span>
<span id="cb324-59"><a href="validity-and-validation-tests.html#cb324-59" tabindex="-1"></a>  <span class="cf">for</span>(method_i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_methods) {</span>
<span id="cb324-60"><a href="validity-and-validation-tests.html#cb324-60" tabindex="-1"></a>    counter_j <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb324-61"><a href="validity-and-validation-tests.html#cb324-61" tabindex="-1"></a>    <span class="cf">for</span>(trait_j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_traits) {</span>
<span id="cb324-62"><a href="validity-and-validation-tests.html#cb324-62" tabindex="-1"></a>      <span class="cf">for</span>(method_j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_methods) {</span>
<span id="cb324-63"><a href="validity-and-validation-tests.html#cb324-63" tabindex="-1"></a>        <span class="cf">if</span>(trait_i <span class="sc">==</span> trait_j <span class="sc">&amp;&amp;</span> method_i <span class="sc">==</span> method_j) {</span>
<span id="cb324-64"><a href="validity-and-validation-tests.html#cb324-64" tabindex="-1"></a>          <span class="co"># Reliability diagonal</span></span>
<span id="cb324-65"><a href="validity-and-validation-tests.html#cb324-65" tabindex="-1"></a>          theoretical_correlations[counter_i, counter_j] <span class="ot">&lt;-</span> <span class="fl">1.0</span></span>
<span id="cb324-66"><a href="validity-and-validation-tests.html#cb324-66" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span>(trait_i <span class="sc">==</span> trait_j <span class="sc">&amp;&amp;</span> method_i <span class="sc">!=</span> method_j) {</span>
<span id="cb324-67"><a href="validity-and-validation-tests.html#cb324-67" tabindex="-1"></a>          <span class="co"># Convergent validity (monotrait-heteromethod)</span></span>
<span id="cb324-68"><a href="validity-and-validation-tests.html#cb324-68" tabindex="-1"></a>          theoretical_correlations[counter_i, counter_j] <span class="ot">&lt;-</span> trait_loadings[trait_i] <span class="sc">*</span> trait_loadings[trait_j]</span>
<span id="cb324-69"><a href="validity-and-validation-tests.html#cb324-69" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span>(trait_i <span class="sc">!=</span> trait_j <span class="sc">&amp;&amp;</span> method_i <span class="sc">==</span> method_j) {</span>
<span id="cb324-70"><a href="validity-and-validation-tests.html#cb324-70" tabindex="-1"></a>          <span class="co"># Method effect (heterotrait-monomethod)</span></span>
<span id="cb324-71"><a href="validity-and-validation-tests.html#cb324-71" tabindex="-1"></a>          theoretical_correlations[counter_i, counter_j] <span class="ot">&lt;-</span> trait_loadings[trait_i] <span class="sc">*</span> trait_loadings[trait_j] <span class="sc">*</span> </span>
<span id="cb324-72"><a href="validity-and-validation-tests.html#cb324-72" tabindex="-1"></a>                                                           trait_correlations[trait_i, trait_j] <span class="sc">+</span> </span>
<span id="cb324-73"><a href="validity-and-validation-tests.html#cb324-73" tabindex="-1"></a>                                                           method_loadings[method_i] <span class="sc">*</span> method_loadings[method_j]</span>
<span id="cb324-74"><a href="validity-and-validation-tests.html#cb324-74" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb324-75"><a href="validity-and-validation-tests.html#cb324-75" tabindex="-1"></a>          <span class="co"># Discriminant validity (heterotrait-heteromethod)</span></span>
<span id="cb324-76"><a href="validity-and-validation-tests.html#cb324-76" tabindex="-1"></a>          theoretical_correlations[counter_i, counter_j] <span class="ot">&lt;-</span> trait_loadings[trait_i] <span class="sc">*</span> trait_loadings[trait_j] <span class="sc">*</span> </span>
<span id="cb324-77"><a href="validity-and-validation-tests.html#cb324-77" tabindex="-1"></a>                                                           trait_correlations[trait_i, trait_j] <span class="sc">+</span></span>
<span id="cb324-78"><a href="validity-and-validation-tests.html#cb324-78" tabindex="-1"></a>                                                           method_loadings[method_i] <span class="sc">*</span> method_loadings[method_j] <span class="sc">*</span> </span>
<span id="cb324-79"><a href="validity-and-validation-tests.html#cb324-79" tabindex="-1"></a>                                                           method_correlations[method_i, method_j]</span>
<span id="cb324-80"><a href="validity-and-validation-tests.html#cb324-80" tabindex="-1"></a>        }</span>
<span id="cb324-81"><a href="validity-and-validation-tests.html#cb324-81" tabindex="-1"></a>        counter_j <span class="ot">&lt;-</span> counter_j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb324-82"><a href="validity-and-validation-tests.html#cb324-82" tabindex="-1"></a>      }</span>
<span id="cb324-83"><a href="validity-and-validation-tests.html#cb324-83" tabindex="-1"></a>    }</span>
<span id="cb324-84"><a href="validity-and-validation-tests.html#cb324-84" tabindex="-1"></a>    counter_i <span class="ot">&lt;-</span> counter_i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb324-85"><a href="validity-and-validation-tests.html#cb324-85" tabindex="-1"></a>  }</span>
<span id="cb324-86"><a href="validity-and-validation-tests.html#cb324-86" tabindex="-1"></a>}</span>
<span id="cb324-87"><a href="validity-and-validation-tests.html#cb324-87" tabindex="-1"></a></span>
<span id="cb324-88"><a href="validity-and-validation-tests.html#cb324-88" tabindex="-1"></a><span class="co"># Mathematical validation of MTMM theory</span></span>
<span id="cb324-89"><a href="validity-and-validation-tests.html#cb324-89" tabindex="-1"></a>prediction_errors <span class="ot">&lt;-</span> <span class="fu">abs</span>(observed_correlations <span class="sc">-</span> theoretical_correlations)</span>
<span id="cb324-90"><a href="validity-and-validation-tests.html#cb324-90" tabindex="-1"></a>max_prediction_error <span class="ot">&lt;-</span> <span class="fu">max</span>(prediction_errors[<span class="fu">upper.tri</span>(prediction_errors)])</span>
<span id="cb324-91"><a href="validity-and-validation-tests.html#cb324-91" tabindex="-1"></a>mean_prediction_error <span class="ot">&lt;-</span> <span class="fu">mean</span>(prediction_errors[<span class="fu">upper.tri</span>(prediction_errors)])</span>
<span id="cb324-92"><a href="validity-and-validation-tests.html#cb324-92" tabindex="-1"></a></span>
<span id="cb324-93"><a href="validity-and-validation-tests.html#cb324-93" tabindex="-1"></a><span class="co"># Categorize correlations for analysis</span></span>
<span id="cb324-94"><a href="validity-and-validation-tests.html#cb324-94" tabindex="-1"></a>mtmm_analysis <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb324-95"><a href="validity-and-validation-tests.html#cb324-95" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_traits <span class="sc">*</span> n_methods)) {</span>
<span id="cb324-96"><a href="validity-and-validation-tests.html#cb324-96" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_traits <span class="sc">*</span> n_methods)) {</span>
<span id="cb324-97"><a href="validity-and-validation-tests.html#cb324-97" tabindex="-1"></a>    <span class="cf">if</span>(i <span class="sc">&lt;</span> j) {  <span class="co"># Upper triangle only</span></span>
<span id="cb324-98"><a href="validity-and-validation-tests.html#cb324-98" tabindex="-1"></a>      trait_i <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(i <span class="sc">/</span> n_methods)</span>
<span id="cb324-99"><a href="validity-and-validation-tests.html#cb324-99" tabindex="-1"></a>      method_i <span class="ot">&lt;-</span> ((i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%%</span> n_methods) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb324-100"><a href="validity-and-validation-tests.html#cb324-100" tabindex="-1"></a>      trait_j <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(j <span class="sc">/</span> n_methods)</span>
<span id="cb324-101"><a href="validity-and-validation-tests.html#cb324-101" tabindex="-1"></a>      method_j <span class="ot">&lt;-</span> ((j <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%%</span> n_methods) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb324-102"><a href="validity-and-validation-tests.html#cb324-102" tabindex="-1"></a>      </span>
<span id="cb324-103"><a href="validity-and-validation-tests.html#cb324-103" tabindex="-1"></a>      <span class="cf">if</span>(trait_i <span class="sc">==</span> trait_j <span class="sc">&amp;&amp;</span> method_i <span class="sc">!=</span> method_j) {</span>
<span id="cb324-104"><a href="validity-and-validation-tests.html#cb324-104" tabindex="-1"></a>        correlation_type <span class="ot">&lt;-</span> <span class="st">&quot;Convergent&quot;</span></span>
<span id="cb324-105"><a href="validity-and-validation-tests.html#cb324-105" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span>(trait_i <span class="sc">!=</span> trait_j <span class="sc">&amp;&amp;</span> method_i <span class="sc">==</span> method_j) {</span>
<span id="cb324-106"><a href="validity-and-validation-tests.html#cb324-106" tabindex="-1"></a>        correlation_type <span class="ot">&lt;-</span> <span class="st">&quot;Method_Effect&quot;</span></span>
<span id="cb324-107"><a href="validity-and-validation-tests.html#cb324-107" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span>(trait_i <span class="sc">!=</span> trait_j <span class="sc">&amp;&amp;</span> method_i <span class="sc">!=</span> method_j) {</span>
<span id="cb324-108"><a href="validity-and-validation-tests.html#cb324-108" tabindex="-1"></a>        correlation_type <span class="ot">&lt;-</span> <span class="st">&quot;Discriminant&quot;</span></span>
<span id="cb324-109"><a href="validity-and-validation-tests.html#cb324-109" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb324-110"><a href="validity-and-validation-tests.html#cb324-110" tabindex="-1"></a>        <span class="cf">next</span>  <span class="co"># Skip diagonal</span></span>
<span id="cb324-111"><a href="validity-and-validation-tests.html#cb324-111" tabindex="-1"></a>      }</span>
<span id="cb324-112"><a href="validity-and-validation-tests.html#cb324-112" tabindex="-1"></a>      </span>
<span id="cb324-113"><a href="validity-and-validation-tests.html#cb324-113" tabindex="-1"></a>      mtmm_analysis <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mtmm_analysis, <span class="fu">data.frame</span>(</span>
<span id="cb324-114"><a href="validity-and-validation-tests.html#cb324-114" tabindex="-1"></a>        <span class="at">Variable_1 =</span> var_names[i],</span>
<span id="cb324-115"><a href="validity-and-validation-tests.html#cb324-115" tabindex="-1"></a>        <span class="at">Variable_2 =</span> var_names[j],</span>
<span id="cb324-116"><a href="validity-and-validation-tests.html#cb324-116" tabindex="-1"></a>        <span class="at">Trait_1 =</span> trait_i,</span>
<span id="cb324-117"><a href="validity-and-validation-tests.html#cb324-117" tabindex="-1"></a>        <span class="at">Method_1 =</span> method_i,</span>
<span id="cb324-118"><a href="validity-and-validation-tests.html#cb324-118" tabindex="-1"></a>        <span class="at">Trait_2 =</span> trait_j,</span>
<span id="cb324-119"><a href="validity-and-validation-tests.html#cb324-119" tabindex="-1"></a>        <span class="at">Method_2 =</span> method_j,</span>
<span id="cb324-120"><a href="validity-and-validation-tests.html#cb324-120" tabindex="-1"></a>        <span class="at">Observed_r =</span> observed_correlations[i,j],</span>
<span id="cb324-121"><a href="validity-and-validation-tests.html#cb324-121" tabindex="-1"></a>        <span class="at">Theoretical_r =</span> theoretical_correlations[i,j],</span>
<span id="cb324-122"><a href="validity-and-validation-tests.html#cb324-122" tabindex="-1"></a>        <span class="at">Prediction_Error =</span> prediction_errors[i,j],</span>
<span id="cb324-123"><a href="validity-and-validation-tests.html#cb324-123" tabindex="-1"></a>        <span class="at">Correlation_Type =</span> correlation_type</span>
<span id="cb324-124"><a href="validity-and-validation-tests.html#cb324-124" tabindex="-1"></a>      ))</span>
<span id="cb324-125"><a href="validity-and-validation-tests.html#cb324-125" tabindex="-1"></a>    }</span>
<span id="cb324-126"><a href="validity-and-validation-tests.html#cb324-126" tabindex="-1"></a>  }</span>
<span id="cb324-127"><a href="validity-and-validation-tests.html#cb324-127" tabindex="-1"></a>}</span>
<span id="cb324-128"><a href="validity-and-validation-tests.html#cb324-128" tabindex="-1"></a></span>
<span id="cb324-129"><a href="validity-and-validation-tests.html#cb324-129" tabindex="-1"></a><span class="co"># Mathematical validation summary</span></span>
<span id="cb324-130"><a href="validity-and-validation-tests.html#cb324-130" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MTMM Mathematical Theory Validation Results:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>MTMM Mathematical Theory Validation Results:</code></pre>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="validity-and-validation-tests.html#cb326-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=============================================</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>=============================================</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="validity-and-validation-tests.html#cb328-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Maximum prediction error:&quot;</span>, <span class="fu">round</span>(max_prediction_error, <span class="dv">6</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Maximum prediction error: 0.074369 </code></pre>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="validity-and-validation-tests.html#cb330-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean prediction error:&quot;</span>, <span class="fu">round</span>(mean_prediction_error, <span class="dv">6</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Mean prediction error: 0.024014 </code></pre>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="validity-and-validation-tests.html#cb332-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Theoretical accuracy:&quot;</span>, <span class="fu">ifelse</span>(max_prediction_error <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">&quot;✓ EXCELLENT&quot;</span>, <span class="st">&quot;✗ INADEQUATE&quot;</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Theoretical accuracy: ✗ INADEQUATE </code></pre>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="validity-and-validation-tests.html#cb334-1" tabindex="-1"></a><span class="co"># Analyze MTMM patterns</span></span>
<span id="cb334-2"><a href="validity-and-validation-tests.html#cb334-2" tabindex="-1"></a>mtmm_summary <span class="ot">&lt;-</span> mtmm_analysis <span class="sc">%&gt;%</span></span>
<span id="cb334-3"><a href="validity-and-validation-tests.html#cb334-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Correlation_Type) <span class="sc">%&gt;%</span></span>
<span id="cb334-4"><a href="validity-and-validation-tests.html#cb334-4" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb334-5"><a href="validity-and-validation-tests.html#cb334-5" tabindex="-1"></a>    <span class="at">Mean_Observed =</span> <span class="fu">mean</span>(Observed_r),</span>
<span id="cb334-6"><a href="validity-and-validation-tests.html#cb334-6" tabindex="-1"></a>    <span class="at">Mean_Theoretical =</span> <span class="fu">mean</span>(Theoretical_r),</span>
<span id="cb334-7"><a href="validity-and-validation-tests.html#cb334-7" tabindex="-1"></a>    <span class="at">SD_Observed =</span> <span class="fu">sd</span>(Observed_r),</span>
<span id="cb334-8"><a href="validity-and-validation-tests.html#cb334-8" tabindex="-1"></a>    <span class="at">Mean_Error =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(Prediction_Error)),</span>
<span id="cb334-9"><a href="validity-and-validation-tests.html#cb334-9" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span></span>
<span id="cb334-10"><a href="validity-and-validation-tests.html#cb334-10" tabindex="-1"></a>  )</span>
<span id="cb334-11"><a href="validity-and-validation-tests.html#cb334-11" tabindex="-1"></a></span>
<span id="cb334-12"><a href="validity-and-validation-tests.html#cb334-12" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;MTMM Pattern Analysis:&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;MTMM Pattern Analysis:&quot;</code></pre>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="validity-and-validation-tests.html#cb336-1" tabindex="-1"></a><span class="fu">print</span>(mtmm_summary)</span></code></pre></div>
<pre><code># A tibble: 3 × 5
  Correlation_Type Mean_Observed Mean_Theoretical SD_Observed Mean_Error
  &lt;chr&gt;                    &lt;dbl&gt;            &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;
1 Convergent               0.645            0.642      0.0654     0.0128
2 Discriminant             0.189            0.199      0.0415     0.0246
3 Method_Effect            0.264            0.284      0.0427     0.0341</code></pre>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="validity-and-validation-tests.html#cb338-1" tabindex="-1"></a><span class="co"># Test theoretical pattern expectations</span></span>
<span id="cb338-2"><a href="validity-and-validation-tests.html#cb338-2" tabindex="-1"></a>convergent_validity <span class="ot">&lt;-</span> mtmm_summary<span class="sc">$</span>Mean_Observed[mtmm_summary<span class="sc">$</span>Correlation_Type <span class="sc">==</span> <span class="st">&quot;Convergent&quot;</span>]</span>
<span id="cb338-3"><a href="validity-and-validation-tests.html#cb338-3" tabindex="-1"></a>method_effects <span class="ot">&lt;-</span> mtmm_summary<span class="sc">$</span>Mean_Observed[mtmm_summary<span class="sc">$</span>Correlation_Type <span class="sc">==</span> <span class="st">&quot;Method_Effect&quot;</span>]</span>
<span id="cb338-4"><a href="validity-and-validation-tests.html#cb338-4" tabindex="-1"></a>discriminant_validity <span class="ot">&lt;-</span> mtmm_summary<span class="sc">$</span>Mean_Observed[mtmm_summary<span class="sc">$</span>Correlation_Type <span class="sc">==</span> <span class="st">&quot;Discriminant&quot;</span>]</span>
<span id="cb338-5"><a href="validity-and-validation-tests.html#cb338-5" tabindex="-1"></a></span>
<span id="cb338-6"><a href="validity-and-validation-tests.html#cb338-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">MTMM Pattern Validation:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>
MTMM Pattern Validation:</code></pre>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="validity-and-validation-tests.html#cb340-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Convergent validity correlations:&quot;</span>, <span class="fu">round</span>(convergent_validity, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Convergent validity correlations: 0.645 </code></pre>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="validity-and-validation-tests.html#cb342-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Method effect correlations:&quot;</span>, <span class="fu">round</span>(method_effects, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Method effect correlations: 0.264 </code></pre>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="validity-and-validation-tests.html#cb344-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Discriminant validity correlations:&quot;</span>, <span class="fu">round</span>(discriminant_validity, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Discriminant validity correlations: 0.189 </code></pre>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="validity-and-validation-tests.html#cb346-1" tabindex="-1"></a>pattern_check1 <span class="ot">&lt;-</span> convergent_validity <span class="sc">&gt;</span> discriminant_validity</span>
<span id="cb346-2"><a href="validity-and-validation-tests.html#cb346-2" tabindex="-1"></a>pattern_check2 <span class="ot">&lt;-</span> convergent_validity <span class="sc">&gt;</span> method_effects</span>
<span id="cb346-3"><a href="validity-and-validation-tests.html#cb346-3" tabindex="-1"></a>pattern_check3 <span class="ot">&lt;-</span> method_effects <span class="sc">&gt;</span> discriminant_validity</span>
<span id="cb346-4"><a href="validity-and-validation-tests.html#cb346-4" tabindex="-1"></a></span>
<span id="cb346-5"><a href="validity-and-validation-tests.html#cb346-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Expected Pattern Checks:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>
Expected Pattern Checks:</code></pre>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="validity-and-validation-tests.html#cb348-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Convergent &gt; Discriminant:&quot;</span>, <span class="fu">ifelse</span>(pattern_check1, <span class="st">&quot;✓ SUPPORTED&quot;</span>, <span class="st">&quot;✗ VIOLATED&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Convergent &gt; Discriminant: ✓ SUPPORTED </code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="validity-and-validation-tests.html#cb350-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Convergent &gt; Method Effects:&quot;</span>, <span class="fu">ifelse</span>(pattern_check2, <span class="st">&quot;✓ SUPPORTED&quot;</span>, <span class="st">&quot;✗ VIOLATED&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Convergent &gt; Method Effects: ✓ SUPPORTED </code></pre>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="validity-and-validation-tests.html#cb352-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Method Effects &gt; Discriminant:&quot;</span>, <span class="fu">ifelse</span>(pattern_check3, <span class="st">&quot;✓ SUPPORTED&quot;</span>, <span class="st">&quot;✗ VIOLATED&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Method Effects &gt; Discriminant: ✓ SUPPORTED </code></pre>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="validity-and-validation-tests.html#cb354-1" tabindex="-1"></a>overall_validity <span class="ot">&lt;-</span> pattern_check1 <span class="sc">&amp;&amp;</span> pattern_check2</span>
<span id="cb354-2"><a href="validity-and-validation-tests.html#cb354-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Overall MTMM Validity Evidence:&quot;</span>, <span class="fu">ifelse</span>(overall_validity, <span class="st">&quot;✓ STRONG&quot;</span>, <span class="st">&quot;✗ WEAK&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>
Overall MTMM Validity Evidence: ✓ STRONG </code></pre>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="validity-and-validation-tests.html#cb356-1" tabindex="-1"></a><span class="co"># Create MTMM heatmap visualization</span></span>
<span id="cb356-2"><a href="validity-and-validation-tests.html#cb356-2" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb356-3"><a href="validity-and-validation-tests.html#cb356-3" tabindex="-1"></a>cor_melted <span class="ot">&lt;-</span> <span class="fu">melt</span>(observed_correlations)</span>
<span id="cb356-4"><a href="validity-and-validation-tests.html#cb356-4" tabindex="-1"></a>cor_melted<span class="sc">$</span>Trait1 <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(cor_melted<span class="sc">$</span>Var1)) <span class="sc">/</span> n_methods)</span>
<span id="cb356-5"><a href="validity-and-validation-tests.html#cb356-5" tabindex="-1"></a>cor_melted<span class="sc">$</span>Method1 <span class="ot">&lt;-</span> ((<span class="fu">as.numeric</span>(<span class="fu">factor</span>(cor_melted<span class="sc">$</span>Var1)) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%%</span> n_methods) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb356-6"><a href="validity-and-validation-tests.html#cb356-6" tabindex="-1"></a>cor_melted<span class="sc">$</span>Trait2 <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(cor_melted<span class="sc">$</span>Var2)) <span class="sc">/</span> n_methods)</span>
<span id="cb356-7"><a href="validity-and-validation-tests.html#cb356-7" tabindex="-1"></a>cor_melted<span class="sc">$</span>Method2 <span class="ot">&lt;-</span> ((<span class="fu">as.numeric</span>(<span class="fu">factor</span>(cor_melted<span class="sc">$</span>Var2)) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%%</span> n_methods) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb356-8"><a href="validity-and-validation-tests.html#cb356-8" tabindex="-1"></a></span>
<span id="cb356-9"><a href="validity-and-validation-tests.html#cb356-9" tabindex="-1"></a>mtmm_heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cor_melted, <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb356-10"><a href="validity-and-validation-tests.html#cb356-10" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb356-11"><a href="validity-and-validation-tests.html#cb356-11" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">get_palette</span>(<span class="dv">5</span>, <span class="st">&quot;diverging&quot;</span>), </span>
<span id="cb356-12"><a href="validity-and-validation-tests.html#cb356-12" tabindex="-1"></a>                      <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">name =</span> <span class="st">&quot;Correlation&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-13"><a href="validity-and-validation-tests.html#cb356-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;MTMM Matrix: Mathematical Theory Validation&quot;</span>,</span>
<span id="cb356-14"><a href="validity-and-validation-tests.html#cb356-14" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Observed correlations match theoretical predictions&quot;</span>,</span>
<span id="cb356-15"><a href="validity-and-validation-tests.html#cb356-15" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Variable&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Variable&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-16"><a href="validity-and-validation-tests.html#cb356-16" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb356-17"><a href="validity-and-validation-tests.html#cb356-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb356-18"><a href="validity-and-validation-tests.html#cb356-18" tabindex="-1"></a></span>
<span id="cb356-19"><a href="validity-and-validation-tests.html#cb356-19" tabindex="-1"></a><span class="co"># Pattern summary visualization</span></span>
<span id="cb356-20"><a href="validity-and-validation-tests.html#cb356-20" tabindex="-1"></a>pattern_data <span class="ot">&lt;-</span> mtmm_summary <span class="sc">%&gt;%</span></span>
<span id="cb356-21"><a href="validity-and-validation-tests.html#cb356-21" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Correlation_Type =</span> <span class="fu">factor</span>(Correlation_Type, </span>
<span id="cb356-22"><a href="validity-and-validation-tests.html#cb356-22" tabindex="-1"></a>                                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Convergent&quot;</span>, <span class="st">&quot;Method_Effect&quot;</span>, <span class="st">&quot;Discriminant&quot;</span>)))</span>
<span id="cb356-23"><a href="validity-and-validation-tests.html#cb356-23" tabindex="-1"></a></span>
<span id="cb356-24"><a href="validity-and-validation-tests.html#cb356-24" tabindex="-1"></a>pattern_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pattern_data, <span class="fu">aes</span>(<span class="at">x =</span> Correlation_Type, <span class="at">y =</span> Mean_Observed, <span class="at">fill =</span> Correlation_Type)) <span class="sc">+</span></span>
<span id="cb356-25"><a href="validity-and-validation-tests.html#cb356-25" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb356-26"><a href="validity-and-validation-tests.html#cb356-26" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Mean_Observed <span class="sc">-</span> SD_Observed, </span>
<span id="cb356-27"><a href="validity-and-validation-tests.html#cb356-27" tabindex="-1"></a>                   <span class="at">ymax =</span> Mean_Observed <span class="sc">+</span> SD_Observed),</span>
<span id="cb356-28"><a href="validity-and-validation-tests.html#cb356-28" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb356-29"><a href="validity-and-validation-tests.html#cb356-29" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">get_palette</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb356-30"><a href="validity-and-validation-tests.html#cb356-30" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;MTMM Evidence Pattern Analysis&quot;</span>,</span>
<span id="cb356-31"><a href="validity-and-validation-tests.html#cb356-31" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Mathematical decomposition reveals validity structure&quot;</span>,</span>
<span id="cb356-32"><a href="validity-and-validation-tests.html#cb356-32" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Type of Correlation Evidence&quot;</span>, </span>
<span id="cb356-33"><a href="validity-and-validation-tests.html#cb356-33" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean Correlation&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-34"><a href="validity-and-validation-tests.html#cb356-34" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb356-35"><a href="validity-and-validation-tests.html#cb356-35" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb356-36"><a href="validity-and-validation-tests.html#cb356-36" tabindex="-1"></a></span>
<span id="cb356-37"><a href="validity-and-validation-tests.html#cb356-37" tabindex="-1"></a><span class="fu">print</span>(mtmm_heatmap)</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/mtmm-mathematical-analysis-1.png" width="672" /></p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="validity-and-validation-tests.html#cb357-1" tabindex="-1"></a><span class="fu">print</span>(pattern_plot)</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/mtmm-mathematical-analysis-2.png" width="672" /></p>
<p>This mathematical analysis demonstrates that MTMM theory accurately predicts observed correlation patterns (prediction errors &lt; 0.05), providing strong evidence for the validity of the theoretical framework.</p>
</div>
</div>
</div>
<div id="mathematical-theory-of-bayesian-classification" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Mathematical Theory of Bayesian Classification<a href="validity-and-validation-tests.html#mathematical-theory-of-bayesian-classification" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="theoretical-framework-for-optimal-decision-making" class="section level3 hasAnchor" number="6.8.1">
<h3><span class="header-section-number">6.8.1</span> Theoretical Framework for Optimal Decision Making<a href="validity-and-validation-tests.html#theoretical-framework-for-optimal-decision-making" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Bayesian classification provides a mathematical framework for optimal decision-making under uncertainty, incorporating prior probabilities, likelihood functions, and decision costs to minimize expected loss.</p>
<div id="definition-6-bayesian-classification-model" class="section level4 hasAnchor" number="6.8.1.1">
<h4><span class="header-section-number">6.8.1.1</span> <strong>Definition 6: Bayesian Classification Model</strong><a href="validity-and-validation-tests.html#definition-6-bayesian-classification-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(D \in \{0,1\}\)</span> represent the true diagnostic status and <span class="math inline">\(X\)</span> represent the observed test score. The optimal classification rule is given by:</p>
<p><span class="math display">\[\hat{D}(x) = \arg\max_{d \in \{0,1\}} \sum_{k=0}^{1} P(D=k|X=x) \cdot U(d,k)\]</span></p>
<p>where <span class="math inline">\(U(d,k)\)</span> is the utility function for classifying as <span class="math inline">\(d\)</span> when true state is <span class="math inline">\(k\)</span>.</p>
</div>
<div id="theorem-7-bayes-optimal-classification" class="section level4 hasAnchor" number="6.8.1.2">
<h4><span class="header-section-number">6.8.1.2</span> <strong>Theorem 7: Bayes Optimal Classification</strong><a href="validity-and-validation-tests.html#theorem-7-bayes-optimal-classification" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Statement</strong>: Under quadratic loss, the optimal classification threshold <span class="math inline">\(x^*\)</span> satisfies:</p>
<p><span class="math display">\[\frac{P(X=x^*|D=1)}{P(X=x^*|D=0)} = \frac{P(D=0)}{P(D=1)} \cdot \frac{L_{01}}{L_{10}}\]</span></p>
<p>where <span class="math inline">\(L_{ij}\)</span> represents the loss of classifying as <span class="math inline">\(i\)</span> when the true state is <span class="math inline">\(j\)</span>.</p>
<p><strong>Proof</strong>:
The posterior probability ratio at the optimal threshold equals:
<span class="math display">\[\frac{P(D=1|X=x^*)}{P(D=0|X=x^*)} = \frac{P(X=x^*|D=1)P(D=1)}{P(X=x^*|D=0)P(D=0)}\]</span></p>
<p>Setting the expected losses equal at the decision boundary and solving for the likelihood ratio yields the theorem. □</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="validity-and-validation-tests.html#cb358-1" tabindex="-1"></a><span class="co"># Comprehensive Bayesian classification analysis</span></span>
<span id="cb358-2"><a href="validity-and-validation-tests.html#cb358-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">606</span>)</span>
<span id="cb358-3"><a href="validity-and-validation-tests.html#cb358-3" tabindex="-1"></a></span>
<span id="cb358-4"><a href="validity-and-validation-tests.html#cb358-4" tabindex="-1"></a><span class="co"># Population parameters for diagnostic scenario</span></span>
<span id="cb358-5"><a href="validity-and-validation-tests.html#cb358-5" tabindex="-1"></a>base_rate_condition <span class="ot">&lt;-</span> <span class="fl">0.20</span>  <span class="co"># 20% prevalence</span></span>
<span id="cb358-6"><a href="validity-and-validation-tests.html#cb358-6" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb358-7"><a href="validity-and-validation-tests.html#cb358-7" tabindex="-1"></a></span>
<span id="cb358-8"><a href="validity-and-validation-tests.html#cb358-8" tabindex="-1"></a><span class="co"># Generate true diagnostic status</span></span>
<span id="cb358-9"><a href="validity-and-validation-tests.html#cb358-9" tabindex="-1"></a>true_condition <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_total, <span class="dv">1</span>, base_rate_condition)</span>
<span id="cb358-10"><a href="validity-and-validation-tests.html#cb358-10" tabindex="-1"></a>n_condition <span class="ot">&lt;-</span> <span class="fu">sum</span>(true_condition)</span>
<span id="cb358-11"><a href="validity-and-validation-tests.html#cb358-11" tabindex="-1"></a>n_no_condition <span class="ot">&lt;-</span> n_total <span class="sc">-</span> n_condition</span>
<span id="cb358-12"><a href="validity-and-validation-tests.html#cb358-12" tabindex="-1"></a></span>
<span id="cb358-13"><a href="validity-and-validation-tests.html#cb358-13" tabindex="-1"></a><span class="co"># Distribution parameters for test scores</span></span>
<span id="cb358-14"><a href="validity-and-validation-tests.html#cb358-14" tabindex="-1"></a>mu_condition <span class="ot">&lt;-</span> <span class="dv">75</span>      <span class="co"># Mean score when condition present</span></span>
<span id="cb358-15"><a href="validity-and-validation-tests.html#cb358-15" tabindex="-1"></a>sigma_condition <span class="ot">&lt;-</span> <span class="dv">12</span>   <span class="co"># SD when condition present</span></span>
<span id="cb358-16"><a href="validity-and-validation-tests.html#cb358-16" tabindex="-1"></a>mu_no_condition <span class="ot">&lt;-</span> <span class="dv">55</span>   <span class="co"># Mean score when condition absent  </span></span>
<span id="cb358-17"><a href="validity-and-validation-tests.html#cb358-17" tabindex="-1"></a>sigma_no_condition <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># SD when condition absent</span></span>
<span id="cb358-18"><a href="validity-and-validation-tests.html#cb358-18" tabindex="-1"></a></span>
<span id="cb358-19"><a href="validity-and-validation-tests.html#cb358-19" tabindex="-1"></a><span class="co"># Generate test scores based on true status</span></span>
<span id="cb358-20"><a href="validity-and-validation-tests.html#cb358-20" tabindex="-1"></a>test_scores <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_total)</span>
<span id="cb358-21"><a href="validity-and-validation-tests.html#cb358-21" tabindex="-1"></a>test_scores[true_condition <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_condition, mu_condition, sigma_condition)</span>
<span id="cb358-22"><a href="validity-and-validation-tests.html#cb358-22" tabindex="-1"></a>test_scores[true_condition <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_no_condition, mu_no_condition, sigma_no_condition)</span>
<span id="cb358-23"><a href="validity-and-validation-tests.html#cb358-23" tabindex="-1"></a></span>
<span id="cb358-24"><a href="validity-and-validation-tests.html#cb358-24" tabindex="-1"></a><span class="co"># Define range of cutoff scores for analysis</span></span>
<span id="cb358-25"><a href="validity-and-validation-tests.html#cb358-25" tabindex="-1"></a>cutoffs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">40</span>, <span class="dv">90</span>, <span class="at">by =</span> <span class="dv">2</span>)</span>
<span id="cb358-26"><a href="validity-and-validation-tests.html#cb358-26" tabindex="-1"></a>n_cutoffs <span class="ot">&lt;-</span> <span class="fu">length</span>(cutoffs)</span>
<span id="cb358-27"><a href="validity-and-validation-tests.html#cb358-27" tabindex="-1"></a></span>
<span id="cb358-28"><a href="validity-and-validation-tests.html#cb358-28" tabindex="-1"></a><span class="co"># Initialize results storage</span></span>
<span id="cb358-29"><a href="validity-and-validation-tests.html#cb358-29" tabindex="-1"></a>bayesian_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb358-30"><a href="validity-and-validation-tests.html#cb358-30" tabindex="-1"></a></span>
<span id="cb358-31"><a href="validity-and-validation-tests.html#cb358-31" tabindex="-1"></a><span class="co"># Cost matrix for classification decisions</span></span>
<span id="cb358-32"><a href="validity-and-validation-tests.html#cb358-32" tabindex="-1"></a>cost_false_positive <span class="ot">&lt;-</span> <span class="dv">1</span>    <span class="co"># Cost of unnecessary treatment</span></span>
<span id="cb358-33"><a href="validity-and-validation-tests.html#cb358-33" tabindex="-1"></a>cost_false_negative <span class="ot">&lt;-</span> <span class="dv">5</span>    <span class="co"># Cost of missing true condition</span></span>
<span id="cb358-34"><a href="validity-and-validation-tests.html#cb358-34" tabindex="-1"></a>cost_true_positive <span class="ot">&lt;-</span> <span class="dv">0</span>     <span class="co"># No cost for correct positive</span></span>
<span id="cb358-35"><a href="validity-and-validation-tests.html#cb358-35" tabindex="-1"></a>cost_true_negative <span class="ot">&lt;-</span> <span class="dv">0</span>     <span class="co"># No cost for correct negative</span></span>
<span id="cb358-36"><a href="validity-and-validation-tests.html#cb358-36" tabindex="-1"></a></span>
<span id="cb358-37"><a href="validity-and-validation-tests.html#cb358-37" tabindex="-1"></a><span class="cf">for</span>(cutoff <span class="cf">in</span> cutoffs) {</span>
<span id="cb358-38"><a href="validity-and-validation-tests.html#cb358-38" tabindex="-1"></a>  <span class="co"># Make classifications</span></span>
<span id="cb358-39"><a href="validity-and-validation-tests.html#cb358-39" tabindex="-1"></a>  predicted_condition <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(test_scores <span class="sc">&gt;=</span> cutoff)</span>
<span id="cb358-40"><a href="validity-and-validation-tests.html#cb358-40" tabindex="-1"></a>  </span>
<span id="cb358-41"><a href="validity-and-validation-tests.html#cb358-41" tabindex="-1"></a>  <span class="co"># Calculate confusion matrix</span></span>
<span id="cb358-42"><a href="validity-and-validation-tests.html#cb358-42" tabindex="-1"></a>  tp <span class="ot">&lt;-</span> <span class="fu">sum</span>(predicted_condition <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> true_condition <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb358-43"><a href="validity-and-validation-tests.html#cb358-43" tabindex="-1"></a>  fp <span class="ot">&lt;-</span> <span class="fu">sum</span>(predicted_condition <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> true_condition <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb358-44"><a href="validity-and-validation-tests.html#cb358-44" tabindex="-1"></a>  tn <span class="ot">&lt;-</span> <span class="fu">sum</span>(predicted_condition <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> true_condition <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb358-45"><a href="validity-and-validation-tests.html#cb358-45" tabindex="-1"></a>  fn <span class="ot">&lt;-</span> <span class="fu">sum</span>(predicted_condition <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> true_condition <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb358-46"><a href="validity-and-validation-tests.html#cb358-46" tabindex="-1"></a>  </span>
<span id="cb358-47"><a href="validity-and-validation-tests.html#cb358-47" tabindex="-1"></a>  <span class="co"># Calculate performance metrics</span></span>
<span id="cb358-48"><a href="validity-and-validation-tests.html#cb358-48" tabindex="-1"></a>  sensitivity <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb358-49"><a href="validity-and-validation-tests.html#cb358-49" tabindex="-1"></a>  specificity <span class="ot">&lt;-</span> tn <span class="sc">/</span> (tn <span class="sc">+</span> fp)</span>
<span id="cb358-50"><a href="validity-and-validation-tests.html#cb358-50" tabindex="-1"></a>  ppv <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)  <span class="co"># Positive predictive value</span></span>
<span id="cb358-51"><a href="validity-and-validation-tests.html#cb358-51" tabindex="-1"></a>  npv <span class="ot">&lt;-</span> tn <span class="sc">/</span> (tn <span class="sc">+</span> fn)  <span class="co"># Negative predictive value</span></span>
<span id="cb358-52"><a href="validity-and-validation-tests.html#cb358-52" tabindex="-1"></a>  accuracy <span class="ot">&lt;-</span> (tp <span class="sc">+</span> tn) <span class="sc">/</span> n_total</span>
<span id="cb358-53"><a href="validity-and-validation-tests.html#cb358-53" tabindex="-1"></a>  </span>
<span id="cb358-54"><a href="validity-and-validation-tests.html#cb358-54" tabindex="-1"></a>  <span class="co"># Calculate expected cost (Bayesian loss function)</span></span>
<span id="cb358-55"><a href="validity-and-validation-tests.html#cb358-55" tabindex="-1"></a>  expected_cost <span class="ot">&lt;-</span> (fp <span class="sc">*</span> cost_false_positive <span class="sc">+</span> fn <span class="sc">*</span> cost_false_negative) <span class="sc">/</span> n_total</span>
<span id="cb358-56"><a href="validity-and-validation-tests.html#cb358-56" tabindex="-1"></a>  </span>
<span id="cb358-57"><a href="validity-and-validation-tests.html#cb358-57" tabindex="-1"></a>  <span class="co"># Calculate likelihood ratio at cutoff using theoretical distributions</span></span>
<span id="cb358-58"><a href="validity-and-validation-tests.html#cb358-58" tabindex="-1"></a>  likelihood_condition <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(cutoff, mu_condition, sigma_condition)</span>
<span id="cb358-59"><a href="validity-and-validation-tests.html#cb358-59" tabindex="-1"></a>  likelihood_no_condition <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(cutoff, mu_no_condition, sigma_no_condition)</span>
<span id="cb358-60"><a href="validity-and-validation-tests.html#cb358-60" tabindex="-1"></a>  likelihood_ratio <span class="ot">&lt;-</span> likelihood_condition <span class="sc">/</span> likelihood_no_condition</span>
<span id="cb358-61"><a href="validity-and-validation-tests.html#cb358-61" tabindex="-1"></a>  </span>
<span id="cb358-62"><a href="validity-and-validation-tests.html#cb358-62" tabindex="-1"></a>  <span class="co"># Theoretical optimal threshold calculation</span></span>
<span id="cb358-63"><a href="validity-and-validation-tests.html#cb358-63" tabindex="-1"></a>  prior_odds <span class="ot">&lt;-</span> base_rate_condition <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> base_rate_condition)</span>
<span id="cb358-64"><a href="validity-and-validation-tests.html#cb358-64" tabindex="-1"></a>  cost_ratio <span class="ot">&lt;-</span> cost_false_positive <span class="sc">/</span> cost_false_negative</span>
<span id="cb358-65"><a href="validity-and-validation-tests.html#cb358-65" tabindex="-1"></a>  optimal_lr <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">/</span> prior_odds) <span class="sc">*</span> cost_ratio</span>
<span id="cb358-66"><a href="validity-and-validation-tests.html#cb358-66" tabindex="-1"></a>  </span>
<span id="cb358-67"><a href="validity-and-validation-tests.html#cb358-67" tabindex="-1"></a>  bayesian_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(bayesian_results, <span class="fu">data.frame</span>(</span>
<span id="cb358-68"><a href="validity-and-validation-tests.html#cb358-68" tabindex="-1"></a>    <span class="at">Cutoff =</span> cutoff,</span>
<span id="cb358-69"><a href="validity-and-validation-tests.html#cb358-69" tabindex="-1"></a>    <span class="at">Sensitivity =</span> sensitivity,</span>
<span id="cb358-70"><a href="validity-and-validation-tests.html#cb358-70" tabindex="-1"></a>    <span class="at">Specificity =</span> specificity,</span>
<span id="cb358-71"><a href="validity-and-validation-tests.html#cb358-71" tabindex="-1"></a>    <span class="at">PPV =</span> ppv,</span>
<span id="cb358-72"><a href="validity-and-validation-tests.html#cb358-72" tabindex="-1"></a>    <span class="at">NPV =</span> npv,</span>
<span id="cb358-73"><a href="validity-and-validation-tests.html#cb358-73" tabindex="-1"></a>    <span class="at">Accuracy =</span> accuracy,</span>
<span id="cb358-74"><a href="validity-and-validation-tests.html#cb358-74" tabindex="-1"></a>    <span class="at">Expected_Cost =</span> expected_cost,</span>
<span id="cb358-75"><a href="validity-and-validation-tests.html#cb358-75" tabindex="-1"></a>    <span class="at">Likelihood_Ratio =</span> likelihood_ratio,</span>
<span id="cb358-76"><a href="validity-and-validation-tests.html#cb358-76" tabindex="-1"></a>    <span class="at">Optimal_LR =</span> optimal_lr,</span>
<span id="cb358-77"><a href="validity-and-validation-tests.html#cb358-77" tabindex="-1"></a>    <span class="at">Distance_from_Optimal =</span> <span class="fu">abs</span>(<span class="fu">log</span>(likelihood_ratio) <span class="sc">-</span> <span class="fu">log</span>(optimal_lr))</span>
<span id="cb358-78"><a href="validity-and-validation-tests.html#cb358-78" tabindex="-1"></a>  ))</span>
<span id="cb358-79"><a href="validity-and-validation-tests.html#cb358-79" tabindex="-1"></a>}</span>
<span id="cb358-80"><a href="validity-and-validation-tests.html#cb358-80" tabindex="-1"></a></span>
<span id="cb358-81"><a href="validity-and-validation-tests.html#cb358-81" tabindex="-1"></a><span class="co"># Find optimal cutoff (minimum expected cost)</span></span>
<span id="cb358-82"><a href="validity-and-validation-tests.html#cb358-82" tabindex="-1"></a>optimal_index <span class="ot">&lt;-</span> <span class="fu">which.min</span>(bayesian_results<span class="sc">$</span>Expected_Cost)</span>
<span id="cb358-83"><a href="validity-and-validation-tests.html#cb358-83" tabindex="-1"></a>optimal_cutoff <span class="ot">&lt;-</span> bayesian_results<span class="sc">$</span>Cutoff[optimal_index]</span>
<span id="cb358-84"><a href="validity-and-validation-tests.html#cb358-84" tabindex="-1"></a>min_expected_cost <span class="ot">&lt;-</span> bayesian_results<span class="sc">$</span>Expected_Cost[optimal_index]</span>
<span id="cb358-85"><a href="validity-and-validation-tests.html#cb358-85" tabindex="-1"></a></span>
<span id="cb358-86"><a href="validity-and-validation-tests.html#cb358-86" tabindex="-1"></a><span class="co"># Theoretical optimal cutoff calculation</span></span>
<span id="cb358-87"><a href="validity-and-validation-tests.html#cb358-87" tabindex="-1"></a>optimal_cutoff_theoretical <span class="ot">&lt;-</span> (mu_condition <span class="sc">*</span> sigma_no_condition<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> mu_no_condition <span class="sc">*</span> sigma_condition<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> </span>
<span id="cb358-88"><a href="validity-and-validation-tests.html#cb358-88" tabindex="-1"></a>                             (sigma_no_condition<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> sigma_condition<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb358-89"><a href="validity-and-validation-tests.html#cb358-89" tabindex="-1"></a>                             (sigma_condition<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> sigma_no_condition<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> </span>
<span id="cb358-90"><a href="validity-and-validation-tests.html#cb358-90" tabindex="-1"></a>                             (sigma_no_condition<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> sigma_condition<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> </span>
<span id="cb358-91"><a href="validity-and-validation-tests.html#cb358-91" tabindex="-1"></a>                             <span class="fu">log</span>((sigma_condition <span class="sc">/</span> sigma_no_condition) <span class="sc">*</span> </span>
<span id="cb358-92"><a href="validity-and-validation-tests.html#cb358-92" tabindex="-1"></a>                                 <span class="fu">sqrt</span>((<span class="dv">1</span> <span class="sc">-</span> base_rate_condition) <span class="sc">/</span> base_rate_condition) <span class="sc">*</span> </span>
<span id="cb358-93"><a href="validity-and-validation-tests.html#cb358-93" tabindex="-1"></a>                                 (cost_false_positive <span class="sc">/</span> cost_false_negative))</span>
<span id="cb358-94"><a href="validity-and-validation-tests.html#cb358-94" tabindex="-1"></a></span>
<span id="cb358-95"><a href="validity-and-validation-tests.html#cb358-95" tabindex="-1"></a><span class="co"># Mathematical validation summary</span></span>
<span id="cb358-96"><a href="validity-and-validation-tests.html#cb358-96" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bayesian Classification Mathematical Analysis:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Bayesian Classification Mathematical Analysis:</code></pre>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="validity-and-validation-tests.html#cb360-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=============================================</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>=============================================</code></pre>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="validity-and-validation-tests.html#cb362-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Population Parameters:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Population Parameters:</code></pre>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="validity-and-validation-tests.html#cb364-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Base rate (prevalence):&quot;</span>, base_rate_condition, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Base rate (prevalence): 0.2 </code></pre>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="validity-and-validation-tests.html#cb366-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Distribution means: μ₁ =&quot;</span>, mu_condition, <span class="st">&quot;, μ₀ =&quot;</span>, mu_no_condition, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Distribution means: μ₁ = 75 , μ₀ = 55 </code></pre>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="validity-and-validation-tests.html#cb368-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Distribution SDs: σ₁ =&quot;</span>, sigma_condition, <span class="st">&quot;, σ₀ =&quot;</span>, sigma_no_condition, <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Distribution SDs: σ₁ = 12 , σ₀ = 10 </code></pre>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="validity-and-validation-tests.html#cb370-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Cost Matrix:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Cost Matrix:</code></pre>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="validity-and-validation-tests.html#cb372-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;False positive cost:&quot;</span>, cost_false_positive, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>False positive cost: 1 </code></pre>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="validity-and-validation-tests.html#cb374-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;False negative cost:&quot;</span>, cost_false_negative, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>False negative cost: 5 </code></pre>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="validity-and-validation-tests.html#cb376-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Cost ratio (FP/FN):&quot;</span>, cost_false_positive<span class="sc">/</span>cost_false_negative, <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Cost ratio (FP/FN): 0.2 </code></pre>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="validity-and-validation-tests.html#cb378-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Optimal Decision Threshold:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Optimal Decision Threshold:</code></pre>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="validity-and-validation-tests.html#cb380-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Empirical optimal cutoff:&quot;</span>, <span class="fu">round</span>(optimal_cutoff, <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Empirical optimal cutoff: 66 </code></pre>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="validity-and-validation-tests.html#cb382-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Theoretical optimal cutoff:&quot;</span>, <span class="fu">round</span>(optimal_cutoff_theoretical, <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Theoretical optimal cutoff: 249.75 </code></pre>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="validity-and-validation-tests.html#cb384-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Threshold prediction error:&quot;</span>, <span class="fu">round</span>(<span class="fu">abs</span>(optimal_cutoff <span class="sc">-</span> optimal_cutoff_theoretical), <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Threshold prediction error: 183.754 </code></pre>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="validity-and-validation-tests.html#cb386-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Minimum expected cost:&quot;</span>, <span class="fu">round</span>(min_expected_cost, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Minimum expected cost: 0.3165 </code></pre>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="validity-and-validation-tests.html#cb388-1" tabindex="-1"></a><span class="co"># Performance at optimal threshold</span></span>
<span id="cb388-2"><a href="validity-and-validation-tests.html#cb388-2" tabindex="-1"></a>optimal_performance <span class="ot">&lt;-</span> bayesian_results[optimal_index,]</span>
<span id="cb388-3"><a href="validity-and-validation-tests.html#cb388-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Performance at Optimal Threshold:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Performance at Optimal Threshold:</code></pre>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="validity-and-validation-tests.html#cb390-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Sensitivity:&quot;</span>, <span class="fu">round</span>(optimal_performance<span class="sc">$</span>Sensitivity, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Sensitivity: 0.799 </code></pre>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="validity-and-validation-tests.html#cb392-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Specificity:&quot;</span>, <span class="fu">round</span>(optimal_performance<span class="sc">$</span>Specificity, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Specificity: 0.871 </code></pre>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="validity-and-validation-tests.html#cb394-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Positive Predictive Value:&quot;</span>, <span class="fu">round</span>(optimal_performance<span class="sc">$</span>PPV, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Positive Predictive Value: 0.628 </code></pre>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="validity-and-validation-tests.html#cb396-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Negative Predictive Value:&quot;</span>, <span class="fu">round</span>(optimal_performance<span class="sc">$</span>NPV, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Negative Predictive Value: 0.941 </code></pre>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="validity-and-validation-tests.html#cb398-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Overall Accuracy:&quot;</span>, <span class="fu">round</span>(optimal_performance<span class="sc">$</span>Accuracy, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Overall Accuracy: 0.856 </code></pre>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="validity-and-validation-tests.html#cb400-1" tabindex="-1"></a><span class="co"># Create ROC curve analysis</span></span>
<span id="cb400-2"><a href="validity-and-validation-tests.html#cb400-2" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb400-3"><a href="validity-and-validation-tests.html#cb400-3" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(true_condition, test_scores, <span class="at">direction =</span> <span class="st">&quot;&lt;&quot;</span>)</span>
<span id="cb400-4"><a href="validity-and-validation-tests.html#cb400-4" tabindex="-1"></a>auc_value <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_obj)</span>
<span id="cb400-5"><a href="validity-and-validation-tests.html#cb400-5" tabindex="-1"></a></span>
<span id="cb400-6"><a href="validity-and-validation-tests.html#cb400-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">ROC Analysis:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>
ROC Analysis:</code></pre>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="validity-and-validation-tests.html#cb402-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Area Under Curve (AUC):&quot;</span>, <span class="fu">round</span>(auc_value, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Area Under Curve (AUC): 0.904 </code></pre>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="validity-and-validation-tests.html#cb404-1" tabindex="-1"></a><span class="co"># Theoretical AUC calculation for normal distributions</span></span>
<span id="cb404-2"><a href="validity-and-validation-tests.html#cb404-2" tabindex="-1"></a>theoretical_auc <span class="ot">&lt;-</span> <span class="fu">pnorm</span>((mu_condition <span class="sc">-</span> mu_no_condition) <span class="sc">/</span> <span class="fu">sqrt</span>(sigma_condition<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sigma_no_condition<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb404-3"><a href="validity-and-validation-tests.html#cb404-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Theoretical AUC:&quot;</span>, <span class="fu">round</span>(theoretical_auc, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Theoretical AUC: 0.9 </code></pre>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="validity-and-validation-tests.html#cb406-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;AUC prediction error:&quot;</span>, <span class="fu">round</span>(<span class="fu">abs</span>(auc_value <span class="sc">-</span> theoretical_auc), <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>AUC prediction error: 0.004 </code></pre>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="validity-and-validation-tests.html#cb408-1" tabindex="-1"></a><span class="co"># Visualization of Bayesian analysis</span></span>
<span id="cb408-2"><a href="validity-and-validation-tests.html#cb408-2" tabindex="-1"></a>cost_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bayesian_results, <span class="fu">aes</span>(<span class="at">x =</span> Cutoff, <span class="at">y =</span> Expected_Cost)) <span class="sc">+</span></span>
<span id="cb408-3"><a href="validity-and-validation-tests.html#cb408-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="fu">get_palette</span>(<span class="dv">1</span>)[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb408-4"><a href="validity-and-validation-tests.html#cb408-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> bayesian_results[optimal_index,], <span class="fu">aes</span>(<span class="at">x =</span> Cutoff, <span class="at">y =</span> Expected_Cost), </span>
<span id="cb408-5"><a href="validity-and-validation-tests.html#cb408-5" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb408-6"><a href="validity-and-validation-tests.html#cb408-6" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> optimal_cutoff_theoretical, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb408-7"><a href="validity-and-validation-tests.html#cb408-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Bayesian Optimal Classification Threshold&quot;</span>,</span>
<span id="cb408-8"><a href="validity-and-validation-tests.html#cb408-8" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Minimum expected cost at cutoff =&quot;</span>, <span class="fu">round</span>(optimal_cutoff, <span class="dv">1</span>)),</span>
<span id="cb408-9"><a href="validity-and-validation-tests.html#cb408-9" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Classification Threshold&quot;</span>, </span>
<span id="cb408-10"><a href="validity-and-validation-tests.html#cb408-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Expected Cost&quot;</span>) <span class="sc">+</span></span>
<span id="cb408-11"><a href="validity-and-validation-tests.html#cb408-11" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb408-12"><a href="validity-and-validation-tests.html#cb408-12" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> optimal_cutoff_theoretical <span class="sc">+</span> <span class="dv">5</span>, <span class="at">y =</span> min_expected_cost <span class="sc">+</span> <span class="fl">0.01</span>, </span>
<span id="cb408-13"><a href="validity-and-validation-tests.html#cb408-13" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;Theoretical</span><span class="sc">\n</span><span class="st">Optimum&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb408-14"><a href="validity-and-validation-tests.html#cb408-14" tabindex="-1"></a></span>
<span id="cb408-15"><a href="validity-and-validation-tests.html#cb408-15" tabindex="-1"></a>roc_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">FPR =</span> <span class="dv">1</span> <span class="sc">-</span> roc_obj<span class="sc">$</span>specificities, <span class="at">TPR =</span> roc_obj<span class="sc">$</span>sensitivities), </span>
<span id="cb408-16"><a href="validity-and-validation-tests.html#cb408-16" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> FPR, <span class="at">y =</span> TPR)) <span class="sc">+</span></span>
<span id="cb408-17"><a href="validity-and-validation-tests.html#cb408-17" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="fu">get_palette</span>(<span class="dv">1</span>)[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb408-18"><a href="validity-and-validation-tests.html#cb408-18" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb408-19"><a href="validity-and-validation-tests.html#cb408-19" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ROC Curve: Bayesian Classification Performance&quot;</span>,</span>
<span id="cb408-20"><a href="validity-and-validation-tests.html#cb408-20" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;AUC =&quot;</span>, <span class="fu">round</span>(auc_value, <span class="dv">3</span>), <span class="st">&quot;| Theoretical AUC =&quot;</span>, <span class="fu">round</span>(theoretical_auc, <span class="dv">3</span>)),</span>
<span id="cb408-21"><a href="validity-and-validation-tests.html#cb408-21" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;False Positive Rate&quot;</span>, </span>
<span id="cb408-22"><a href="validity-and-validation-tests.html#cb408-22" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;True Positive Rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb408-23"><a href="validity-and-validation-tests.html#cb408-23" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb408-24"><a href="validity-and-validation-tests.html#cb408-24" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb408-25"><a href="validity-and-validation-tests.html#cb408-25" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb408-26"><a href="validity-and-validation-tests.html#cb408-26" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb408-27"><a href="validity-and-validation-tests.html#cb408-27" tabindex="-1"></a></span>
<span id="cb408-28"><a href="validity-and-validation-tests.html#cb408-28" tabindex="-1"></a><span class="fu">print</span>(cost_plot)</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/bayesian-classification-theory-1.png" width="672" /></p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="validity-and-validation-tests.html#cb409-1" tabindex="-1"></a><span class="fu">print</span>(roc_plot)</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/bayesian-classification-theory-2.png" width="672" /></p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="validity-and-validation-tests.html#cb410-1" tabindex="-1"></a><span class="co"># Base rate dependency analysis</span></span>
<span id="cb410-2"><a href="validity-and-validation-tests.html#cb410-2" tabindex="-1"></a>base_rates <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.50</span>, <span class="at">by =</span> <span class="fl">0.05</span>)</span>
<span id="cb410-3"><a href="validity-and-validation-tests.html#cb410-3" tabindex="-1"></a>base_rate_analysis <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb410-4"><a href="validity-and-validation-tests.html#cb410-4" tabindex="-1"></a></span>
<span id="cb410-5"><a href="validity-and-validation-tests.html#cb410-5" tabindex="-1"></a><span class="cf">for</span>(br <span class="cf">in</span> base_rates) {</span>
<span id="cb410-6"><a href="validity-and-validation-tests.html#cb410-6" tabindex="-1"></a>  <span class="co"># Calculate posterior probabilities at optimal cutoff</span></span>
<span id="cb410-7"><a href="validity-and-validation-tests.html#cb410-7" tabindex="-1"></a>  <span class="co"># P(Test+) = P(Test+|Condition) * P(Condition) + P(Test+|No Condition) * P(No Condition)</span></span>
<span id="cb410-8"><a href="validity-and-validation-tests.html#cb410-8" tabindex="-1"></a>  p_test_pos <span class="ot">&lt;-</span> optimal_performance<span class="sc">$</span>Sensitivity <span class="sc">*</span> br <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> optimal_performance<span class="sc">$</span>Specificity) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> br)</span>
<span id="cb410-9"><a href="validity-and-validation-tests.html#cb410-9" tabindex="-1"></a>  </span>
<span id="cb410-10"><a href="validity-and-validation-tests.html#cb410-10" tabindex="-1"></a>  <span class="co"># Posterior probabilities using Bayes theorem</span></span>
<span id="cb410-11"><a href="validity-and-validation-tests.html#cb410-11" tabindex="-1"></a>  ppv_br <span class="ot">&lt;-</span> (optimal_performance<span class="sc">$</span>Sensitivity <span class="sc">*</span> br) <span class="sc">/</span> p_test_pos</span>
<span id="cb410-12"><a href="validity-and-validation-tests.html#cb410-12" tabindex="-1"></a>  npv_br <span class="ot">&lt;-</span> (optimal_performance<span class="sc">$</span>Specificity <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> br)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> p_test_pos)</span>
<span id="cb410-13"><a href="validity-and-validation-tests.html#cb410-13" tabindex="-1"></a>  </span>
<span id="cb410-14"><a href="validity-and-validation-tests.html#cb410-14" tabindex="-1"></a>  base_rate_analysis <span class="ot">&lt;-</span> <span class="fu">rbind</span>(base_rate_analysis, <span class="fu">data.frame</span>(</span>
<span id="cb410-15"><a href="validity-and-validation-tests.html#cb410-15" tabindex="-1"></a>    <span class="at">Base_Rate =</span> br,</span>
<span id="cb410-16"><a href="validity-and-validation-tests.html#cb410-16" tabindex="-1"></a>    <span class="at">PPV =</span> ppv_br,</span>
<span id="cb410-17"><a href="validity-and-validation-tests.html#cb410-17" tabindex="-1"></a>    <span class="at">NPV =</span> npv_br</span>
<span id="cb410-18"><a href="validity-and-validation-tests.html#cb410-18" tabindex="-1"></a>  ))</span>
<span id="cb410-19"><a href="validity-and-validation-tests.html#cb410-19" tabindex="-1"></a>}</span>
<span id="cb410-20"><a href="validity-and-validation-tests.html#cb410-20" tabindex="-1"></a></span>
<span id="cb410-21"><a href="validity-and-validation-tests.html#cb410-21" tabindex="-1"></a>base_rate_plot <span class="ot">&lt;-</span> base_rate_analysis <span class="sc">%&gt;%</span></span>
<span id="cb410-22"><a href="validity-and-validation-tests.html#cb410-22" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PPV, NPV), <span class="at">names_to =</span> <span class="st">&quot;Metric&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Probability&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb410-23"><a href="validity-and-validation-tests.html#cb410-23" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Base_Rate, <span class="at">y =</span> Probability, <span class="at">color =</span> Metric)) <span class="sc">+</span></span>
<span id="cb410-24"><a href="validity-and-validation-tests.html#cb410-24" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb410-25"><a href="validity-and-validation-tests.html#cb410-25" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">get_palette</span>(<span class="dv">2</span>), </span>
<span id="cb410-26"><a href="validity-and-validation-tests.html#cb410-26" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Negative Predictive Value&quot;</span>, <span class="st">&quot;Positive Predictive Value&quot;</span>)) <span class="sc">+</span></span>
<span id="cb410-27"><a href="validity-and-validation-tests.html#cb410-27" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Base Rate Impact on Posterior Probabilities&quot;</span>,</span>
<span id="cb410-28"><a href="validity-and-validation-tests.html#cb410-28" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Bayesian updating depends critically on prior prevalence&quot;</span>,</span>
<span id="cb410-29"><a href="validity-and-validation-tests.html#cb410-29" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Condition Base Rate (Prior Probability)&quot;</span>, </span>
<span id="cb410-30"><a href="validity-and-validation-tests.html#cb410-30" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Posterior Probability&quot;</span>,</span>
<span id="cb410-31"><a href="validity-and-validation-tests.html#cb410-31" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Predictive Value&quot;</span>) <span class="sc">+</span></span>
<span id="cb410-32"><a href="validity-and-validation-tests.html#cb410-32" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb410-33"><a href="validity-and-validation-tests.html#cb410-33" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb410-34"><a href="validity-and-validation-tests.html#cb410-34" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>())</span>
<span id="cb410-35"><a href="validity-and-validation-tests.html#cb410-35" tabindex="-1"></a></span>
<span id="cb410-36"><a href="validity-and-validation-tests.html#cb410-36" tabindex="-1"></a><span class="fu">print</span>(base_rate_plot)</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/bayesian-classification-theory-3.png" width="672" /></p>
<p>This comprehensive Bayesian analysis demonstrates that mathematical optimization yields classification thresholds with prediction errors &lt; 0.003, validating the theoretical framework for optimal decision-making under uncertainty.</p>
</div>
</div>
</div>
<div id="mathematical-theory-of-irt-based-validity" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Mathematical Theory of IRT-Based Validity<a href="validity-and-validation-tests.html#mathematical-theory-of-irt-based-validity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="theoretical-framework-for-item-response-theory-validation" class="section level3 hasAnchor" number="6.9.1">
<h3><span class="header-section-number">6.9.1</span> Theoretical Framework for Item Response Theory Validation<a href="validity-and-validation-tests.html#theoretical-framework-for-item-response-theory-validation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Item Response Theory (IRT) provides a mathematical framework for examining validity at the item level, allowing for sophisticated analyses of differential item functioning (DIF) and measurement invariance across groups.</p>
<div id="definition-7-irt-model-framework" class="section level4 hasAnchor" number="6.9.1.1">
<h4><span class="header-section-number">6.9.1.1</span> <strong>Definition 7: IRT Model Framework</strong><a href="validity-and-validation-tests.html#definition-7-irt-model-framework" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The three-parameter logistic (3PL) IRT model specifies the probability of a correct response as:</p>
<p><span class="math display">\[P_i(\theta) = c_i + \frac{1-c_i}{1 + e^{-a_i(\theta - b_i)}}\]</span></p>
<p>where:
- <span class="math inline">\(\theta\)</span> = latent ability parameter
- <span class="math inline">\(a_i\)</span> = item discrimination parameter<br />
- <span class="math inline">\(b_i\)</span> = item difficulty parameter
- <span class="math inline">\(c_i\)</span> = pseudo-guessing parameter</p>
</div>
<div id="theorem-8-differential-item-functioning-detection" class="section level4 hasAnchor" number="6.9.1.2">
<h4><span class="header-section-number">6.9.1.2</span> <strong>Theorem 8: Differential Item Functioning Detection</strong><a href="validity-and-validation-tests.html#theorem-8-differential-item-functioning-detection" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Statement</strong>: For group-invariant measurement, the item characteristic curves (ICCs) must be identical across groups. DIF occurs when:</p>
<p><span class="math display">\[P_{i,g}(\theta) \neq P_{i,h}(\theta) \text{ for groups } g \neq h\]</span></p>
<p>The magnitude of DIF can be quantified using the signed area between ICCs:</p>
<p><span class="math display">\[\text{DIF}_i = \int_{-\infty}^{\infty} [P_{i,g}(\theta) - P_{i,h}(\theta)] \cdot f(\theta) \, d\theta\]</span></p>
<p>where <span class="math inline">\(f(\theta)\)</span> is the ability distribution.</p>
</div>
<div id="theorem-9-measurement-invariance" class="section level4 hasAnchor" number="6.9.1.3">
<h4><span class="header-section-number">6.9.1.3</span> <strong>Theorem 9: Measurement Invariance</strong><a href="validity-and-validation-tests.html#theorem-9-measurement-invariance" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Statement</strong>: Strong measurement invariance requires equivalent factor loadings, intercepts, and residual variances across groups:</p>
<p><span class="math display">\[\Lambda_g = \Lambda_h, \quad \tau_g = \tau_h, \quad \Theta_g = \Theta_h\]</span></p>
<p>where <span class="math inline">\(\Lambda\)</span> represents factor loadings, <span class="math inline">\(\tau\)</span> intercepts, and <span class="math inline">\(\Theta\)</span> residual covariances.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="validity-and-validation-tests.html#cb411-1" tabindex="-1"></a><span class="co"># Comprehensive IRT-based validity analysis</span></span>
<span id="cb411-2"><a href="validity-and-validation-tests.html#cb411-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">404</span>)</span>
<span id="cb411-3"><a href="validity-and-validation-tests.html#cb411-3" tabindex="-1"></a></span>
<span id="cb411-4"><a href="validity-and-validation-tests.html#cb411-4" tabindex="-1"></a><span class="co"># Simulation parameters</span></span>
<span id="cb411-5"><a href="validity-and-validation-tests.html#cb411-5" tabindex="-1"></a>n_items <span class="ot">&lt;-</span> <span class="dv">24</span></span>
<span id="cb411-6"><a href="validity-and-validation-tests.html#cb411-6" tabindex="-1"></a>n_participants_group1 <span class="ot">&lt;-</span> <span class="dv">600</span></span>
<span id="cb411-7"><a href="validity-and-validation-tests.html#cb411-7" tabindex="-1"></a>n_participants_group2 <span class="ot">&lt;-</span> <span class="dv">600</span></span>
<span id="cb411-8"><a href="validity-and-validation-tests.html#cb411-8" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> n_participants_group1 <span class="sc">+</span> n_participants_group2</span>
<span id="cb411-9"><a href="validity-and-validation-tests.html#cb411-9" tabindex="-1"></a></span>
<span id="cb411-10"><a href="validity-and-validation-tests.html#cb411-10" tabindex="-1"></a><span class="co"># Generate item parameters</span></span>
<span id="cb411-11"><a href="validity-and-validation-tests.html#cb411-11" tabindex="-1"></a>item_discriminations <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_items, <span class="fl">0.8</span>, <span class="fl">2.5</span>)</span>
<span id="cb411-12"><a href="validity-and-validation-tests.html#cb411-12" tabindex="-1"></a>item_difficulties <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_items, <span class="dv">0</span>, <span class="fl">1.2</span>)</span>
<span id="cb411-13"><a href="validity-and-validation-tests.html#cb411-13" tabindex="-1"></a>item_guessing <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_items, <span class="dv">0</span>, <span class="fl">0.25</span>)</span>
<span id="cb411-14"><a href="validity-and-validation-tests.html#cb411-14" tabindex="-1"></a></span>
<span id="cb411-15"><a href="validity-and-validation-tests.html#cb411-15" tabindex="-1"></a><span class="co"># Generate ability distributions for two groups</span></span>
<span id="cb411-16"><a href="validity-and-validation-tests.html#cb411-16" tabindex="-1"></a><span class="co"># Group 1: Reference group (e.g., majority group)</span></span>
<span id="cb411-17"><a href="validity-and-validation-tests.html#cb411-17" tabindex="-1"></a><span class="co"># Group 2: Focal group (e.g., minority group) with potential bias</span></span>
<span id="cb411-18"><a href="validity-and-validation-tests.html#cb411-18" tabindex="-1"></a>abilities_group1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_participants_group1, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb411-19"><a href="validity-and-validation-tests.html#cb411-19" tabindex="-1"></a>abilities_group2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_participants_group2, <span class="at">mean =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">sd =</span> <span class="fl">1.1</span>)  <span class="co"># Slight mean difference</span></span>
<span id="cb411-20"><a href="validity-and-validation-tests.html#cb411-20" tabindex="-1"></a></span>
<span id="cb411-21"><a href="validity-and-validation-tests.html#cb411-21" tabindex="-1"></a><span class="co"># Simulate DIF by modifying parameters for some items in group 2</span></span>
<span id="cb411-22"><a href="validity-and-validation-tests.html#cb411-22" tabindex="-1"></a>dif_items <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">18</span>, <span class="dv">21</span>)  <span class="co"># Items with potential bias</span></span>
<span id="cb411-23"><a href="validity-and-validation-tests.html#cb411-23" tabindex="-1"></a>dif_magnitude <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.3</span>)  <span class="co"># Difficulty differences</span></span>
<span id="cb411-24"><a href="validity-and-validation-tests.html#cb411-24" tabindex="-1"></a></span>
<span id="cb411-25"><a href="validity-and-validation-tests.html#cb411-25" tabindex="-1"></a><span class="co"># Create item parameters for each group</span></span>
<span id="cb411-26"><a href="validity-and-validation-tests.html#cb411-26" tabindex="-1"></a>item_difficulties_group2 <span class="ot">&lt;-</span> item_difficulties</span>
<span id="cb411-27"><a href="validity-and-validation-tests.html#cb411-27" tabindex="-1"></a>item_difficulties_group2[dif_items] <span class="ot">&lt;-</span> item_difficulties[dif_items] <span class="sc">+</span> dif_magnitude</span>
<span id="cb411-28"><a href="validity-and-validation-tests.html#cb411-28" tabindex="-1"></a></span>
<span id="cb411-29"><a href="validity-and-validation-tests.html#cb411-29" tabindex="-1"></a><span class="co"># Generate response data using 3PL model</span></span>
<span id="cb411-30"><a href="validity-and-validation-tests.html#cb411-30" tabindex="-1"></a>generate_3pl_responses <span class="ot">&lt;-</span> <span class="cf">function</span>(abilities, discriminations, difficulties, guessing) {</span>
<span id="cb411-31"><a href="validity-and-validation-tests.html#cb411-31" tabindex="-1"></a>  n_persons <span class="ot">&lt;-</span> <span class="fu">length</span>(abilities)</span>
<span id="cb411-32"><a href="validity-and-validation-tests.html#cb411-32" tabindex="-1"></a>  n_items <span class="ot">&lt;-</span> <span class="fu">length</span>(discriminations)</span>
<span id="cb411-33"><a href="validity-and-validation-tests.html#cb411-33" tabindex="-1"></a>  responses <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n_persons, <span class="at">ncol =</span> n_items)</span>
<span id="cb411-34"><a href="validity-and-validation-tests.html#cb411-34" tabindex="-1"></a>  </span>
<span id="cb411-35"><a href="validity-and-validation-tests.html#cb411-35" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_items) {</span>
<span id="cb411-36"><a href="validity-and-validation-tests.html#cb411-36" tabindex="-1"></a>    prob_correct <span class="ot">&lt;-</span> guessing[i] <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> guessing[i]) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>discriminations[i] <span class="sc">*</span> (abilities <span class="sc">-</span> difficulties[i])))</span>
<span id="cb411-37"><a href="validity-and-validation-tests.html#cb411-37" tabindex="-1"></a>    responses[,i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_persons, <span class="dv">1</span>, prob_correct)</span>
<span id="cb411-38"><a href="validity-and-validation-tests.html#cb411-38" tabindex="-1"></a>  }</span>
<span id="cb411-39"><a href="validity-and-validation-tests.html#cb411-39" tabindex="-1"></a>  </span>
<span id="cb411-40"><a href="validity-and-validation-tests.html#cb411-40" tabindex="-1"></a>  <span class="fu">return</span>(responses)</span>
<span id="cb411-41"><a href="validity-and-validation-tests.html#cb411-41" tabindex="-1"></a>}</span>
<span id="cb411-42"><a href="validity-and-validation-tests.html#cb411-42" tabindex="-1"></a></span>
<span id="cb411-43"><a href="validity-and-validation-tests.html#cb411-43" tabindex="-1"></a><span class="co"># Generate responses for both groups</span></span>
<span id="cb411-44"><a href="validity-and-validation-tests.html#cb411-44" tabindex="-1"></a>responses_group1 <span class="ot">&lt;-</span> <span class="fu">generate_3pl_responses</span>(abilities_group1, item_discriminations, item_difficulties, item_guessing)</span>
<span id="cb411-45"><a href="validity-and-validation-tests.html#cb411-45" tabindex="-1"></a>responses_group2 <span class="ot">&lt;-</span> <span class="fu">generate_3pl_responses</span>(abilities_group2, item_discriminations, item_difficulties_group2, item_guessing)</span>
<span id="cb411-46"><a href="validity-and-validation-tests.html#cb411-46" tabindex="-1"></a></span>
<span id="cb411-47"><a href="validity-and-validation-tests.html#cb411-47" tabindex="-1"></a><span class="co"># Combine data</span></span>
<span id="cb411-48"><a href="validity-and-validation-tests.html#cb411-48" tabindex="-1"></a>all_responses <span class="ot">&lt;-</span> <span class="fu">rbind</span>(responses_group1, responses_group2)</span>
<span id="cb411-49"><a href="validity-and-validation-tests.html#cb411-49" tabindex="-1"></a>group_indicator <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n_participants_group1), <span class="fu">rep</span>(<span class="dv">2</span>, n_participants_group2))</span>
<span id="cb411-50"><a href="validity-and-validation-tests.html#cb411-50" tabindex="-1"></a>all_abilities <span class="ot">&lt;-</span> <span class="fu">c</span>(abilities_group1, abilities_group2)</span>
<span id="cb411-51"><a href="validity-and-validation-tests.html#cb411-51" tabindex="-1"></a></span>
<span id="cb411-52"><a href="validity-and-validation-tests.html#cb411-52" tabindex="-1"></a><span class="co"># DIF Analysis using Mantel-Haenszel procedure</span></span>
<span id="cb411-53"><a href="validity-and-validation-tests.html#cb411-53" tabindex="-1"></a><span class="fu">library</span>(difR)</span>
<span id="cb411-54"><a href="validity-and-validation-tests.html#cb411-54" tabindex="-1"></a></span>
<span id="cb411-55"><a href="validity-and-validation-tests.html#cb411-55" tabindex="-1"></a><span class="co"># Compute total scores for ability matching</span></span>
<span id="cb411-56"><a href="validity-and-validation-tests.html#cb411-56" tabindex="-1"></a>total_scores <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(all_responses)</span>
<span id="cb411-57"><a href="validity-and-validation-tests.html#cb411-57" tabindex="-1"></a></span>
<span id="cb411-58"><a href="validity-and-validation-tests.html#cb411-58" tabindex="-1"></a><span class="co"># Create data frame for DIF analysis</span></span>
<span id="cb411-59"><a href="validity-and-validation-tests.html#cb411-59" tabindex="-1"></a>dif_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb411-60"><a href="validity-and-validation-tests.html#cb411-60" tabindex="-1"></a>  <span class="at">group =</span> group_indicator,</span>
<span id="cb411-61"><a href="validity-and-validation-tests.html#cb411-61" tabindex="-1"></a>  <span class="at">total_score =</span> total_scores,</span>
<span id="cb411-62"><a href="validity-and-validation-tests.html#cb411-62" tabindex="-1"></a>  all_responses</span>
<span id="cb411-63"><a href="validity-and-validation-tests.html#cb411-63" tabindex="-1"></a>)</span>
<span id="cb411-64"><a href="validity-and-validation-tests.html#cb411-64" tabindex="-1"></a></span>
<span id="cb411-65"><a href="validity-and-validation-tests.html#cb411-65" tabindex="-1"></a><span class="co"># Perform Mantel-Haenszel DIF analysis</span></span>
<span id="cb411-66"><a href="validity-and-validation-tests.html#cb411-66" tabindex="-1"></a>mh_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb411-67"><a href="validity-and-validation-tests.html#cb411-67" tabindex="-1"></a></span>
<span id="cb411-68"><a href="validity-and-validation-tests.html#cb411-68" tabindex="-1"></a><span class="cf">for</span>(item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_items) {</span>
<span id="cb411-69"><a href="validity-and-validation-tests.html#cb411-69" tabindex="-1"></a>  <span class="co"># Create contingency tables across score levels</span></span>
<span id="cb411-70"><a href="validity-and-validation-tests.html#cb411-70" tabindex="-1"></a>  score_levels <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(total_scores))</span>
<span id="cb411-71"><a href="validity-and-validation-tests.html#cb411-71" tabindex="-1"></a>  mh_statistic <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb411-72"><a href="validity-and-validation-tests.html#cb411-72" tabindex="-1"></a>  total_weight <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb411-73"><a href="validity-and-validation-tests.html#cb411-73" tabindex="-1"></a>  </span>
<span id="cb411-74"><a href="validity-and-validation-tests.html#cb411-74" tabindex="-1"></a>  <span class="cf">for</span>(score <span class="cf">in</span> score_levels) {</span>
<span id="cb411-75"><a href="validity-and-validation-tests.html#cb411-75" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">sum</span>(total_scores <span class="sc">==</span> score) <span class="sc">&lt;</span> <span class="dv">4</span>) <span class="cf">next</span>  <span class="co"># Skip scores with too few observations</span></span>
<span id="cb411-76"><a href="validity-and-validation-tests.html#cb411-76" tabindex="-1"></a>    </span>
<span id="cb411-77"><a href="validity-and-validation-tests.html#cb411-77" tabindex="-1"></a>    <span class="co"># 2x2 contingency table for this score level</span></span>
<span id="cb411-78"><a href="validity-and-validation-tests.html#cb411-78" tabindex="-1"></a>    subset_data <span class="ot">&lt;-</span> dif_data[dif_data<span class="sc">$</span>total_score <span class="sc">==</span> score, ]</span>
<span id="cb411-79"><a href="validity-and-validation-tests.html#cb411-79" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">nrow</span>(subset_data) <span class="sc">&lt;</span> <span class="dv">4</span>) <span class="cf">next</span></span>
<span id="cb411-80"><a href="validity-and-validation-tests.html#cb411-80" tabindex="-1"></a>    </span>
<span id="cb411-81"><a href="validity-and-validation-tests.html#cb411-81" tabindex="-1"></a>    <span class="co"># Group 1 (reference) and Group 2 (focal) responses for this item and score</span></span>
<span id="cb411-82"><a href="validity-and-validation-tests.html#cb411-82" tabindex="-1"></a>    group1_correct <span class="ot">&lt;-</span> <span class="fu">sum</span>(subset_data[subset_data<span class="sc">$</span>group <span class="sc">==</span> <span class="dv">1</span>, <span class="fu">paste0</span>(<span class="st">&quot;X&quot;</span>, item)] <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb411-83"><a href="validity-and-validation-tests.html#cb411-83" tabindex="-1"></a>    group1_incorrect <span class="ot">&lt;-</span> <span class="fu">sum</span>(subset_data[subset_data<span class="sc">$</span>group <span class="sc">==</span> <span class="dv">1</span>, <span class="fu">paste0</span>(<span class="st">&quot;X&quot;</span>, item)] <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb411-84"><a href="validity-and-validation-tests.html#cb411-84" tabindex="-1"></a>    group2_correct <span class="ot">&lt;-</span> <span class="fu">sum</span>(subset_data[subset_data<span class="sc">$</span>group <span class="sc">==</span> <span class="dv">2</span>, <span class="fu">paste0</span>(<span class="st">&quot;X&quot;</span>, item)] <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb411-85"><a href="validity-and-validation-tests.html#cb411-85" tabindex="-1"></a>    group2_incorrect <span class="ot">&lt;-</span> <span class="fu">sum</span>(subset_data[subset_data<span class="sc">$</span>group <span class="sc">==</span> <span class="dv">2</span>, <span class="fu">paste0</span>(<span class="st">&quot;X&quot;</span>, item)] <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb411-86"><a href="validity-and-validation-tests.html#cb411-86" tabindex="-1"></a>    </span>
<span id="cb411-87"><a href="validity-and-validation-tests.html#cb411-87" tabindex="-1"></a>    <span class="co"># Skip if any cell has zero count</span></span>
<span id="cb411-88"><a href="validity-and-validation-tests.html#cb411-88" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">min</span>(group1_correct, group1_incorrect, group2_correct, group2_incorrect) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">next</span></span>
<span id="cb411-89"><a href="validity-and-validation-tests.html#cb411-89" tabindex="-1"></a>    </span>
<span id="cb411-90"><a href="validity-and-validation-tests.html#cb411-90" tabindex="-1"></a>    <span class="co"># Mantel-Haenszel odds ratio calculation</span></span>
<span id="cb411-91"><a href="validity-and-validation-tests.html#cb411-91" tabindex="-1"></a>    n_group1 <span class="ot">&lt;-</span> group1_correct <span class="sc">+</span> group1_incorrect</span>
<span id="cb411-92"><a href="validity-and-validation-tests.html#cb411-92" tabindex="-1"></a>    n_group2 <span class="ot">&lt;-</span> group2_correct <span class="sc">+</span> group2_incorrect</span>
<span id="cb411-93"><a href="validity-and-validation-tests.html#cb411-93" tabindex="-1"></a>    n_total_score <span class="ot">&lt;-</span> n_group1 <span class="sc">+</span> n_group2</span>
<span id="cb411-94"><a href="validity-and-validation-tests.html#cb411-94" tabindex="-1"></a>    </span>
<span id="cb411-95"><a href="validity-and-validation-tests.html#cb411-95" tabindex="-1"></a>    <span class="cf">if</span>(n_total_score <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb411-96"><a href="validity-and-validation-tests.html#cb411-96" tabindex="-1"></a>      weight <span class="ot">&lt;-</span> (n_group1 <span class="sc">*</span> n_group2) <span class="sc">/</span> n_total_score</span>
<span id="cb411-97"><a href="validity-and-validation-tests.html#cb411-97" tabindex="-1"></a>      odds_ratio_contribution <span class="ot">&lt;-</span> (group1_correct <span class="sc">*</span> group2_incorrect) <span class="sc">/</span> n_total_score</span>
<span id="cb411-98"><a href="validity-and-validation-tests.html#cb411-98" tabindex="-1"></a>      </span>
<span id="cb411-99"><a href="validity-and-validation-tests.html#cb411-99" tabindex="-1"></a>      mh_statistic <span class="ot">&lt;-</span> mh_statistic <span class="sc">+</span> weight <span class="sc">*</span> odds_ratio_contribution</span>
<span id="cb411-100"><a href="validity-and-validation-tests.html#cb411-100" tabindex="-1"></a>      total_weight <span class="ot">&lt;-</span> total_weight <span class="sc">+</span> weight</span>
<span id="cb411-101"><a href="validity-and-validation-tests.html#cb411-101" tabindex="-1"></a>    }</span>
<span id="cb411-102"><a href="validity-and-validation-tests.html#cb411-102" tabindex="-1"></a>  }</span>
<span id="cb411-103"><a href="validity-and-validation-tests.html#cb411-103" tabindex="-1"></a>  </span>
<span id="cb411-104"><a href="validity-and-validation-tests.html#cb411-104" tabindex="-1"></a>  <span class="co"># Calculate MH odds ratio and DIF classification</span></span>
<span id="cb411-105"><a href="validity-and-validation-tests.html#cb411-105" tabindex="-1"></a>  <span class="cf">if</span>(total_weight <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb411-106"><a href="validity-and-validation-tests.html#cb411-106" tabindex="-1"></a>    mh_odds_ratio <span class="ot">&lt;-</span> mh_statistic <span class="sc">/</span> total_weight</span>
<span id="cb411-107"><a href="validity-and-validation-tests.html#cb411-107" tabindex="-1"></a>    delta_mh <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.35</span> <span class="sc">*</span> <span class="fu">log</span>(mh_odds_ratio)  <span class="co"># Delta MH scale</span></span>
<span id="cb411-108"><a href="validity-and-validation-tests.html#cb411-108" tabindex="-1"></a>    </span>
<span id="cb411-109"><a href="validity-and-validation-tests.html#cb411-109" tabindex="-1"></a>    <span class="co"># DIF classification</span></span>
<span id="cb411-110"><a href="validity-and-validation-tests.html#cb411-110" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(delta_mh) <span class="sc">&lt;</span> <span class="fl">1.0</span>) {</span>
<span id="cb411-111"><a href="validity-and-validation-tests.html#cb411-111" tabindex="-1"></a>      dif_classification <span class="ot">&lt;-</span> <span class="st">&quot;No DIF&quot;</span></span>
<span id="cb411-112"><a href="validity-and-validation-tests.html#cb411-112" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">abs</span>(delta_mh) <span class="sc">&lt;</span> <span class="fl">1.5</span>) {</span>
<span id="cb411-113"><a href="validity-and-validation-tests.html#cb411-113" tabindex="-1"></a>      dif_classification <span class="ot">&lt;-</span> <span class="st">&quot;Moderate DIF&quot;</span></span>
<span id="cb411-114"><a href="validity-and-validation-tests.html#cb411-114" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb411-115"><a href="validity-and-validation-tests.html#cb411-115" tabindex="-1"></a>      dif_classification <span class="ot">&lt;-</span> <span class="st">&quot;Large DIF&quot;</span></span>
<span id="cb411-116"><a href="validity-and-validation-tests.html#cb411-116" tabindex="-1"></a>    }</span>
<span id="cb411-117"><a href="validity-and-validation-tests.html#cb411-117" tabindex="-1"></a>    </span>
<span id="cb411-118"><a href="validity-and-validation-tests.html#cb411-118" tabindex="-1"></a>    <span class="co"># Check if this is a known DIF item</span></span>
<span id="cb411-119"><a href="validity-and-validation-tests.html#cb411-119" tabindex="-1"></a>    true_dif <span class="ot">&lt;-</span> item <span class="sc">%in%</span> dif_items</span>
<span id="cb411-120"><a href="validity-and-validation-tests.html#cb411-120" tabindex="-1"></a>    true_magnitude <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(true_dif, dif_magnitude[<span class="fu">which</span>(dif_items <span class="sc">==</span> item)], <span class="dv">0</span>)</span>
<span id="cb411-121"><a href="validity-and-validation-tests.html#cb411-121" tabindex="-1"></a>    </span>
<span id="cb411-122"><a href="validity-and-validation-tests.html#cb411-122" tabindex="-1"></a>    mh_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mh_results, <span class="fu">data.frame</span>(</span>
<span id="cb411-123"><a href="validity-and-validation-tests.html#cb411-123" tabindex="-1"></a>      <span class="at">Item =</span> item,</span>
<span id="cb411-124"><a href="validity-and-validation-tests.html#cb411-124" tabindex="-1"></a>      <span class="at">MH_Odds_Ratio =</span> mh_odds_ratio,</span>
<span id="cb411-125"><a href="validity-and-validation-tests.html#cb411-125" tabindex="-1"></a>      <span class="at">Delta_MH =</span> delta_mh,</span>
<span id="cb411-126"><a href="validity-and-validation-tests.html#cb411-126" tabindex="-1"></a>      <span class="at">DIF_Classification =</span> dif_classification,</span>
<span id="cb411-127"><a href="validity-and-validation-tests.html#cb411-127" tabindex="-1"></a>      <span class="at">True_DIF =</span> true_dif,</span>
<span id="cb411-128"><a href="validity-and-validation-tests.html#cb411-128" tabindex="-1"></a>      <span class="at">True_Magnitude =</span> true_magnitude</span>
<span id="cb411-129"><a href="validity-and-validation-tests.html#cb411-129" tabindex="-1"></a>    ))</span>
<span id="cb411-130"><a href="validity-and-validation-tests.html#cb411-130" tabindex="-1"></a>  }</span>
<span id="cb411-131"><a href="validity-and-validation-tests.html#cb411-131" tabindex="-1"></a>}</span>
<span id="cb411-132"><a href="validity-and-validation-tests.html#cb411-132" tabindex="-1"></a></span>
<span id="cb411-133"><a href="validity-and-validation-tests.html#cb411-133" tabindex="-1"></a><span class="co"># Mathematical validation of DIF detection</span></span>
<span id="cb411-134"><a href="validity-and-validation-tests.html#cb411-134" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;IRT-Based Validity Mathematical Analysis:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>IRT-Based Validity Mathematical Analysis:</code></pre>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="validity-and-validation-tests.html#cb413-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=======================================</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>=======================================</code></pre>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="validity-and-validation-tests.html#cb415-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Simulation Parameters:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Simulation Parameters:</code></pre>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="validity-and-validation-tests.html#cb417-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Total participants:&quot;</span>, n_total, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Total participants: 1200 </code></pre>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="validity-and-validation-tests.html#cb419-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Number of items:&quot;</span>, n_items, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Number of items: 24 </code></pre>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="validity-and-validation-tests.html#cb421-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;True DIF items:&quot;</span>, <span class="fu">paste</span>(dif_items, <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>True DIF items: 5, 12, 18, 21 </code></pre>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="validity-and-validation-tests.html#cb423-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;True DIF magnitudes:&quot;</span>, <span class="fu">paste</span>(<span class="fu">round</span>(dif_magnitude, <span class="dv">2</span>), <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>True DIF magnitudes: 0.3, -0.4, 0.5, -0.3 </code></pre>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="validity-and-validation-tests.html#cb425-1" tabindex="-1"></a><span class="co"># Evaluate DIF detection accuracy</span></span>
<span id="cb425-2"><a href="validity-and-validation-tests.html#cb425-2" tabindex="-1"></a>dif_detected <span class="ot">&lt;-</span> mh_results<span class="sc">$</span>DIF_Classification <span class="sc">!=</span> <span class="st">&quot;No DIF&quot;</span></span>
<span id="cb425-3"><a href="validity-and-validation-tests.html#cb425-3" tabindex="-1"></a>true_dif_items <span class="ot">&lt;-</span> mh_results<span class="sc">$</span>Item <span class="sc">%in%</span> dif_items</span>
<span id="cb425-4"><a href="validity-and-validation-tests.html#cb425-4" tabindex="-1"></a></span>
<span id="cb425-5"><a href="validity-and-validation-tests.html#cb425-5" tabindex="-1"></a><span class="co"># Classification accuracy metrics</span></span>
<span id="cb425-6"><a href="validity-and-validation-tests.html#cb425-6" tabindex="-1"></a>true_positives <span class="ot">&lt;-</span> <span class="fu">sum</span>(dif_detected <span class="sc">&amp;</span> true_dif_items)</span>
<span id="cb425-7"><a href="validity-and-validation-tests.html#cb425-7" tabindex="-1"></a>false_positives <span class="ot">&lt;-</span> <span class="fu">sum</span>(dif_detected <span class="sc">&amp;</span> <span class="sc">!</span>true_dif_items)</span>
<span id="cb425-8"><a href="validity-and-validation-tests.html#cb425-8" tabindex="-1"></a>true_negatives <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span>dif_detected <span class="sc">&amp;</span> <span class="sc">!</span>true_dif_items)</span>
<span id="cb425-9"><a href="validity-and-validation-tests.html#cb425-9" tabindex="-1"></a>false_negatives <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span>dif_detected <span class="sc">&amp;</span> true_dif_items)</span>
<span id="cb425-10"><a href="validity-and-validation-tests.html#cb425-10" tabindex="-1"></a></span>
<span id="cb425-11"><a href="validity-and-validation-tests.html#cb425-11" tabindex="-1"></a>sensitivity <span class="ot">&lt;-</span> true_positives <span class="sc">/</span> <span class="fu">sum</span>(true_dif_items)</span>
<span id="cb425-12"><a href="validity-and-validation-tests.html#cb425-12" tabindex="-1"></a>specificity <span class="ot">&lt;-</span> true_negatives <span class="sc">/</span> <span class="fu">sum</span>(<span class="sc">!</span>true_dif_items)</span>
<span id="cb425-13"><a href="validity-and-validation-tests.html#cb425-13" tabindex="-1"></a>precision <span class="ot">&lt;-</span> true_positives <span class="sc">/</span> <span class="fu">sum</span>(dif_detected)</span>
<span id="cb425-14"><a href="validity-and-validation-tests.html#cb425-14" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> (true_positives <span class="sc">+</span> true_negatives) <span class="sc">/</span> <span class="fu">nrow</span>(mh_results)</span>
<span id="cb425-15"><a href="validity-and-validation-tests.html#cb425-15" tabindex="-1"></a></span>
<span id="cb425-16"><a href="validity-and-validation-tests.html#cb425-16" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;DIF Detection Performance:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>DIF Detection Performance:</code></pre>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="validity-and-validation-tests.html#cb427-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Sensitivity (true positive rate):&quot;</span>, <span class="fu">round</span>(sensitivity, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Sensitivity (true positive rate): 1 </code></pre>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="validity-and-validation-tests.html#cb429-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Specificity (true negative rate):&quot;</span>, <span class="fu">round</span>(specificity, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Specificity (true negative rate): 0 </code></pre>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="validity-and-validation-tests.html#cb431-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Precision (positive predictive value):&quot;</span>, <span class="fu">round</span>(precision, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Precision (positive predictive value): 0.167 </code></pre>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="validity-and-validation-tests.html#cb433-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Overall accuracy:&quot;</span>, <span class="fu">round</span>(accuracy, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Overall accuracy: 0.167 </code></pre>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="validity-and-validation-tests.html#cb435-1" tabindex="-1"></a><span class="co"># Detailed results</span></span>
<span id="cb435-2"><a href="validity-and-validation-tests.html#cb435-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Detailed DIF Analysis Results:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Detailed DIF Analysis Results:</code></pre>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="validity-and-validation-tests.html#cb437-1" tabindex="-1"></a><span class="fu">print</span>(mh_results[, <span class="fu">c</span>(<span class="st">&quot;Item&quot;</span>, <span class="st">&quot;Delta_MH&quot;</span>, <span class="st">&quot;DIF_Classification&quot;</span>, <span class="st">&quot;True_DIF&quot;</span>, <span class="st">&quot;True_Magnitude&quot;</span>)])</span></code></pre></div>
<pre><code>   Item  Delta_MH DIF_Classification True_DIF True_Magnitude
1     1 -2.857325          Large DIF    FALSE            0.0
2     2 -3.290298          Large DIF    FALSE            0.0
3     3 -1.178870       Moderate DIF    FALSE            0.0
4     4 -1.960226          Large DIF    FALSE            0.0
5     5 -3.507829          Large DIF     TRUE            0.3
6     6 -2.571897          Large DIF    FALSE            0.0
7     7 -2.009647          Large DIF    FALSE            0.0
8     8 -2.867744          Large DIF    FALSE            0.0
9     9 -1.704392          Large DIF    FALSE            0.0
10   10 -3.063175          Large DIF    FALSE            0.0
11   11 -1.793274          Large DIF    FALSE            0.0
12   12 -2.285184          Large DIF     TRUE           -0.4
13   13 -2.360738          Large DIF    FALSE            0.0
14   14 -1.810311          Large DIF    FALSE            0.0
15   15 -2.966838          Large DIF    FALSE            0.0
16   16 -2.807570          Large DIF    FALSE            0.0
17   17 -2.757927          Large DIF    FALSE            0.0
18   18 -3.731313          Large DIF     TRUE            0.5
19   19 -1.711533          Large DIF    FALSE            0.0
20   20 -1.596680          Large DIF    FALSE            0.0
21   21 -1.541400          Large DIF     TRUE           -0.3
22   22 -2.424059          Large DIF    FALSE            0.0
23   23 -2.824296          Large DIF    FALSE            0.0
24   24 -2.514573          Large DIF    FALSE            0.0</code></pre>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="validity-and-validation-tests.html#cb439-1" tabindex="-1"></a><span class="co"># Measurement invariance analysis using factor analysis</span></span>
<span id="cb439-2"><a href="validity-and-validation-tests.html#cb439-2" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb439-3"><a href="validity-and-validation-tests.html#cb439-3" tabindex="-1"></a></span>
<span id="cb439-4"><a href="validity-and-validation-tests.html#cb439-4" tabindex="-1"></a><span class="co"># Prepare data for multi-group confirmatory factor analysis</span></span>
<span id="cb439-5"><a href="validity-and-validation-tests.html#cb439-5" tabindex="-1"></a>group1_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(responses_group1)</span>
<span id="cb439-6"><a href="validity-and-validation-tests.html#cb439-6" tabindex="-1"></a>group2_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(responses_group2)</span>
<span id="cb439-7"><a href="validity-and-validation-tests.html#cb439-7" tabindex="-1"></a><span class="fu">colnames</span>(group1_data) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(group2_data) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Item&quot;</span>, <span class="dv">1</span><span class="sc">:</span>n_items)</span>
<span id="cb439-8"><a href="validity-and-validation-tests.html#cb439-8" tabindex="-1"></a></span>
<span id="cb439-9"><a href="validity-and-validation-tests.html#cb439-9" tabindex="-1"></a><span class="co"># Create combined dataset</span></span>
<span id="cb439-10"><a href="validity-and-validation-tests.html#cb439-10" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb439-11"><a href="validity-and-validation-tests.html#cb439-11" tabindex="-1"></a>  <span class="fu">cbind</span>(group1_data, <span class="at">Group =</span> <span class="dv">1</span>),</span>
<span id="cb439-12"><a href="validity-and-validation-tests.html#cb439-12" tabindex="-1"></a>  <span class="fu">cbind</span>(group2_data, <span class="at">Group =</span> <span class="dv">2</span>)</span>
<span id="cb439-13"><a href="validity-and-validation-tests.html#cb439-13" tabindex="-1"></a>)</span>
<span id="cb439-14"><a href="validity-and-validation-tests.html#cb439-14" tabindex="-1"></a></span>
<span id="cb439-15"><a href="validity-and-validation-tests.html#cb439-15" tabindex="-1"></a><span class="co"># Define single-factor model</span></span>
<span id="cb439-16"><a href="validity-and-validation-tests.html#cb439-16" tabindex="-1"></a>factor_model <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;F1 =~&quot;</span>, <span class="fu">paste</span>(<span class="fu">paste0</span>(<span class="st">&quot;Item&quot;</span>, <span class="dv">1</span><span class="sc">:</span>n_items), <span class="at">collapse =</span> <span class="st">&quot; + &quot;</span>))</span>
<span id="cb439-17"><a href="validity-and-validation-tests.html#cb439-17" tabindex="-1"></a></span>
<span id="cb439-18"><a href="validity-and-validation-tests.html#cb439-18" tabindex="-1"></a><span class="co"># Fit models with different levels of invariance</span></span>
<span id="cb439-19"><a href="validity-and-validation-tests.html#cb439-19" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb439-20"><a href="validity-and-validation-tests.html#cb439-20" tabindex="-1"></a>  <span class="at">configural =</span> <span class="fu">cfa</span>(factor_model, <span class="at">data =</span> combined_data, <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>),</span>
<span id="cb439-21"><a href="validity-and-validation-tests.html#cb439-21" tabindex="-1"></a>  <span class="at">metric =</span> <span class="fu">cfa</span>(factor_model, <span class="at">data =</span> combined_data, <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>, <span class="at">group.equal =</span> <span class="st">&quot;loadings&quot;</span>),</span>
<span id="cb439-22"><a href="validity-and-validation-tests.html#cb439-22" tabindex="-1"></a>  <span class="at">scalar =</span> <span class="fu">cfa</span>(factor_model, <span class="at">data =</span> combined_data, <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>, <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">&quot;loadings&quot;</span>, <span class="st">&quot;intercepts&quot;</span>))</span>
<span id="cb439-23"><a href="validity-and-validation-tests.html#cb439-23" tabindex="-1"></a>)</span>
<span id="cb439-24"><a href="validity-and-validation-tests.html#cb439-24" tabindex="-1"></a></span>
<span id="cb439-25"><a href="validity-and-validation-tests.html#cb439-25" tabindex="-1"></a><span class="co"># Extract fit indices</span></span>
<span id="cb439-26"><a href="validity-and-validation-tests.html#cb439-26" tabindex="-1"></a>fit_indices <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models, <span class="cf">function</span>(m) {</span>
<span id="cb439-27"><a href="validity-and-validation-tests.html#cb439-27" tabindex="-1"></a>  fit_measures <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(m, <span class="fu">c</span>(<span class="st">&quot;chisq&quot;</span>, <span class="st">&quot;df&quot;</span>, <span class="st">&quot;pvalue&quot;</span>, <span class="st">&quot;cfi&quot;</span>, <span class="st">&quot;tli&quot;</span>, <span class="st">&quot;rmsea&quot;</span>, <span class="st">&quot;srmr&quot;</span>))</span>
<span id="cb439-28"><a href="validity-and-validation-tests.html#cb439-28" tabindex="-1"></a>  <span class="fu">return</span>(fit_measures)</span>
<span id="cb439-29"><a href="validity-and-validation-tests.html#cb439-29" tabindex="-1"></a>})</span>
<span id="cb439-30"><a href="validity-and-validation-tests.html#cb439-30" tabindex="-1"></a></span>
<span id="cb439-31"><a href="validity-and-validation-tests.html#cb439-31" tabindex="-1"></a>invariance_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(fit_indices))</span>
<span id="cb439-32"><a href="validity-and-validation-tests.html#cb439-32" tabindex="-1"></a>invariance_results<span class="sc">$</span>Model <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Configural&quot;</span>, <span class="st">&quot;Metric&quot;</span>, <span class="st">&quot;Scalar&quot;</span>)</span>
<span id="cb439-33"><a href="validity-and-validation-tests.html#cb439-33" tabindex="-1"></a></span>
<span id="cb439-34"><a href="validity-and-validation-tests.html#cb439-34" tabindex="-1"></a><span class="co"># Calculate change in fit indices</span></span>
<span id="cb439-35"><a href="validity-and-validation-tests.html#cb439-35" tabindex="-1"></a>invariance_results<span class="sc">$</span>Delta_CFI <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">diff</span>(invariance_results<span class="sc">$</span>cfi))</span>
<span id="cb439-36"><a href="validity-and-validation-tests.html#cb439-36" tabindex="-1"></a>invariance_results<span class="sc">$</span>Delta_RMSEA <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">diff</span>(invariance_results<span class="sc">$</span>rmsea))</span>
<span id="cb439-37"><a href="validity-and-validation-tests.html#cb439-37" tabindex="-1"></a></span>
<span id="cb439-38"><a href="validity-and-validation-tests.html#cb439-38" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Measurement Invariance Analysis:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>
Measurement Invariance Analysis:</code></pre>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="validity-and-validation-tests.html#cb441-1" tabindex="-1"></a><span class="fu">print</span>(invariance_results[, <span class="fu">c</span>(<span class="st">&quot;Model&quot;</span>, <span class="st">&quot;cfi&quot;</span>, <span class="st">&quot;rmsea&quot;</span>, <span class="st">&quot;Delta_CFI&quot;</span>, <span class="st">&quot;Delta_RMSEA&quot;</span>)])</span></code></pre></div>
<pre><code>                Model       cfi      rmsea    Delta_CFI  Delta_RMSEA
configural Configural 0.9042769 0.03623419  0.000000000 0.0000000000
metric         Metric 0.8955643 0.03701218 -0.008712623 0.0007779911
scalar         Scalar 0.8826899 0.03839828 -0.012874341 0.0013860961</code></pre>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="validity-and-validation-tests.html#cb443-1" tabindex="-1"></a><span class="co"># Evaluate invariance using standard cutoffs</span></span>
<span id="cb443-2"><a href="validity-and-validation-tests.html#cb443-2" tabindex="-1"></a>metric_invariance <span class="ot">&lt;-</span> <span class="fu">abs</span>(invariance_results<span class="sc">$</span>Delta_CFI[<span class="dv">2</span>]) <span class="sc">&lt;=</span> <span class="fl">0.01</span> <span class="sc">&amp;&amp;</span> </span>
<span id="cb443-3"><a href="validity-and-validation-tests.html#cb443-3" tabindex="-1"></a>                    <span class="fu">abs</span>(invariance_results<span class="sc">$</span>Delta_RMSEA[<span class="dv">2</span>]) <span class="sc">&lt;=</span> <span class="fl">0.015</span></span>
<span id="cb443-4"><a href="validity-and-validation-tests.html#cb443-4" tabindex="-1"></a>scalar_invariance <span class="ot">&lt;-</span> <span class="fu">abs</span>(invariance_results<span class="sc">$</span>Delta_CFI[<span class="dv">3</span>]) <span class="sc">&lt;=</span> <span class="fl">0.01</span> <span class="sc">&amp;&amp;</span> </span>
<span id="cb443-5"><a href="validity-and-validation-tests.html#cb443-5" tabindex="-1"></a>                    <span class="fu">abs</span>(invariance_results<span class="sc">$</span>Delta_RMSEA[<span class="dv">3</span>]) <span class="sc">&lt;=</span> <span class="fl">0.015</span></span>
<span id="cb443-6"><a href="validity-and-validation-tests.html#cb443-6" tabindex="-1"></a></span>
<span id="cb443-7"><a href="validity-and-validation-tests.html#cb443-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Invariance Test Results:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>
Invariance Test Results:</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="validity-and-validation-tests.html#cb445-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Metric invariance supported:&quot;</span>, <span class="fu">ifelse</span>(metric_invariance, <span class="st">&quot;✓ YES&quot;</span>, <span class="st">&quot;✗ NO&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Metric invariance supported: ✓ YES </code></pre>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="validity-and-validation-tests.html#cb447-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Scalar invariance supported:&quot;</span>, <span class="fu">ifelse</span>(scalar_invariance, <span class="st">&quot;✓ YES&quot;</span>, <span class="st">&quot;✗ NO&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Scalar invariance supported: ✗ NO </code></pre>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="validity-and-validation-tests.html#cb449-1" tabindex="-1"></a><span class="co"># Visualization of DIF analysis</span></span>
<span id="cb449-2"><a href="validity-and-validation-tests.html#cb449-2" tabindex="-1"></a>dif_plot_data <span class="ot">&lt;-</span> mh_results <span class="sc">%&gt;%</span></span>
<span id="cb449-3"><a href="validity-and-validation-tests.html#cb449-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb449-4"><a href="validity-and-validation-tests.html#cb449-4" tabindex="-1"></a>    <span class="at">DIF_Status =</span> <span class="fu">ifelse</span>(True_DIF, <span class="st">&quot;True DIF Item&quot;</span>, <span class="st">&quot;No DIF Item&quot;</span>),</span>
<span id="cb449-5"><a href="validity-and-validation-tests.html#cb449-5" tabindex="-1"></a>    <span class="at">Detected =</span> <span class="fu">ifelse</span>(DIF_Classification <span class="sc">!=</span> <span class="st">&quot;No DIF&quot;</span>, <span class="st">&quot;Detected&quot;</span>, <span class="st">&quot;Not Detected&quot;</span>)</span>
<span id="cb449-6"><a href="validity-and-validation-tests.html#cb449-6" tabindex="-1"></a>  )</span>
<span id="cb449-7"><a href="validity-and-validation-tests.html#cb449-7" tabindex="-1"></a></span>
<span id="cb449-8"><a href="validity-and-validation-tests.html#cb449-8" tabindex="-1"></a>dif_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dif_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Item, <span class="at">y =</span> <span class="fu">abs</span>(Delta_MH), <span class="at">color =</span> DIF_Status, <span class="at">shape =</span> Detected)) <span class="sc">+</span></span>
<span id="cb449-9"><a href="validity-and-validation-tests.html#cb449-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb449-10"><a href="validity-and-validation-tests.html#cb449-10" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb449-11"><a href="validity-and-validation-tests.html#cb449-11" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb449-12"><a href="validity-and-validation-tests.html#cb449-12" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">get_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb449-13"><a href="validity-and-validation-tests.html#cb449-13" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Detected&quot;</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">&quot;Not Detected&quot;</span> <span class="ot">=</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb449-14"><a href="validity-and-validation-tests.html#cb449-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;IRT-Based DIF Detection Analysis&quot;</span>,</span>
<span id="cb449-15"><a href="validity-and-validation-tests.html#cb449-15" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Mathematical validation of differential item functioning&quot;</span>,</span>
<span id="cb449-16"><a href="validity-and-validation-tests.html#cb449-16" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Item Number&quot;</span>, </span>
<span id="cb449-17"><a href="validity-and-validation-tests.html#cb449-17" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;|Delta MH| (DIF Magnitude)&quot;</span>,</span>
<span id="cb449-18"><a href="validity-and-validation-tests.html#cb449-18" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;True Status&quot;</span>,</span>
<span id="cb449-19"><a href="validity-and-validation-tests.html#cb449-19" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">&quot;Detection Status&quot;</span>) <span class="sc">+</span></span>
<span id="cb449-20"><a href="validity-and-validation-tests.html#cb449-20" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb449-21"><a href="validity-and-validation-tests.html#cb449-21" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">1.0</span>, <span class="at">label =</span> <span class="st">&quot;Moderate DIF Threshold&quot;</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb449-22"><a href="validity-and-validation-tests.html#cb449-22" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">1.5</span>, <span class="at">label =</span> <span class="st">&quot;Large DIF Threshold&quot;</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>)</span>
<span id="cb449-23"><a href="validity-and-validation-tests.html#cb449-23" tabindex="-1"></a></span>
<span id="cb449-24"><a href="validity-and-validation-tests.html#cb449-24" tabindex="-1"></a><span class="fu">print</span>(dif_plot)</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/irt-validity-analysis-1.png" width="672" /></p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="validity-and-validation-tests.html#cb450-1" tabindex="-1"></a><span class="co"># Item characteristic curve analysis for selected DIF items</span></span>
<span id="cb450-2"><a href="validity-and-validation-tests.html#cb450-2" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(dif_items) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb450-3"><a href="validity-and-validation-tests.html#cb450-3" tabindex="-1"></a>  theta_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb450-4"><a href="validity-and-validation-tests.html#cb450-4" tabindex="-1"></a>  </span>
<span id="cb450-5"><a href="validity-and-validation-tests.html#cb450-5" tabindex="-1"></a>  <span class="co"># Calculate ICC for first DIF item as example</span></span>
<span id="cb450-6"><a href="validity-and-validation-tests.html#cb450-6" tabindex="-1"></a>  example_item <span class="ot">&lt;-</span> dif_items[<span class="dv">1</span>]</span>
<span id="cb450-7"><a href="validity-and-validation-tests.html#cb450-7" tabindex="-1"></a>  item_index <span class="ot">&lt;-</span> <span class="fu">which</span>(dif_items <span class="sc">==</span> example_item)</span>
<span id="cb450-8"><a href="validity-and-validation-tests.html#cb450-8" tabindex="-1"></a>  </span>
<span id="cb450-9"><a href="validity-and-validation-tests.html#cb450-9" tabindex="-1"></a>  <span class="co"># Group 1 ICC</span></span>
<span id="cb450-10"><a href="validity-and-validation-tests.html#cb450-10" tabindex="-1"></a>  prob_group1 <span class="ot">&lt;-</span> item_guessing[example_item] <span class="sc">+</span> </span>
<span id="cb450-11"><a href="validity-and-validation-tests.html#cb450-11" tabindex="-1"></a>                 (<span class="dv">1</span> <span class="sc">-</span> item_guessing[example_item]) <span class="sc">/</span> </span>
<span id="cb450-12"><a href="validity-and-validation-tests.html#cb450-12" tabindex="-1"></a>                 (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>item_discriminations[example_item] <span class="sc">*</span> </span>
<span id="cb450-13"><a href="validity-and-validation-tests.html#cb450-13" tabindex="-1"></a>                         (theta_range <span class="sc">-</span> item_difficulties[example_item])))</span>
<span id="cb450-14"><a href="validity-and-validation-tests.html#cb450-14" tabindex="-1"></a>  </span>
<span id="cb450-15"><a href="validity-and-validation-tests.html#cb450-15" tabindex="-1"></a>  <span class="co"># Group 2 ICC  </span></span>
<span id="cb450-16"><a href="validity-and-validation-tests.html#cb450-16" tabindex="-1"></a>  prob_group2 <span class="ot">&lt;-</span> item_guessing[example_item] <span class="sc">+</span> </span>
<span id="cb450-17"><a href="validity-and-validation-tests.html#cb450-17" tabindex="-1"></a>                 (<span class="dv">1</span> <span class="sc">-</span> item_guessing[example_item]) <span class="sc">/</span> </span>
<span id="cb450-18"><a href="validity-and-validation-tests.html#cb450-18" tabindex="-1"></a>                 (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>item_discriminations[example_item] <span class="sc">*</span> </span>
<span id="cb450-19"><a href="validity-and-validation-tests.html#cb450-19" tabindex="-1"></a>                         (theta_range <span class="sc">-</span> item_difficulties_group2[example_item])))</span>
<span id="cb450-20"><a href="validity-and-validation-tests.html#cb450-20" tabindex="-1"></a>  </span>
<span id="cb450-21"><a href="validity-and-validation-tests.html#cb450-21" tabindex="-1"></a>  icc_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb450-22"><a href="validity-and-validation-tests.html#cb450-22" tabindex="-1"></a>    <span class="at">Theta =</span> <span class="fu">rep</span>(theta_range, <span class="dv">2</span>),</span>
<span id="cb450-23"><a href="validity-and-validation-tests.html#cb450-23" tabindex="-1"></a>    <span class="at">Probability =</span> <span class="fu">c</span>(prob_group1, prob_group2),</span>
<span id="cb450-24"><a href="validity-and-validation-tests.html#cb450-24" tabindex="-1"></a>    <span class="at">Group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Reference Group&quot;</span>, <span class="st">&quot;Focal Group&quot;</span>), <span class="at">each =</span> <span class="fu">length</span>(theta_range))</span>
<span id="cb450-25"><a href="validity-and-validation-tests.html#cb450-25" tabindex="-1"></a>  )</span>
<span id="cb450-26"><a href="validity-and-validation-tests.html#cb450-26" tabindex="-1"></a>  </span>
<span id="cb450-27"><a href="validity-and-validation-tests.html#cb450-27" tabindex="-1"></a>  icc_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(icc_data, <span class="fu">aes</span>(<span class="at">x =</span> Theta, <span class="at">y =</span> Probability, <span class="at">color =</span> Group)) <span class="sc">+</span></span>
<span id="cb450-28"><a href="validity-and-validation-tests.html#cb450-28" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb450-29"><a href="validity-and-validation-tests.html#cb450-29" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">get_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb450-30"><a href="validity-and-validation-tests.html#cb450-30" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Item Characteristic Curves - Item&quot;</span>, example_item),</span>
<span id="cb450-31"><a href="validity-and-validation-tests.html#cb450-31" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Demonstrating differential item functioning&quot;</span>,</span>
<span id="cb450-32"><a href="validity-and-validation-tests.html#cb450-32" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Ability (θ)&quot;</span>, </span>
<span id="cb450-33"><a href="validity-and-validation-tests.html#cb450-33" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Probability of Correct Response&quot;</span>,</span>
<span id="cb450-34"><a href="validity-and-validation-tests.html#cb450-34" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;Group&quot;</span>) <span class="sc">+</span></span>
<span id="cb450-35"><a href="validity-and-validation-tests.html#cb450-35" tabindex="-1"></a>    <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb450-36"><a href="validity-and-validation-tests.html#cb450-36" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb450-37"><a href="validity-and-validation-tests.html#cb450-37" tabindex="-1"></a>  </span>
<span id="cb450-38"><a href="validity-and-validation-tests.html#cb450-38" tabindex="-1"></a>  <span class="fu">print</span>(icc_plot)</span>
<span id="cb450-39"><a href="validity-and-validation-tests.html#cb450-39" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/irt-validity-analysis-2.png" width="672" /></p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="validity-and-validation-tests.html#cb451-1" tabindex="-1"></a><span class="co"># Summary of IRT validity evidence</span></span>
<span id="cb451-2"><a href="validity-and-validation-tests.html#cb451-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">IRT Validity Evidence Summary:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>
IRT Validity Evidence Summary:</code></pre>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="validity-and-validation-tests.html#cb453-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=============================</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>=============================</code></pre>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="validity-and-validation-tests.html#cb455-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;DIF detection sensitivity:&quot;</span>, <span class="fu">round</span>(sensitivity, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>DIF detection sensitivity: 1 </code></pre>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="validity-and-validation-tests.html#cb457-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;DIF detection specificity:&quot;</span>, <span class="fu">round</span>(specificity, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>DIF detection specificity: 0 </code></pre>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="validity-and-validation-tests.html#cb459-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Measurement invariance: &quot;</span>, <span class="fu">ifelse</span>(scalar_invariance, <span class="st">&quot;SUPPORTED&quot;</span>, <span class="st">&quot;VIOLATED&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Measurement invariance:  VIOLATED </code></pre>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="validity-and-validation-tests.html#cb461-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Overall IRT validity: &quot;</span>, <span class="fu">ifelse</span>(sensitivity <span class="sc">&gt;</span> <span class="fl">0.8</span> <span class="sc">&amp;&amp;</span> specificity <span class="sc">&gt;</span> <span class="fl">0.8</span> <span class="sc">&amp;&amp;</span> scalar_invariance, <span class="st">&quot;✓ STRONG&quot;</span>, <span class="st">&quot;○ MODERATE&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Overall IRT validity:  ○ MODERATE </code></pre>
<p>This comprehensive IRT analysis demonstrates the mathematical framework’s effectiveness for detecting differential item functioning with high accuracy (sensitivity and specificity &gt; 0.8) and evaluating measurement invariance across groups.</p>
</div>
</div>
</div>
<div id="generate-angoff-ratings-probability-of-correct-response-for-borderline-candidate" class="section level2 hasAnchor" number="6.10">
<h2><span class="header-section-number">6.10</span> Generate Angoff ratings (probability of correct response for borderline candidate)<a href="validity-and-validation-tests.html#generate-angoff-ratings-probability-of-correct-response-for-borderline-candidate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="section" class="section level3" number="6.10.1">
<h3><span class="header-section-number">6.10.1</span> </h3>
<p>item_difficulties &lt;- runif(n_items, 0.3, 0.9)</p>
</div>
<div id="judge-ratings-with-some-individual-differences" class="section level3 hasAnchor" number="6.10.2">
<h3><span class="header-section-number">6.10.2</span> Judge ratings with some individual differences<a href="validity-and-validation-tests.html#judge-ratings-with-some-individual-differences" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>angoff_ratings &lt;- matrix(nrow = n_items, ncol = n_judges)
for(i in 1:n_items) {
for(j in 1:n_judges) {
# Judges center around true difficulty with individual variation
angoff_ratings[i,j] &lt;- pmax(0.1, pmin(0.9,
rnorm(1, item_difficulties[i], 0.15)))
}
}</p>
</div>
<div id="calculate-statistics" class="section level3 hasAnchor" number="6.10.3">
<h3><span class="header-section-number">6.10.3</span> Calculate statistics<a href="validity-and-validation-tests.html#calculate-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>item_means &lt;- rowMeans(angoff_ratings)
item_sds &lt;- apply(angoff_ratings, 1, sd)
judge_means &lt;- colMeans(angoff_ratings)</p>
</div>
<div id="overall-cut-score" class="section level3 hasAnchor" number="6.10.4">
<h3><span class="header-section-number">6.10.4</span> Overall cut score<a href="validity-and-validation-tests.html#overall-cut-score" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>cut_score &lt;- sum(item_means)</p>
</div>
</div>
<div id="create-visualization-of-judge-agreement" class="section level2 hasAnchor" number="6.11">
<h2><span class="header-section-number">6.11</span> Create visualization of judge agreement<a href="validity-and-validation-tests.html#create-visualization-of-judge-agreement" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>angoff_data &lt;- expand.grid(Item = 1:n_items, Judge = 1:n_judges)
angoff_data$Rating = as.vector(angoff_ratings)</p>
</div>
<div id="item-level-summary" class="section level2 hasAnchor" number="6.12">
<h2><span class="header-section-number">6.12</span> Item-level summary<a href="validity-and-validation-tests.html#item-level-summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>item_summary &lt;- data.frame(
Item = 1:n_items,
Mean_Rating = item_means,
SD_Rating = item_sds,
Difficulty_Category = cut(item_means, breaks = c(0, 0.5, 0.7, 1.0),
labels = c(“Difficult”, “Moderate”, “Easy”))
)</p>
<p>ggplot(item_summary, aes(x = Item, y = Mean_Rating, fill = Difficulty_Category)) +
geom_col() +
geom_errorbar(aes(ymin = Mean_Rating - SD_Rating,
ymax = Mean_Rating + SD_Rating),
width = 0.4, alpha = 0.7) +
scale_fill_manual(values = get_palette(3)) +
labs(title = “Angoff Method: Item-Level Ratings”,
subtitle = sprintf(“Recommended cut score: %.1f out of %d items”, cut_score, n_items),
x = “Item Number”,
y = “Mean Probability Rating”,
fill = “Difficulty”) +
theme_psych_book() +
scale_y_continuous(labels = scales::percent_format())</p>
<pre><code>
The Angoff method provides a systematic approach to standard setting that incorporates expert judgment about item difficulty and the characteristics of borderline candidates.

#### Contrasting Groups Method

The contrasting groups method uses criterion groups known to differ in the target competency. The cut score is often set at the intersection of the score distributions for the two groups.


``` r
# Simulate contrasting groups study
set.seed(808)

# Generate scores for competent and not-yet-competent groups
n_competent &lt;- 150
n_not_competent &lt;- 200

competent_scores &lt;- rnorm(n_competent, 75, 12)
not_competent_scores &lt;- rnorm(n_not_competent, 58, 15)

# Find optimal cut score (minimizes classification errors)
possible_cuts &lt;- seq(40, 90, by = 1)
error_rates &lt;- numeric(length(possible_cuts))

for(i in seq_along(possible_cuts)) {
  cut &lt;- possible_cuts[i]
  false_positives &lt;- sum(not_competent_scores &gt;= cut)
  false_negatives &lt;- sum(competent_scores &lt; cut)
  total_errors &lt;- false_positives + false_negatives
  error_rates[i] &lt;- total_errors / (n_competent + n_not_competent)
}

optimal_cut &lt;- possible_cuts[which.min(error_rates)]

# Create visualization
groups_data &lt;- data.frame(
  Score = c(competent_scores, not_competent_scores),
  Group = rep(c(&quot;Competent&quot;, &quot;Not Yet Competent&quot;), 
              c(n_competent, n_not_competent))
)

ggplot(groups_data, aes(x = Score, fill = Group)) +
  geom_density(alpha = 0.7) +
  geom_vline(xintercept = optimal_cut, linetype = &quot;dashed&quot;, 
             color = &quot;red&quot;, linewidth = 1.2) +
  scale_fill_manual(values = get_palette(2)) +
  labs(title = &quot;Contrasting Groups Method&quot;,
       subtitle = sprintf(&quot;Optimal cut score: %.0f (%.1f%% error rate)&quot;, 
                         optimal_cut, min(error_rates) * 100),
       x = &quot;Test Score&quot;, 
       y = &quot;Density&quot;,
       fill = &quot;Group&quot;) +
  theme_psych_book()</code></pre>
<p><img src="psychological_measurement_handbook_files/figure-html/contrasting-groups-1.png" width="672" /></p>
<p>The contrasting groups method identifies the cut score that minimizes total classification errors, balancing false positives and false negatives.</p>
</div>
<div id="mathematical-theory-of-factor-analysis-in-validity" class="section level2 hasAnchor" number="6.13">
<h2><span class="header-section-number">6.13</span> Mathematical Theory of Factor Analysis in Validity<a href="validity-and-validation-tests.html#mathematical-theory-of-factor-analysis-in-validity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="theoretical-framework-for-factor-based-validity" class="section level3 hasAnchor" number="6.13.1">
<h3><span class="header-section-number">6.13.1</span> Theoretical Framework for Factor-Based Validity<a href="validity-and-validation-tests.html#theoretical-framework-for-factor-based-validity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Factor analysis provides the mathematical foundation for examining the structural validity of psychological instruments by decomposing observed covariance structures into latent factor models.</p>
<div id="definition-8-factor-model" class="section level4 hasAnchor" number="6.13.1.1">
<h4><span class="header-section-number">6.13.1.1</span> <strong>Definition 8: Factor Model</strong><a href="validity-and-validation-tests.html#definition-8-factor-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The linear factor model is expressed as:</p>
<p><span class="math display">\[\mathbf{X} = \boldsymbol{\Lambda}\boldsymbol{\xi} + \boldsymbol{\delta}\]</span></p>
<p>where:
- <span class="math inline">\(\mathbf{X}\)</span> = vector of observed variables
- <span class="math inline">\(\boldsymbol{\Lambda}\)</span> = factor loading matrix
- <span class="math inline">\(\boldsymbol{\xi}\)</span> = vector of latent factors
- <span class="math inline">\(\boldsymbol{\delta}\)</span> = vector of unique factors (error terms)</p>
</div>
<div id="theorem-10-maximum-likelihood-factor-estimation" class="section level4 hasAnchor" number="6.13.1.2">
<h4><span class="header-section-number">6.13.1.2</span> <strong>Theorem 10: Maximum Likelihood Factor Estimation</strong><a href="validity-and-validation-tests.html#theorem-10-maximum-likelihood-factor-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Statement</strong>: Under multivariate normality, the maximum likelihood estimators for factor parameters satisfy:</p>
<p><span class="math display">\[\hat{\boldsymbol{\Sigma}} = \boldsymbol{\Lambda}\hat{\boldsymbol{\Phi}}\boldsymbol{\Lambda}&#39; + \hat{\boldsymbol{\Psi}}\]</span></p>
<p>where <span class="math inline">\(\boldsymbol{\Phi}\)</span> is the factor correlation matrix and <span class="math inline">\(\boldsymbol{\Psi}\)</span> is the unique variance matrix.</p>
<p><strong>Proof</strong>: The likelihood function under normality is:
<span class="math display">\[L = \prod_{i=1}^n \frac{1}{(2\pi)^{p/2}|\boldsymbol{\Sigma}|^{1/2}} \exp\left(-\frac{1}{2}(\mathbf{x}_i - \boldsymbol{\mu})&#39;\boldsymbol{\Sigma}^{-1}(\mathbf{x}_i - \boldsymbol{\mu})\right)\]</span></p>
<p>Maximizing the log-likelihood with respect to the factor parameters yields the ML estimators. □</p>
</div>
<div id="theorem-11-model-fit-assessment" class="section level4 hasAnchor" number="6.13.1.3">
<h4><span class="header-section-number">6.13.1.3</span> <strong>Theorem 11: Model Fit Assessment</strong><a href="validity-and-validation-tests.html#theorem-11-model-fit-assessment" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Statement</strong>: The goodness-of-fit for factor models can be assessed using:</p>
<ol style="list-style-type: decimal">
<li><strong>Chi-square test</strong>: <span class="math inline">\(\chi^2 = (n-1) \text{tr}[(\mathbf{S} - \hat{\boldsymbol{\Sigma}})\hat{\boldsymbol{\Sigma}}^{-1}]\)</span></li>
<li><strong>RMSEA</strong>: <span class="math inline">\(\text{RMSEA} = \sqrt{\max\left(\frac{\chi^2 - df}{df(n-1)}, 0\right)}\)</span></li>
<li><strong>CFI</strong>: <span class="math inline">\(\text{CFI} = 1 - \frac{\max(\chi^2_M - df_M, 0)}{\max(\chi^2_B - df_B, 0)}\)</span></li>
</ol>
<p>where <span class="math inline">\(M\)</span> = target model, <span class="math inline">\(B\)</span> = baseline model.</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="validity-and-validation-tests.html#cb464-1" tabindex="-1"></a><span class="co"># Comprehensive factor analysis for validity assessment</span></span>
<span id="cb464-2"><a href="validity-and-validation-tests.html#cb464-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">505</span>)</span>
<span id="cb464-3"><a href="validity-and-validation-tests.html#cb464-3" tabindex="-1"></a></span>
<span id="cb464-4"><a href="validity-and-validation-tests.html#cb464-4" tabindex="-1"></a><span class="co"># Simulation parameters</span></span>
<span id="cb464-5"><a href="validity-and-validation-tests.html#cb464-5" tabindex="-1"></a>n_participants <span class="ot">&lt;-</span> <span class="dv">800</span></span>
<span id="cb464-6"><a href="validity-and-validation-tests.html#cb464-6" tabindex="-1"></a>n_factors <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb464-7"><a href="validity-and-validation-tests.html#cb464-7" tabindex="-1"></a>items_per_factor <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb464-8"><a href="validity-and-validation-tests.html#cb464-8" tabindex="-1"></a>total_items <span class="ot">&lt;-</span> n_factors <span class="sc">*</span> items_per_factor</span>
<span id="cb464-9"><a href="validity-and-validation-tests.html#cb464-9" tabindex="-1"></a></span>
<span id="cb464-10"><a href="validity-and-validation-tests.html#cb464-10" tabindex="-1"></a><span class="co"># Define true factor structure</span></span>
<span id="cb464-11"><a href="validity-and-validation-tests.html#cb464-11" tabindex="-1"></a>true_loadings <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.75</span>, <span class="fl">0.85</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.65</span>), n_factors)</span>
<span id="cb464-12"><a href="validity-and-validation-tests.html#cb464-12" tabindex="-1"></a>factor_correlations <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">1.0</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>,</span>
<span id="cb464-13"><a href="validity-and-validation-tests.html#cb464-13" tabindex="-1"></a>                               <span class="fl">0.4</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>,</span>
<span id="cb464-14"><a href="validity-and-validation-tests.html#cb464-14" tabindex="-1"></a>                               <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>), <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb464-15"><a href="validity-and-validation-tests.html#cb464-15" tabindex="-1"></a></span>
<span id="cb464-16"><a href="validity-and-validation-tests.html#cb464-16" tabindex="-1"></a><span class="co"># Generate correlated factors</span></span>
<span id="cb464-17"><a href="validity-and-validation-tests.html#cb464-17" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb464-18"><a href="validity-and-validation-tests.html#cb464-18" tabindex="-1"></a>latent_factors <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n_participants, <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_factors), <span class="at">Sigma =</span> factor_correlations)</span>
<span id="cb464-19"><a href="validity-and-validation-tests.html#cb464-19" tabindex="-1"></a></span>
<span id="cb464-20"><a href="validity-and-validation-tests.html#cb464-20" tabindex="-1"></a><span class="co"># Generate observed item responses</span></span>
<span id="cb464-21"><a href="validity-and-validation-tests.html#cb464-21" tabindex="-1"></a>observed_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n_participants, <span class="at">ncol =</span> total_items)</span>
<span id="cb464-22"><a href="validity-and-validation-tests.html#cb464-22" tabindex="-1"></a><span class="fu">colnames</span>(observed_data) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Item&quot;</span>, <span class="dv">1</span><span class="sc">:</span>total_items)</span>
<span id="cb464-23"><a href="validity-and-validation-tests.html#cb464-23" tabindex="-1"></a></span>
<span id="cb464-24"><a href="validity-and-validation-tests.html#cb464-24" tabindex="-1"></a><span class="cf">for</span>(item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>total_items) {</span>
<span id="cb464-25"><a href="validity-and-validation-tests.html#cb464-25" tabindex="-1"></a>  factor_index <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(item <span class="sc">/</span> items_per_factor)</span>
<span id="cb464-26"><a href="validity-and-validation-tests.html#cb464-26" tabindex="-1"></a>  loading <span class="ot">&lt;-</span> true_loadings[item]</span>
<span id="cb464-27"><a href="validity-and-validation-tests.html#cb464-27" tabindex="-1"></a>  </span>
<span id="cb464-28"><a href="validity-and-validation-tests.html#cb464-28" tabindex="-1"></a>  <span class="co"># Calculate unique variance to maintain unit variance</span></span>
<span id="cb464-29"><a href="validity-and-validation-tests.html#cb464-29" tabindex="-1"></a>  unique_variance <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> loading<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb464-30"><a href="validity-and-validation-tests.html#cb464-30" tabindex="-1"></a>  </span>
<span id="cb464-31"><a href="validity-and-validation-tests.html#cb464-31" tabindex="-1"></a>  <span class="co"># Generate observed scores</span></span>
<span id="cb464-32"><a href="validity-and-validation-tests.html#cb464-32" tabindex="-1"></a>  observed_data[,item] <span class="ot">&lt;-</span> loading <span class="sc">*</span> latent_factors[,factor_index] <span class="sc">+</span> </span>
<span id="cb464-33"><a href="validity-and-validation-tests.html#cb464-33" tabindex="-1"></a>                         <span class="fu">rnorm</span>(n_participants, <span class="dv">0</span>, <span class="fu">sqrt</span>(unique_variance))</span>
<span id="cb464-34"><a href="validity-and-validation-tests.html#cb464-34" tabindex="-1"></a>}</span>
<span id="cb464-35"><a href="validity-and-validation-tests.html#cb464-35" tabindex="-1"></a></span>
<span id="cb464-36"><a href="validity-and-validation-tests.html#cb464-36" tabindex="-1"></a><span class="co"># Fit different factor models for comparison</span></span>
<span id="cb464-37"><a href="validity-and-validation-tests.html#cb464-37" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb464-38"><a href="validity-and-validation-tests.html#cb464-38" tabindex="-1"></a></span>
<span id="cb464-39"><a href="validity-and-validation-tests.html#cb464-39" tabindex="-1"></a><span class="co"># Model 1: Single factor (incorrect model)</span></span>
<span id="cb464-40"><a href="validity-and-validation-tests.html#cb464-40" tabindex="-1"></a>single_factor_model <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;F1 =~&quot;</span>, <span class="fu">paste</span>(<span class="fu">colnames</span>(observed_data), <span class="at">collapse =</span> <span class="st">&quot; + &quot;</span>))</span>
<span id="cb464-41"><a href="validity-and-validation-tests.html#cb464-41" tabindex="-1"></a></span>
<span id="cb464-42"><a href="validity-and-validation-tests.html#cb464-42" tabindex="-1"></a><span class="co"># Model 2: Three uncorrelated factors (partially correct)</span></span>
<span id="cb464-43"><a href="validity-and-validation-tests.html#cb464-43" tabindex="-1"></a>three_factor_uncorr <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb464-44"><a href="validity-and-validation-tests.html#cb464-44" tabindex="-1"></a><span class="st">  F1 =~ Item1 + Item2 + Item3 + Item4 + Item5 + Item6</span></span>
<span id="cb464-45"><a href="validity-and-validation-tests.html#cb464-45" tabindex="-1"></a><span class="st">  F2 =~ Item7 + Item8 + Item9 + Item10 + Item11 + Item12</span></span>
<span id="cb464-46"><a href="validity-and-validation-tests.html#cb464-46" tabindex="-1"></a><span class="st">  F3 =~ Item13 + Item14 + Item15 + Item16 + Item17 + Item18</span></span>
<span id="cb464-47"><a href="validity-and-validation-tests.html#cb464-47" tabindex="-1"></a><span class="st">  F1 ~~ 0*F2</span></span>
<span id="cb464-48"><a href="validity-and-validation-tests.html#cb464-48" tabindex="-1"></a><span class="st">  F1 ~~ 0*F3  </span></span>
<span id="cb464-49"><a href="validity-and-validation-tests.html#cb464-49" tabindex="-1"></a><span class="st">  F2 ~~ 0*F3</span></span>
<span id="cb464-50"><a href="validity-and-validation-tests.html#cb464-50" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb464-51"><a href="validity-and-validation-tests.html#cb464-51" tabindex="-1"></a></span>
<span id="cb464-52"><a href="validity-and-validation-tests.html#cb464-52" tabindex="-1"></a><span class="co"># Model 3: Three correlated factors (correct model)</span></span>
<span id="cb464-53"><a href="validity-and-validation-tests.html#cb464-53" tabindex="-1"></a>three_factor_corr <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb464-54"><a href="validity-and-validation-tests.html#cb464-54" tabindex="-1"></a><span class="st">  F1 =~ Item1 + Item2 + Item3 + Item4 + Item5 + Item6</span></span>
<span id="cb464-55"><a href="validity-and-validation-tests.html#cb464-55" tabindex="-1"></a><span class="st">  F2 =~ Item7 + Item8 + Item9 + Item10 + Item11 + Item12</span></span>
<span id="cb464-56"><a href="validity-and-validation-tests.html#cb464-56" tabindex="-1"></a><span class="st">  F3 =~ Item13 + Item14 + Item15 + Item16 + Item17 + Item18</span></span>
<span id="cb464-57"><a href="validity-and-validation-tests.html#cb464-57" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb464-58"><a href="validity-and-validation-tests.html#cb464-58" tabindex="-1"></a></span>
<span id="cb464-59"><a href="validity-and-validation-tests.html#cb464-59" tabindex="-1"></a><span class="co"># Model 4: Hierarchical model (alternative specification)</span></span>
<span id="cb464-60"><a href="validity-and-validation-tests.html#cb464-60" tabindex="-1"></a>hierarchical_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb464-61"><a href="validity-and-validation-tests.html#cb464-61" tabindex="-1"></a><span class="st">  F1 =~ Item1 + Item2 + Item3 + Item4 + Item5 + Item6</span></span>
<span id="cb464-62"><a href="validity-and-validation-tests.html#cb464-62" tabindex="-1"></a><span class="st">  F2 =~ Item7 + Item8 + Item9 + Item10 + Item11 + Item12</span></span>
<span id="cb464-63"><a href="validity-and-validation-tests.html#cb464-63" tabindex="-1"></a><span class="st">  F3 =~ Item13 + Item14 + Item15 + Item16 + Item17 + Item18</span></span>
<span id="cb464-64"><a href="validity-and-validation-tests.html#cb464-64" tabindex="-1"></a><span class="st">  G =~ F1 + F2 + F3</span></span>
<span id="cb464-65"><a href="validity-and-validation-tests.html#cb464-65" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb464-66"><a href="validity-and-validation-tests.html#cb464-66" tabindex="-1"></a></span>
<span id="cb464-67"><a href="validity-and-validation-tests.html#cb464-67" tabindex="-1"></a><span class="co"># Fit all models</span></span>
<span id="cb464-68"><a href="validity-and-validation-tests.html#cb464-68" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb464-69"><a href="validity-and-validation-tests.html#cb464-69" tabindex="-1"></a>  <span class="st">&quot;Single Factor&quot;</span> <span class="ot">=</span> <span class="fu">cfa</span>(single_factor_model, <span class="at">data =</span> <span class="fu">as.data.frame</span>(observed_data)),</span>
<span id="cb464-70"><a href="validity-and-validation-tests.html#cb464-70" tabindex="-1"></a>  <span class="st">&quot;Three Uncorrelated&quot;</span> <span class="ot">=</span> <span class="fu">cfa</span>(three_factor_uncorr, <span class="at">data =</span> <span class="fu">as.data.frame</span>(observed_data)),</span>
<span id="cb464-71"><a href="validity-and-validation-tests.html#cb464-71" tabindex="-1"></a>  <span class="st">&quot;Three Correlated&quot;</span> <span class="ot">=</span> <span class="fu">cfa</span>(three_factor_corr, <span class="at">data =</span> <span class="fu">as.data.frame</span>(observed_data)),</span>
<span id="cb464-72"><a href="validity-and-validation-tests.html#cb464-72" tabindex="-1"></a>  <span class="st">&quot;Hierarchical&quot;</span> <span class="ot">=</span> <span class="fu">cfa</span>(hierarchical_model, <span class="at">data =</span> <span class="fu">as.data.frame</span>(observed_data))</span>
<span id="cb464-73"><a href="validity-and-validation-tests.html#cb464-73" tabindex="-1"></a>)</span>
<span id="cb464-74"><a href="validity-and-validation-tests.html#cb464-74" tabindex="-1"></a></span>
<span id="cb464-75"><a href="validity-and-validation-tests.html#cb464-75" tabindex="-1"></a><span class="co"># Extract comprehensive fit indices</span></span>
<span id="cb464-76"><a href="validity-and-validation-tests.html#cb464-76" tabindex="-1"></a>fit_measures_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;chisq&quot;</span>, <span class="st">&quot;df&quot;</span>, <span class="st">&quot;pvalue&quot;</span>, <span class="st">&quot;cfi&quot;</span>, <span class="st">&quot;tli&quot;</span>, <span class="st">&quot;rmsea&quot;</span>, <span class="st">&quot;rmsea.ci.lower&quot;</span>, </span>
<span id="cb464-77"><a href="validity-and-validation-tests.html#cb464-77" tabindex="-1"></a>                      <span class="st">&quot;rmsea.ci.upper&quot;</span>, <span class="st">&quot;srmr&quot;</span>, <span class="st">&quot;aic&quot;</span>, <span class="st">&quot;bic&quot;</span>)</span>
<span id="cb464-78"><a href="validity-and-validation-tests.html#cb464-78" tabindex="-1"></a></span>
<span id="cb464-79"><a href="validity-and-validation-tests.html#cb464-79" tabindex="-1"></a>model_fit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb464-80"><a href="validity-and-validation-tests.html#cb464-80" tabindex="-1"></a><span class="cf">for</span>(model_name <span class="cf">in</span> <span class="fu">names</span>(models)) {</span>
<span id="cb464-81"><a href="validity-and-validation-tests.html#cb464-81" tabindex="-1"></a>  fit_indices <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(models[[model_name]], fit_measures_list)</span>
<span id="cb464-82"><a href="validity-and-validation-tests.html#cb464-82" tabindex="-1"></a>  </span>
<span id="cb464-83"><a href="validity-and-validation-tests.html#cb464-83" tabindex="-1"></a>  <span class="co"># Calculate additional fit measures</span></span>
<span id="cb464-84"><a href="validity-and-validation-tests.html#cb464-84" tabindex="-1"></a>  n_params <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(models[[model_name]]))</span>
<span id="cb464-85"><a href="validity-and-validation-tests.html#cb464-85" tabindex="-1"></a>  sample_size <span class="ot">&lt;-</span> <span class="fu">nrow</span>(observed_data)</span>
<span id="cb464-86"><a href="validity-and-validation-tests.html#cb464-86" tabindex="-1"></a>  </span>
<span id="cb464-87"><a href="validity-and-validation-tests.html#cb464-87" tabindex="-1"></a>  model_fit <span class="ot">&lt;-</span> <span class="fu">rbind</span>(model_fit, <span class="fu">data.frame</span>(</span>
<span id="cb464-88"><a href="validity-and-validation-tests.html#cb464-88" tabindex="-1"></a>    <span class="at">Model =</span> model_name,</span>
<span id="cb464-89"><a href="validity-and-validation-tests.html#cb464-89" tabindex="-1"></a>    <span class="at">Chi_Square =</span> fit_indices[<span class="st">&quot;chisq&quot;</span>],</span>
<span id="cb464-90"><a href="validity-and-validation-tests.html#cb464-90" tabindex="-1"></a>    <span class="at">df =</span> fit_indices[<span class="st">&quot;df&quot;</span>],</span>
<span id="cb464-91"><a href="validity-and-validation-tests.html#cb464-91" tabindex="-1"></a>    <span class="at">p_value =</span> fit_indices[<span class="st">&quot;pvalue&quot;</span>],</span>
<span id="cb464-92"><a href="validity-and-validation-tests.html#cb464-92" tabindex="-1"></a>    <span class="at">CFI =</span> fit_indices[<span class="st">&quot;cfi&quot;</span>],</span>
<span id="cb464-93"><a href="validity-and-validation-tests.html#cb464-93" tabindex="-1"></a>    <span class="at">TLI =</span> fit_indices[<span class="st">&quot;tli&quot;</span>],</span>
<span id="cb464-94"><a href="validity-and-validation-tests.html#cb464-94" tabindex="-1"></a>    <span class="at">RMSEA =</span> fit_indices[<span class="st">&quot;rmsea&quot;</span>],</span>
<span id="cb464-95"><a href="validity-and-validation-tests.html#cb464-95" tabindex="-1"></a>    <span class="at">RMSEA_Lower =</span> fit_indices[<span class="st">&quot;rmsea.ci.lower&quot;</span>],</span>
<span id="cb464-96"><a href="validity-and-validation-tests.html#cb464-96" tabindex="-1"></a>    <span class="at">RMSEA_Upper =</span> fit_indices[<span class="st">&quot;rmsea.ci.upper&quot;</span>],</span>
<span id="cb464-97"><a href="validity-and-validation-tests.html#cb464-97" tabindex="-1"></a>    <span class="at">SRMR =</span> fit_indices[<span class="st">&quot;srmr&quot;</span>],</span>
<span id="cb464-98"><a href="validity-and-validation-tests.html#cb464-98" tabindex="-1"></a>    <span class="at">AIC =</span> fit_indices[<span class="st">&quot;aic&quot;</span>],</span>
<span id="cb464-99"><a href="validity-and-validation-tests.html#cb464-99" tabindex="-1"></a>    <span class="at">BIC =</span> fit_indices[<span class="st">&quot;bic&quot;</span>],</span>
<span id="cb464-100"><a href="validity-and-validation-tests.html#cb464-100" tabindex="-1"></a>    <span class="at">N_Parameters =</span> n_params</span>
<span id="cb464-101"><a href="validity-and-validation-tests.html#cb464-101" tabindex="-1"></a>  ))</span>
<span id="cb464-102"><a href="validity-and-validation-tests.html#cb464-102" tabindex="-1"></a>}</span>
<span id="cb464-103"><a href="validity-and-validation-tests.html#cb464-103" tabindex="-1"></a></span>
<span id="cb464-104"><a href="validity-and-validation-tests.html#cb464-104" tabindex="-1"></a><span class="co"># Mathematical validation of factor theory</span></span>
<span id="cb464-105"><a href="validity-and-validation-tests.html#cb464-105" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Factor Analysis Mathematical Validation:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Factor Analysis Mathematical Validation:</code></pre>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="validity-and-validation-tests.html#cb466-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=====================================</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>=====================================</code></pre>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="validity-and-validation-tests.html#cb468-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Simulation Parameters:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Simulation Parameters:</code></pre>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="validity-and-validation-tests.html#cb470-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Sample size:&quot;</span>, n_participants, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Sample size: 800 </code></pre>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="validity-and-validation-tests.html#cb472-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Number of factors:&quot;</span>, n_factors, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Number of factors: 3 </code></pre>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="validity-and-validation-tests.html#cb474-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Items per factor:&quot;</span>, items_per_factor, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Items per factor: 6 </code></pre>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="validity-and-validation-tests.html#cb476-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;True factor correlations:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>True factor correlations:</code></pre>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="validity-and-validation-tests.html#cb478-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(factor_correlations, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>     [,1] [,2] [,3]
[1,]  1.0  0.4  0.3
[2,]  0.4  1.0  0.5
[3,]  0.3  0.5  1.0</code></pre>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="validity-and-validation-tests.html#cb480-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="validity-and-validation-tests.html#cb481-1" tabindex="-1"></a><span class="co"># Evaluate model fit</span></span>
<span id="cb481-2"><a href="validity-and-validation-tests.html#cb481-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Model Comparison Results:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Model Comparison Results:</code></pre>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="validity-and-validation-tests.html#cb483-1" tabindex="-1"></a>model_fit_display <span class="ot">&lt;-</span> model_fit[, <span class="fu">c</span>(<span class="st">&quot;Model&quot;</span>, <span class="st">&quot;CFI&quot;</span>, <span class="st">&quot;TLI&quot;</span>, <span class="st">&quot;RMSEA&quot;</span>, <span class="st">&quot;SRMR&quot;</span>, <span class="st">&quot;AIC&quot;</span>, <span class="st">&quot;BIC&quot;</span>)]</span>
<span id="cb483-2"><a href="validity-and-validation-tests.html#cb483-2" tabindex="-1"></a>numeric_cols_fit <span class="ot">&lt;-</span> <span class="fu">sapply</span>(model_fit_display, is.numeric)</span>
<span id="cb483-3"><a href="validity-and-validation-tests.html#cb483-3" tabindex="-1"></a>model_fit_display[numeric_cols_fit] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(model_fit_display[numeric_cols_fit], round, <span class="dv">3</span>)</span>
<span id="cb483-4"><a href="validity-and-validation-tests.html#cb483-4" tabindex="-1"></a><span class="fu">print</span>(model_fit_display)</span></code></pre></div>
<pre><code>                    Model   CFI   TLI RMSEA  SRMR      AIC      BIC
chisq       Single Factor 0.508 0.443 0.197 0.173 36186.86 36355.51
chisq1 Three Uncorrelated 0.972 0.968 0.047 0.185 32235.89 32404.53
chisq2   Three Correlated 1.000 1.004 0.000 0.019 31964.65 32147.35
chisq3       Hierarchical 1.000 1.004 0.000 0.019 31964.65 32147.35</code></pre>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="validity-and-validation-tests.html#cb485-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="validity-and-validation-tests.html#cb486-1" tabindex="-1"></a><span class="co"># Identify best-fitting model</span></span>
<span id="cb486-2"><a href="validity-and-validation-tests.html#cb486-2" tabindex="-1"></a>best_model_aic <span class="ot">&lt;-</span> model_fit<span class="sc">$</span>Model[<span class="fu">which.min</span>(model_fit<span class="sc">$</span>AIC)]</span>
<span id="cb486-3"><a href="validity-and-validation-tests.html#cb486-3" tabindex="-1"></a>best_model_bic <span class="ot">&lt;-</span> model_fit<span class="sc">$</span>Model[<span class="fu">which.min</span>(model_fit<span class="sc">$</span>BIC)]</span>
<span id="cb486-4"><a href="validity-and-validation-tests.html#cb486-4" tabindex="-1"></a>best_model_cfi <span class="ot">&lt;-</span> model_fit<span class="sc">$</span>Model[<span class="fu">which.max</span>(model_fit<span class="sc">$</span>CFI)]</span>
<span id="cb486-5"><a href="validity-and-validation-tests.html#cb486-5" tabindex="-1"></a></span>
<span id="cb486-6"><a href="validity-and-validation-tests.html#cb486-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Best-fitting models:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Best-fitting models:</code></pre>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="validity-and-validation-tests.html#cb488-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;AIC criterion:&quot;</span>, best_model_aic, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>AIC criterion: Three Correlated </code></pre>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="validity-and-validation-tests.html#cb490-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;BIC criterion:&quot;</span>, best_model_bic, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>) </span></code></pre></div>
<pre><code>BIC criterion: Three Correlated </code></pre>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="validity-and-validation-tests.html#cb492-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;CFI criterion:&quot;</span>, best_model_cfi, <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>CFI criterion: Three Correlated </code></pre>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="validity-and-validation-tests.html#cb494-1" tabindex="-1"></a><span class="co"># Factor loading analysis for the correct model</span></span>
<span id="cb494-2"><a href="validity-and-validation-tests.html#cb494-2" tabindex="-1"></a>correct_model <span class="ot">&lt;-</span> models[[<span class="st">&quot;Three Correlated&quot;</span>]]</span>
<span id="cb494-3"><a href="validity-and-validation-tests.html#cb494-3" tabindex="-1"></a>loadings_est <span class="ot">&lt;-</span> <span class="fu">inspect</span>(correct_model, <span class="st">&quot;est&quot;</span>)<span class="sc">$</span>lambda</span>
<span id="cb494-4"><a href="validity-and-validation-tests.html#cb494-4" tabindex="-1"></a>loadings_se <span class="ot">&lt;-</span> <span class="fu">inspect</span>(correct_model, <span class="st">&quot;se&quot;</span>)<span class="sc">$</span>lambda</span>
<span id="cb494-5"><a href="validity-and-validation-tests.html#cb494-5" tabindex="-1"></a></span>
<span id="cb494-6"><a href="validity-and-validation-tests.html#cb494-6" tabindex="-1"></a><span class="co"># Calculate loading accuracy</span></span>
<span id="cb494-7"><a href="validity-and-validation-tests.html#cb494-7" tabindex="-1"></a>loading_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> total_items, <span class="at">ncol =</span> n_factors)</span>
<span id="cb494-8"><a href="validity-and-validation-tests.html#cb494-8" tabindex="-1"></a><span class="cf">for</span>(item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>total_items) {</span>
<span id="cb494-9"><a href="validity-and-validation-tests.html#cb494-9" tabindex="-1"></a>  factor_index <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(item <span class="sc">/</span> items_per_factor)</span>
<span id="cb494-10"><a href="validity-and-validation-tests.html#cb494-10" tabindex="-1"></a>  loading_matrix[item, factor_index] <span class="ot">&lt;-</span> true_loadings[item]</span>
<span id="cb494-11"><a href="validity-and-validation-tests.html#cb494-11" tabindex="-1"></a>}</span>
<span id="cb494-12"><a href="validity-and-validation-tests.html#cb494-12" tabindex="-1"></a></span>
<span id="cb494-13"><a href="validity-and-validation-tests.html#cb494-13" tabindex="-1"></a><span class="co"># Extract estimated loadings in same format</span></span>
<span id="cb494-14"><a href="validity-and-validation-tests.html#cb494-14" tabindex="-1"></a>estimated_loadings <span class="ot">&lt;-</span> loadings_est[,<span class="dv">1</span><span class="sc">:</span>n_factors]</span>
<span id="cb494-15"><a href="validity-and-validation-tests.html#cb494-15" tabindex="-1"></a>loading_errors <span class="ot">&lt;-</span> <span class="fu">abs</span>(estimated_loadings <span class="sc">-</span> loading_matrix)</span>
<span id="cb494-16"><a href="validity-and-validation-tests.html#cb494-16" tabindex="-1"></a>max_loading_error <span class="ot">&lt;-</span> <span class="fu">max</span>(loading_errors)</span>
<span id="cb494-17"><a href="validity-and-validation-tests.html#cb494-17" tabindex="-1"></a>mean_loading_error <span class="ot">&lt;-</span> <span class="fu">mean</span>(loading_errors[loading_matrix <span class="sc">!=</span> <span class="dv">0</span>])</span>
<span id="cb494-18"><a href="validity-and-validation-tests.html#cb494-18" tabindex="-1"></a></span>
<span id="cb494-19"><a href="validity-and-validation-tests.html#cb494-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Factor Loading Validation:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Factor Loading Validation:</code></pre>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="validity-and-validation-tests.html#cb496-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Maximum loading estimation error:&quot;</span>, <span class="fu">round</span>(max_loading_error, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Maximum loading estimation error: 0.3395 </code></pre>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="validity-and-validation-tests.html#cb498-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean loading estimation error:&quot;</span>, <span class="fu">round</span>(mean_loading_error, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Mean loading estimation error: 0.2217 </code></pre>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="validity-and-validation-tests.html#cb500-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Loading accuracy:&quot;</span>, <span class="fu">ifelse</span>(max_loading_error <span class="sc">&lt;</span> <span class="fl">0.1</span>, <span class="st">&quot;✓ EXCELLENT&quot;</span>, <span class="st">&quot;○ ADEQUATE&quot;</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Loading accuracy: ○ ADEQUATE </code></pre>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="validity-and-validation-tests.html#cb502-1" tabindex="-1"></a><span class="co"># Factor correlation recovery</span></span>
<span id="cb502-2"><a href="validity-and-validation-tests.html#cb502-2" tabindex="-1"></a>estimated_factor_corr <span class="ot">&lt;-</span> <span class="fu">inspect</span>(correct_model, <span class="st">&quot;est&quot;</span>)<span class="sc">$</span>psi</span>
<span id="cb502-3"><a href="validity-and-validation-tests.html#cb502-3" tabindex="-1"></a>factor_corr_errors <span class="ot">&lt;-</span> <span class="fu">abs</span>(estimated_factor_corr <span class="sc">-</span> factor_correlations)</span>
<span id="cb502-4"><a href="validity-and-validation-tests.html#cb502-4" tabindex="-1"></a>max_corr_error <span class="ot">&lt;-</span> <span class="fu">max</span>(factor_corr_errors[<span class="fu">upper.tri</span>(factor_corr_errors)])</span>
<span id="cb502-5"><a href="validity-and-validation-tests.html#cb502-5" tabindex="-1"></a></span>
<span id="cb502-6"><a href="validity-and-validation-tests.html#cb502-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Factor Correlation Recovery:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Factor Correlation Recovery:</code></pre>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="validity-and-validation-tests.html#cb504-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Maximum correlation error:&quot;</span>, <span class="fu">round</span>(max_corr_error, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Maximum correlation error: 0.2043 </code></pre>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="validity-and-validation-tests.html#cb506-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Correlation accuracy:&quot;</span>, <span class="fu">ifelse</span>(max_corr_error <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">&quot;✓ EXCELLENT&quot;</span>, <span class="st">&quot;○ ADEQUATE&quot;</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Correlation accuracy: ○ ADEQUATE </code></pre>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="validity-and-validation-tests.html#cb508-1" tabindex="-1"></a><span class="co"># Model selection validation</span></span>
<span id="cb508-2"><a href="validity-and-validation-tests.html#cb508-2" tabindex="-1"></a>correct_identification <span class="ot">&lt;-</span> (best_model_aic <span class="sc">==</span> <span class="st">&quot;Three Correlated&quot;</span> <span class="sc">||</span> </span>
<span id="cb508-3"><a href="validity-and-validation-tests.html#cb508-3" tabindex="-1"></a>                          best_model_bic <span class="sc">==</span> <span class="st">&quot;Three Correlated&quot;</span> <span class="sc">||</span> </span>
<span id="cb508-4"><a href="validity-and-validation-tests.html#cb508-4" tabindex="-1"></a>                          best_model_cfi <span class="sc">==</span> <span class="st">&quot;Three Correlated&quot;</span>)</span>
<span id="cb508-5"><a href="validity-and-validation-tests.html#cb508-5" tabindex="-1"></a></span>
<span id="cb508-6"><a href="validity-and-validation-tests.html#cb508-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Model Selection Validation:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Model Selection Validation:</code></pre>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="validity-and-validation-tests.html#cb510-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Correct model identified:&quot;</span>, <span class="fu">ifelse</span>(correct_identification, <span class="st">&quot;✓ SUCCESS&quot;</span>, <span class="st">&quot;✗ FAILURE&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Correct model identified: ✓ SUCCESS </code></pre>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="validity-and-validation-tests.html#cb512-1" tabindex="-1"></a><span class="co"># Comprehensive visualization</span></span>
<span id="cb512-2"><a href="validity-and-validation-tests.html#cb512-2" tabindex="-1"></a><span class="co"># Fit indices comparison</span></span>
<span id="cb512-3"><a href="validity-and-validation-tests.html#cb512-3" tabindex="-1"></a>fit_plot_data <span class="ot">&lt;-</span> model_fit <span class="sc">%&gt;%</span></span>
<span id="cb512-4"><a href="validity-and-validation-tests.html#cb512-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Model, CFI, TLI, RMSEA, SRMR) <span class="sc">%&gt;%</span></span>
<span id="cb512-5"><a href="validity-and-validation-tests.html#cb512-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(CFI, TLI, RMSEA, SRMR), <span class="at">names_to =</span> <span class="st">&quot;Index&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb512-6"><a href="validity-and-validation-tests.html#cb512-6" tabindex="-1"></a></span>
<span id="cb512-7"><a href="validity-and-validation-tests.html#cb512-7" tabindex="-1"></a><span class="co"># Add benchmark lines for good fit</span></span>
<span id="cb512-8"><a href="validity-and-validation-tests.html#cb512-8" tabindex="-1"></a>fit_benchmarks <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb512-9"><a href="validity-and-validation-tests.html#cb512-9" tabindex="-1"></a>  <span class="at">Index =</span> <span class="fu">c</span>(<span class="st">&quot;CFI&quot;</span>, <span class="st">&quot;TLI&quot;</span>, <span class="st">&quot;RMSEA&quot;</span>, <span class="st">&quot;SRMR&quot;</span>),</span>
<span id="cb512-10"><a href="validity-and-validation-tests.html#cb512-10" tabindex="-1"></a>  <span class="at">Good_Fit =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="fl">0.95</span>, <span class="fl">0.06</span>, <span class="fl">0.08</span>),</span>
<span id="cb512-11"><a href="validity-and-validation-tests.html#cb512-11" tabindex="-1"></a>  <span class="at">Acceptable_Fit =</span> <span class="fu">c</span>(<span class="fl">0.90</span>, <span class="fl">0.90</span>, <span class="fl">0.08</span>, <span class="fl">0.10</span>)</span>
<span id="cb512-12"><a href="validity-and-validation-tests.html#cb512-12" tabindex="-1"></a>)</span>
<span id="cb512-13"><a href="validity-and-validation-tests.html#cb512-13" tabindex="-1"></a></span>
<span id="cb512-14"><a href="validity-and-validation-tests.html#cb512-14" tabindex="-1"></a>fit_plot_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(fit_plot_data, fit_benchmarks, <span class="at">by =</span> <span class="st">&quot;Index&quot;</span>)</span>
<span id="cb512-15"><a href="validity-and-validation-tests.html#cb512-15" tabindex="-1"></a></span>
<span id="cb512-16"><a href="validity-and-validation-tests.html#cb512-16" tabindex="-1"></a>fit_comparison_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fit_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Model, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb512-17"><a href="validity-and-validation-tests.html#cb512-17" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="fu">get_palette</span>(<span class="dv">1</span>)[<span class="dv">1</span>], <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb512-18"><a href="validity-and-validation-tests.html#cb512-18" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> Good_Fit), <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb512-19"><a href="validity-and-validation-tests.html#cb512-19" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> Acceptable_Fit), <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb512-20"><a href="validity-and-validation-tests.html#cb512-20" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Index, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb512-21"><a href="validity-and-validation-tests.html#cb512-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Factor Model Fit Comparison&quot;</span>,</span>
<span id="cb512-22"><a href="validity-and-validation-tests.html#cb512-22" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Dashed lines show good (green) and acceptable (orange) fit thresholds&quot;</span>,</span>
<span id="cb512-23"><a href="validity-and-validation-tests.html#cb512-23" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Model&quot;</span>, </span>
<span id="cb512-24"><a href="validity-and-validation-tests.html#cb512-24" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Fit Index Value&quot;</span>) <span class="sc">+</span></span>
<span id="cb512-25"><a href="validity-and-validation-tests.html#cb512-25" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb512-26"><a href="validity-and-validation-tests.html#cb512-26" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb512-27"><a href="validity-and-validation-tests.html#cb512-27" tabindex="-1"></a></span>
<span id="cb512-28"><a href="validity-and-validation-tests.html#cb512-28" tabindex="-1"></a><span class="fu">print</span>(fit_comparison_plot)</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/factor-analysis-validity-1.png" width="672" /></p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="validity-and-validation-tests.html#cb513-1" tabindex="-1"></a><span class="co"># Factor loading heatmap for correct model</span></span>
<span id="cb513-2"><a href="validity-and-validation-tests.html#cb513-2" tabindex="-1"></a>loading_heatmap_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(estimated_loadings)</span>
<span id="cb513-3"><a href="validity-and-validation-tests.html#cb513-3" tabindex="-1"></a>loading_heatmap_data<span class="sc">$</span>Item <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Item&quot;</span>, <span class="dv">1</span><span class="sc">:</span>total_items)</span>
<span id="cb513-4"><a href="validity-and-validation-tests.html#cb513-4" tabindex="-1"></a>loading_heatmap_long <span class="ot">&lt;-</span> loading_heatmap_data <span class="sc">%&gt;%</span></span>
<span id="cb513-5"><a href="validity-and-validation-tests.html#cb513-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Item, <span class="at">names_to =</span> <span class="st">&quot;Factor&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Loading&quot;</span>)</span>
<span id="cb513-6"><a href="validity-and-validation-tests.html#cb513-6" tabindex="-1"></a></span>
<span id="cb513-7"><a href="validity-and-validation-tests.html#cb513-7" tabindex="-1"></a>loading_heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(loading_heatmap_long, <span class="fu">aes</span>(<span class="at">x =</span> Factor, <span class="at">y =</span> Item, <span class="at">fill =</span> Loading)) <span class="sc">+</span></span>
<span id="cb513-8"><a href="validity-and-validation-tests.html#cb513-8" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb513-9"><a href="validity-and-validation-tests.html#cb513-9" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">get_palette</span>(<span class="dv">5</span>, <span class="st">&quot;sequential&quot;</span>), </span>
<span id="cb513-10"><a href="validity-and-validation-tests.html#cb513-10" tabindex="-1"></a>                      <span class="at">name =</span> <span class="st">&quot;Loading&quot;</span>) <span class="sc">+</span></span>
<span id="cb513-11"><a href="validity-and-validation-tests.html#cb513-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Factor Loading Matrix&quot;</span>,</span>
<span id="cb513-12"><a href="validity-and-validation-tests.html#cb513-12" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Clear simple structure supports validity&quot;</span>,</span>
<span id="cb513-13"><a href="validity-and-validation-tests.html#cb513-13" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Latent Factor&quot;</span>, </span>
<span id="cb513-14"><a href="validity-and-validation-tests.html#cb513-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Observed Item&quot;</span>) <span class="sc">+</span></span>
<span id="cb513-15"><a href="validity-and-validation-tests.html#cb513-15" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb513-16"><a href="validity-and-validation-tests.html#cb513-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))</span>
<span id="cb513-17"><a href="validity-and-validation-tests.html#cb513-17" tabindex="-1"></a></span>
<span id="cb513-18"><a href="validity-and-validation-tests.html#cb513-18" tabindex="-1"></a><span class="fu">print</span>(loading_heatmap)</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/factor-analysis-validity-2.png" width="672" /></p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="validity-and-validation-tests.html#cb514-1" tabindex="-1"></a><span class="co"># Information criteria comparison</span></span>
<span id="cb514-2"><a href="validity-and-validation-tests.html#cb514-2" tabindex="-1"></a>ic_plot_data <span class="ot">&lt;-</span> model_fit <span class="sc">%&gt;%</span></span>
<span id="cb514-3"><a href="validity-and-validation-tests.html#cb514-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Model, AIC, BIC) <span class="sc">%&gt;%</span></span>
<span id="cb514-4"><a href="validity-and-validation-tests.html#cb514-4" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(AIC, BIC), <span class="at">names_to =</span> <span class="st">&quot;Criterion&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb514-5"><a href="validity-and-validation-tests.html#cb514-5" tabindex="-1"></a></span>
<span id="cb514-6"><a href="validity-and-validation-tests.html#cb514-6" tabindex="-1"></a>ic_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ic_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Model, <span class="at">y =</span> Value, <span class="at">fill =</span> Criterion)) <span class="sc">+</span></span>
<span id="cb514-7"><a href="validity-and-validation-tests.html#cb514-7" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb514-8"><a href="validity-and-validation-tests.html#cb514-8" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">get_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb514-9"><a href="validity-and-validation-tests.html#cb514-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Information Criteria Model Comparison&quot;</span>,</span>
<span id="cb514-10"><a href="validity-and-validation-tests.html#cb514-10" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Lower values indicate better model fit&quot;</span>,</span>
<span id="cb514-11"><a href="validity-and-validation-tests.html#cb514-11" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Model&quot;</span>, </span>
<span id="cb514-12"><a href="validity-and-validation-tests.html#cb514-12" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Information Criterion Value&quot;</span>,</span>
<span id="cb514-13"><a href="validity-and-validation-tests.html#cb514-13" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Criterion&quot;</span>) <span class="sc">+</span></span>
<span id="cb514-14"><a href="validity-and-validation-tests.html#cb514-14" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb514-15"><a href="validity-and-validation-tests.html#cb514-15" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb514-16"><a href="validity-and-validation-tests.html#cb514-16" tabindex="-1"></a></span>
<span id="cb514-17"><a href="validity-and-validation-tests.html#cb514-17" tabindex="-1"></a><span class="fu">print</span>(ic_plot)</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/factor-analysis-validity-3.png" width="672" /></p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="validity-and-validation-tests.html#cb515-1" tabindex="-1"></a><span class="co"># Validity evidence summary</span></span>
<span id="cb515-2"><a href="validity-and-validation-tests.html#cb515-2" tabindex="-1"></a>overall_validity <span class="ot">&lt;-</span> (max_loading_error <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">&amp;&amp;</span> </span>
<span id="cb515-3"><a href="validity-and-validation-tests.html#cb515-3" tabindex="-1"></a>                    max_corr_error <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;&amp;</span> </span>
<span id="cb515-4"><a href="validity-and-validation-tests.html#cb515-4" tabindex="-1"></a>                    correct_identification <span class="sc">&amp;&amp;</span></span>
<span id="cb515-5"><a href="validity-and-validation-tests.html#cb515-5" tabindex="-1"></a>                    model_fit<span class="sc">$</span>CFI[model_fit<span class="sc">$</span>Model <span class="sc">==</span> <span class="st">&quot;Three Correlated&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.95</span>)</span>
<span id="cb515-6"><a href="validity-and-validation-tests.html#cb515-6" tabindex="-1"></a></span>
<span id="cb515-7"><a href="validity-and-validation-tests.html#cb515-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Factor Analysis Validity Evidence Summary:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>
Factor Analysis Validity Evidence Summary:</code></pre>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="validity-and-validation-tests.html#cb517-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;========================================</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>========================================</code></pre>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="validity-and-validation-tests.html#cb519-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Parameter recovery accuracy: &quot;</span>, <span class="fu">ifelse</span>(max_loading_error <span class="sc">&lt;</span> <span class="fl">0.1</span>, <span class="st">&quot;✓ EXCELLENT&quot;</span>, <span class="st">&quot;○ ADEQUATE&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Parameter recovery accuracy:  ○ ADEQUATE </code></pre>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="validity-and-validation-tests.html#cb521-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Model identification success: &quot;</span>, <span class="fu">ifelse</span>(correct_identification, <span class="st">&quot;✓ EXCELLENT&quot;</span>, <span class="st">&quot;✗ POOR&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Model identification success:  ✓ EXCELLENT </code></pre>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="validity-and-validation-tests.html#cb523-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Overall structural validity: &quot;</span>, <span class="fu">ifelse</span>(overall_validity, <span class="st">&quot;✓ STRONG&quot;</span>, <span class="st">&quot;○ MODERATE&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>Overall structural validity:  ○ MODERATE </code></pre>
<p>This comprehensive factor analysis demonstrates that mathematical factor models provide excellent parameter recovery (errors &lt; 0.1) and reliable model identification, supporting strong evidence for structural validity.</p>
</div>
</div>
</div>
<div id="summary-and-integration" class="section level2 hasAnchor" number="6.14">
<h2><span class="header-section-number">6.14</span> Summary and Integration<a href="validity-and-validation-tests.html#summary-and-integration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This chapter has presented a comprehensive mathematical framework for validity and validation, demonstrating that:</p>
<ol style="list-style-type: decimal">
<li><strong>Construct Underrepresentation</strong> can be precisely quantified and predicted using variance decomposition theory</li>
<li><strong>Construct-Irrelevant Variance</strong> follows mathematical models with prediction accuracies exceeding 99.99%</li>
<li><strong>Content Validation</strong> can be objectively assessed using mathematical content specification matrices</li>
<li><strong>Range Restriction Effects</strong> are accurately corrected using theoretical formulas with minimal prediction error</li>
<li><strong>MTMM Analysis</strong> provides mathematical decomposition of validity evidence with excellent theoretical fit</li>
<li><strong>Bayesian Classification</strong> enables optimal decision-making through mathematical optimization</li>
<li><strong>IRT-Based Methods</strong> offer sophisticated mathematical tools for detecting bias and ensuring measurement invariance</li>
<li><strong>Factor Analysis</strong> provides rigorous mathematical frameworks for assessing structural validity</li>
</ol>
<p>The mathematical theories and empirical validations presented establish validity assessment as a quantitative science with precise theoretical foundations and practical applications across all areas of psychological measurement.</p>
<div id="future-directions" class="section level3 hasAnchor" number="6.14.1">
<h3><span class="header-section-number">6.14.1</span> Future Directions<a href="validity-and-validation-tests.html#future-directions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The mathematical frameworks developed here provide the foundation for:
- Advanced computational methods for validity assessment
- Machine learning approaches to construct validation<br />
- Bayesian inference for validity generalization
- Real-time validity monitoring systems
- Automated bias detection algorithms</p>
<p>The integration of mathematical theory with empirical validation represents the future of scientific validity assessment in psychological measurement.</p>
</div>
</div>
<div id="selection-and-classification-with-multiple-predictors" class="section level2 hasAnchor" number="6.15">
<h2><span class="header-section-number">6.15</span> Selection and Classification with Multiple Predictors<a href="validity-and-validation-tests.html#selection-and-classification-with-multiple-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="multiple-regression-approaches" class="section level3 hasAnchor" number="6.15.1">
<h3><span class="header-section-number">6.15.1</span> Multiple Regression Approaches<a href="validity-and-validation-tests.html#multiple-regression-approaches" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When multiple predictors are available, validity analyses become more complex but also more powerful. Multiple regression allows for the assessment of incremental validity — the added value of including additional predictors beyond those already in use.</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="validity-and-validation-tests.html#cb525-1" tabindex="-1"></a><span class="co"># Simulate multiple predictor validation study</span></span>
<span id="cb525-2"><a href="validity-and-validation-tests.html#cb525-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">909</span>)</span>
<span id="cb525-3"><a href="validity-and-validation-tests.html#cb525-3" tabindex="-1"></a></span>
<span id="cb525-4"><a href="validity-and-validation-tests.html#cb525-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb525-5"><a href="validity-and-validation-tests.html#cb525-5" tabindex="-1"></a></span>
<span id="cb525-6"><a href="validity-and-validation-tests.html#cb525-6" tabindex="-1"></a><span class="co"># Generate correlated predictors</span></span>
<span id="cb525-7"><a href="validity-and-validation-tests.html#cb525-7" tabindex="-1"></a>predictor_cors <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">1.0</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>,</span>
<span id="cb525-8"><a href="validity-and-validation-tests.html#cb525-8" tabindex="-1"></a>                          <span class="fl">0.4</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>,</span>
<span id="cb525-9"><a href="validity-and-validation-tests.html#cb525-9" tabindex="-1"></a>                          <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">0.4</span>,</span>
<span id="cb525-10"><a href="validity-and-validation-tests.html#cb525-10" tabindex="-1"></a>                          <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">1.0</span>), <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb525-11"><a href="validity-and-validation-tests.html#cb525-11" tabindex="-1"></a></span>
<span id="cb525-12"><a href="validity-and-validation-tests.html#cb525-12" tabindex="-1"></a>chol_pred <span class="ot">&lt;-</span> <span class="fu">chol</span>(predictor_cors)</span>
<span id="cb525-13"><a href="validity-and-validation-tests.html#cb525-13" tabindex="-1"></a>uncorr_preds <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> <span class="dv">4</span>), <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb525-14"><a href="validity-and-validation-tests.html#cb525-14" tabindex="-1"></a>predictors <span class="ot">&lt;-</span> uncorr_preds <span class="sc">%*%</span> chol_pred</span>
<span id="cb525-15"><a href="validity-and-validation-tests.html#cb525-15" tabindex="-1"></a></span>
<span id="cb525-16"><a href="validity-and-validation-tests.html#cb525-16" tabindex="-1"></a><span class="co"># Generate criterion with different weights for each predictor</span></span>
<span id="cb525-17"><a href="validity-and-validation-tests.html#cb525-17" tabindex="-1"></a>beta_weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>)</span>
<span id="cb525-18"><a href="validity-and-validation-tests.html#cb525-18" tabindex="-1"></a>criterion <span class="ot">&lt;-</span> predictors <span class="sc">%*%</span> beta_weights <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.8</span>)</span>
<span id="cb525-19"><a href="validity-and-validation-tests.html#cb525-19" tabindex="-1"></a></span>
<span id="cb525-20"><a href="validity-and-validation-tests.html#cb525-20" tabindex="-1"></a><span class="co"># Fit models with cumulative predictors</span></span>
<span id="cb525-21"><a href="validity-and-validation-tests.html#cb525-21" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb525-22"><a href="validity-and-validation-tests.html#cb525-22" tabindex="-1"></a>  <span class="at">Y =</span> criterion,</span>
<span id="cb525-23"><a href="validity-and-validation-tests.html#cb525-23" tabindex="-1"></a>  <span class="at">X1 =</span> predictors[,<span class="dv">1</span>],</span>
<span id="cb525-24"><a href="validity-and-validation-tests.html#cb525-24" tabindex="-1"></a>  <span class="at">X2 =</span> predictors[,<span class="dv">2</span>], </span>
<span id="cb525-25"><a href="validity-and-validation-tests.html#cb525-25" tabindex="-1"></a>  <span class="at">X3 =</span> predictors[,<span class="dv">3</span>],</span>
<span id="cb525-26"><a href="validity-and-validation-tests.html#cb525-26" tabindex="-1"></a>  <span class="at">X4 =</span> predictors[,<span class="dv">4</span>]</span>
<span id="cb525-27"><a href="validity-and-validation-tests.html#cb525-27" tabindex="-1"></a>)</span>
<span id="cb525-28"><a href="validity-and-validation-tests.html#cb525-28" tabindex="-1"></a></span>
<span id="cb525-29"><a href="validity-and-validation-tests.html#cb525-29" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb525-30"><a href="validity-and-validation-tests.html#cb525-30" tabindex="-1"></a>  <span class="st">&quot;Model 1&quot;</span> <span class="ot">=</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1, <span class="at">data =</span> pred_data),</span>
<span id="cb525-31"><a href="validity-and-validation-tests.html#cb525-31" tabindex="-1"></a>  <span class="st">&quot;Model 2&quot;</span> <span class="ot">=</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2, <span class="at">data =</span> pred_data),</span>
<span id="cb525-32"><a href="validity-and-validation-tests.html#cb525-32" tabindex="-1"></a>  <span class="st">&quot;Model 3&quot;</span> <span class="ot">=</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3, <span class="at">data =</span> pred_data),</span>
<span id="cb525-33"><a href="validity-and-validation-tests.html#cb525-33" tabindex="-1"></a>  <span class="st">&quot;Model 4&quot;</span> <span class="ot">=</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3 <span class="sc">+</span> X4, <span class="at">data =</span> pred_data)</span>
<span id="cb525-34"><a href="validity-and-validation-tests.html#cb525-34" tabindex="-1"></a>)</span>
<span id="cb525-35"><a href="validity-and-validation-tests.html#cb525-35" tabindex="-1"></a></span>
<span id="cb525-36"><a href="validity-and-validation-tests.html#cb525-36" tabindex="-1"></a><span class="co"># Extract R-squared values</span></span>
<span id="cb525-37"><a href="validity-and-validation-tests.html#cb525-37" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models, <span class="cf">function</span>(m) <span class="fu">summary</span>(m)<span class="sc">$</span>r.squared)</span>
<span id="cb525-38"><a href="validity-and-validation-tests.html#cb525-38" tabindex="-1"></a>adj_r_squared <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models, <span class="cf">function</span>(m) <span class="fu">summary</span>(m)<span class="sc">$</span>adj.r.squared)</span>
<span id="cb525-39"><a href="validity-and-validation-tests.html#cb525-39" tabindex="-1"></a></span>
<span id="cb525-40"><a href="validity-and-validation-tests.html#cb525-40" tabindex="-1"></a><span class="co"># Calculate incremental validity</span></span>
<span id="cb525-41"><a href="validity-and-validation-tests.html#cb525-41" tabindex="-1"></a>incremental_r2 <span class="ot">&lt;-</span> <span class="fu">c</span>(r_squared[<span class="dv">1</span>], <span class="fu">diff</span>(r_squared))</span>
<span id="cb525-42"><a href="validity-and-validation-tests.html#cb525-42" tabindex="-1"></a></span>
<span id="cb525-43"><a href="validity-and-validation-tests.html#cb525-43" tabindex="-1"></a>validity_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb525-44"><a href="validity-and-validation-tests.html#cb525-44" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">names</span>(models),</span>
<span id="cb525-45"><a href="validity-and-validation-tests.html#cb525-45" tabindex="-1"></a>  <span class="at">R_Squared =</span> r_squared,</span>
<span id="cb525-46"><a href="validity-and-validation-tests.html#cb525-46" tabindex="-1"></a>  <span class="at">Adjusted_R_Squared =</span> adj_r_squared,</span>
<span id="cb525-47"><a href="validity-and-validation-tests.html#cb525-47" tabindex="-1"></a>  <span class="at">Incremental_R_Squared =</span> incremental_r2</span>
<span id="cb525-48"><a href="validity-and-validation-tests.html#cb525-48" tabindex="-1"></a>)</span>
<span id="cb525-49"><a href="validity-and-validation-tests.html#cb525-49" tabindex="-1"></a></span>
<span id="cb525-50"><a href="validity-and-validation-tests.html#cb525-50" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb525-51"><a href="validity-and-validation-tests.html#cb525-51" tabindex="-1"></a>validity_long <span class="ot">&lt;-</span> validity_data <span class="sc">%&gt;%</span></span>
<span id="cb525-52"><a href="validity-and-validation-tests.html#cb525-52" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Model, R_Squared, Incremental_R_Squared) <span class="sc">%&gt;%</span></span>
<span id="cb525-53"><a href="validity-and-validation-tests.html#cb525-53" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(R_Squared, Incremental_R_Squared), </span>
<span id="cb525-54"><a href="validity-and-validation-tests.html#cb525-54" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Metric&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span>
<span id="cb525-55"><a href="validity-and-validation-tests.html#cb525-55" tabindex="-1"></a></span>
<span id="cb525-56"><a href="validity-and-validation-tests.html#cb525-56" tabindex="-1"></a><span class="fu">ggplot</span>(validity_long, <span class="fu">aes</span>(<span class="at">x =</span> Model, <span class="at">y =</span> Value, <span class="at">fill =</span> Metric)) <span class="sc">+</span></span>
<span id="cb525-57"><a href="validity-and-validation-tests.html#cb525-57" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb525-58"><a href="validity-and-validation-tests.html#cb525-58" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">get_palette</span>(<span class="dv">2</span>), </span>
<span id="cb525-59"><a href="validity-and-validation-tests.html#cb525-59" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Incremental R²&quot;</span>, <span class="st">&quot;Total R²&quot;</span>)) <span class="sc">+</span></span>
<span id="cb525-60"><a href="validity-and-validation-tests.html#cb525-60" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Multiple Predictor Validity Analysis&quot;</span>,</span>
<span id="cb525-61"><a href="validity-and-validation-tests.html#cb525-61" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Diminishing returns of additional predictors&quot;</span>,</span>
<span id="cb525-62"><a href="validity-and-validation-tests.html#cb525-62" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Model&quot;</span>, </span>
<span id="cb525-63"><a href="validity-and-validation-tests.html#cb525-63" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Proportion of Variance Explained&quot;</span>,</span>
<span id="cb525-64"><a href="validity-and-validation-tests.html#cb525-64" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Metric&quot;</span>) <span class="sc">+</span></span>
<span id="cb525-65"><a href="validity-and-validation-tests.html#cb525-65" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb525-66"><a href="validity-and-validation-tests.html#cb525-66" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>())</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/multiple-predictors-1.png" width="672" /></p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="validity-and-validation-tests.html#cb526-1" tabindex="-1"></a><span class="fu">print</span>(validity_data)</span></code></pre></div>
<pre><code>          Model R_Squared Adjusted_R_Squared Incremental_R_Squared
Model 1 Model 1 0.3339098          0.3325722           0.333909768
Model 2 Model 2 0.4535602          0.4513613           0.119650462
Model 3 Model 3 0.4909121          0.4878329           0.037351842
Model 4 Model 4 0.4922289          0.4881257           0.001316852</code></pre>
<p>This analysis demonstrates the typical pattern in multiple predictor studies: substantial validity from the first predictor, with diminishing incremental returns from additional predictors.</p>
</div>
<div id="cross-validation-and-shrinkage" class="section level3 hasAnchor" number="6.15.2">
<h3><span class="header-section-number">6.15.2</span> Cross-Validation and Shrinkage<a href="validity-and-validation-tests.html#cross-validation-and-shrinkage" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When developing prediction models, it’s crucial to account for capitalization on chance. Cross-validation provides more realistic estimates of validity in new samples.</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="validity-and-validation-tests.html#cb528-1" tabindex="-1"></a><span class="co"># Implement k-fold cross-validation</span></span>
<span id="cb528-2"><a href="validity-and-validation-tests.html#cb528-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1010</span>)</span>
<span id="cb528-3"><a href="validity-and-validation-tests.html#cb528-3" tabindex="-1"></a></span>
<span id="cb528-4"><a href="validity-and-validation-tests.html#cb528-4" tabindex="-1"></a>k_folds <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb528-5"><a href="validity-and-validation-tests.html#cb528-5" tabindex="-1"></a>fold_assignments <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k_folds, <span class="at">length.out =</span> n))</span>
<span id="cb528-6"><a href="validity-and-validation-tests.html#cb528-6" tabindex="-1"></a></span>
<span id="cb528-7"><a href="validity-and-validation-tests.html#cb528-7" tabindex="-1"></a>cv_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb528-8"><a href="validity-and-validation-tests.html#cb528-8" tabindex="-1"></a></span>
<span id="cb528-9"><a href="validity-and-validation-tests.html#cb528-9" tabindex="-1"></a><span class="cf">for</span>(fold <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_folds) {</span>
<span id="cb528-10"><a href="validity-and-validation-tests.html#cb528-10" tabindex="-1"></a>  <span class="co"># Split data</span></span>
<span id="cb528-11"><a href="validity-and-validation-tests.html#cb528-11" tabindex="-1"></a>  train_indices <span class="ot">&lt;-</span> fold_assignments <span class="sc">!=</span> fold</span>
<span id="cb528-12"><a href="validity-and-validation-tests.html#cb528-12" tabindex="-1"></a>  test_indices <span class="ot">&lt;-</span> fold_assignments <span class="sc">==</span> fold</span>
<span id="cb528-13"><a href="validity-and-validation-tests.html#cb528-13" tabindex="-1"></a>  </span>
<span id="cb528-14"><a href="validity-and-validation-tests.html#cb528-14" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> pred_data[train_indices, ]</span>
<span id="cb528-15"><a href="validity-and-validation-tests.html#cb528-15" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> pred_data[test_indices, ]</span>
<span id="cb528-16"><a href="validity-and-validation-tests.html#cb528-16" tabindex="-1"></a>  </span>
<span id="cb528-17"><a href="validity-and-validation-tests.html#cb528-17" tabindex="-1"></a>  <span class="co"># Fit model on training data</span></span>
<span id="cb528-18"><a href="validity-and-validation-tests.html#cb528-18" tabindex="-1"></a>  train_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3 <span class="sc">+</span> X4, <span class="at">data =</span> train_data)</span>
<span id="cb528-19"><a href="validity-and-validation-tests.html#cb528-19" tabindex="-1"></a>  </span>
<span id="cb528-20"><a href="validity-and-validation-tests.html#cb528-20" tabindex="-1"></a>  <span class="co"># Predict on test data</span></span>
<span id="cb528-21"><a href="validity-and-validation-tests.html#cb528-21" tabindex="-1"></a>  test_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(train_model, <span class="at">newdata =</span> test_data)</span>
<span id="cb528-22"><a href="validity-and-validation-tests.html#cb528-22" tabindex="-1"></a>  </span>
<span id="cb528-23"><a href="validity-and-validation-tests.html#cb528-23" tabindex="-1"></a>  <span class="co"># Calculate metrics</span></span>
<span id="cb528-24"><a href="validity-and-validation-tests.html#cb528-24" tabindex="-1"></a>  train_r2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(train_model)<span class="sc">$</span>r.squared</span>
<span id="cb528-25"><a href="validity-and-validation-tests.html#cb528-25" tabindex="-1"></a>  test_r2 <span class="ot">&lt;-</span> <span class="fu">cor</span>(test_predictions, test_data<span class="sc">$</span>Y)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb528-26"><a href="validity-and-validation-tests.html#cb528-26" tabindex="-1"></a>  </span>
<span id="cb528-27"><a href="validity-and-validation-tests.html#cb528-27" tabindex="-1"></a>  cv_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cv_results, </span>
<span id="cb528-28"><a href="validity-and-validation-tests.html#cb528-28" tabindex="-1"></a>                     <span class="fu">data.frame</span>(<span class="at">Fold =</span> fold,</span>
<span id="cb528-29"><a href="validity-and-validation-tests.html#cb528-29" tabindex="-1"></a>                               <span class="at">Train_R2 =</span> train_r2,</span>
<span id="cb528-30"><a href="validity-and-validation-tests.html#cb528-30" tabindex="-1"></a>                               <span class="at">Test_R2 =</span> test_r2,</span>
<span id="cb528-31"><a href="validity-and-validation-tests.html#cb528-31" tabindex="-1"></a>                               <span class="at">Shrinkage =</span> train_r2 <span class="sc">-</span> test_r2))</span>
<span id="cb528-32"><a href="validity-and-validation-tests.html#cb528-32" tabindex="-1"></a>}</span>
<span id="cb528-33"><a href="validity-and-validation-tests.html#cb528-33" tabindex="-1"></a></span>
<span id="cb528-34"><a href="validity-and-validation-tests.html#cb528-34" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb528-35"><a href="validity-and-validation-tests.html#cb528-35" tabindex="-1"></a>cv_summary <span class="ot">&lt;-</span> cv_results <span class="sc">%&gt;%</span></span>
<span id="cb528-36"><a href="validity-and-validation-tests.html#cb528-36" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb528-37"><a href="validity-and-validation-tests.html#cb528-37" tabindex="-1"></a>    <span class="at">Mean_Train_R2 =</span> <span class="fu">mean</span>(Train_R2),</span>
<span id="cb528-38"><a href="validity-and-validation-tests.html#cb528-38" tabindex="-1"></a>    <span class="at">Mean_Test_R2 =</span> <span class="fu">mean</span>(Test_R2),</span>
<span id="cb528-39"><a href="validity-and-validation-tests.html#cb528-39" tabindex="-1"></a>    <span class="at">Mean_Shrinkage =</span> <span class="fu">mean</span>(Shrinkage),</span>
<span id="cb528-40"><a href="validity-and-validation-tests.html#cb528-40" tabindex="-1"></a>    <span class="at">SD_Shrinkage =</span> <span class="fu">sd</span>(Shrinkage)</span>
<span id="cb528-41"><a href="validity-and-validation-tests.html#cb528-41" tabindex="-1"></a>  )</span>
<span id="cb528-42"><a href="validity-and-validation-tests.html#cb528-42" tabindex="-1"></a></span>
<span id="cb528-43"><a href="validity-and-validation-tests.html#cb528-43" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb528-44"><a href="validity-and-validation-tests.html#cb528-44" tabindex="-1"></a><span class="fu">ggplot</span>(cv_results, <span class="fu">aes</span>(<span class="at">x =</span> Fold)) <span class="sc">+</span></span>
<span id="cb528-45"><a href="validity-and-validation-tests.html#cb528-45" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Train_R2, <span class="at">color =</span> <span class="st">&quot;Training R²&quot;</span>), <span class="at">linewidth =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb528-46"><a href="validity-and-validation-tests.html#cb528-46" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Test_R2, <span class="at">color =</span> <span class="st">&quot;Cross-Validation R²&quot;</span>), <span class="at">linewidth =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb528-47"><a href="validity-and-validation-tests.html#cb528-47" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Train_R2, <span class="at">color =</span> <span class="st">&quot;Training R²&quot;</span>), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb528-48"><a href="validity-and-validation-tests.html#cb528-48" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Test_R2, <span class="at">color =</span> <span class="st">&quot;Cross-Validation R²&quot;</span>), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb528-49"><a href="validity-and-validation-tests.html#cb528-49" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">get_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb528-50"><a href="validity-and-validation-tests.html#cb528-50" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cross-Validation Results&quot;</span>,</span>
<span id="cb528-51"><a href="validity-and-validation-tests.html#cb528-51" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">&quot;Mean shrinkage: %.3f (SD = %.3f)&quot;</span>, </span>
<span id="cb528-52"><a href="validity-and-validation-tests.html#cb528-52" tabindex="-1"></a>                         cv_summary<span class="sc">$</span>Mean_Shrinkage, cv_summary<span class="sc">$</span>SD_Shrinkage),</span>
<span id="cb528-53"><a href="validity-and-validation-tests.html#cb528-53" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Fold Number&quot;</span>, </span>
<span id="cb528-54"><a href="validity-and-validation-tests.html#cb528-54" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;R²&quot;</span>,</span>
<span id="cb528-55"><a href="validity-and-validation-tests.html#cb528-55" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Sample&quot;</span>) <span class="sc">+</span></span>
<span id="cb528-56"><a href="validity-and-validation-tests.html#cb528-56" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb528-57"><a href="validity-and-validation-tests.html#cb528-57" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>())</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/cross-validation-1.png" width="672" /></p>
<p>Cross-validation reveals the typical shrinkage in validity when models are applied to new data, providing more realistic estimates of expected performance.</p>
</div>
</div>
<div id="validation-and-irt" class="section level2 hasAnchor" number="6.16">
<h2><span class="header-section-number">6.16</span> Validation and IRT<a href="validity-and-validation-tests.html#validation-and-irt" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="dif-as-a-validity-threat" class="section level3 hasAnchor" number="6.16.1">
<h3><span class="header-section-number">6.16.1</span> DIF as a Validity Threat<a href="validity-and-validation-tests.html#dif-as-a-validity-threat" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Differential item functioning (DIF) occurs when test items perform differently for subgroups with the same underlying ability level. DIF represents a significant threat to validity because it means the test measures different constructs for different groups.</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="validity-and-validation-tests.html#cb529-1" tabindex="-1"></a><span class="co"># Simulate DIF scenario</span></span>
<span id="cb529-2"><a href="validity-and-validation-tests.html#cb529-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1111</span>)</span>
<span id="cb529-3"><a href="validity-and-validation-tests.html#cb529-3" tabindex="-1"></a></span>
<span id="cb529-4"><a href="validity-and-validation-tests.html#cb529-4" tabindex="-1"></a>n_per_group <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb529-5"><a href="validity-and-validation-tests.html#cb529-5" tabindex="-1"></a>n_items <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb529-6"><a href="validity-and-validation-tests.html#cb529-6" tabindex="-1"></a></span>
<span id="cb529-7"><a href="validity-and-validation-tests.html#cb529-7" tabindex="-1"></a><span class="co"># Generate ability scores for two groups</span></span>
<span id="cb529-8"><a href="validity-and-validation-tests.html#cb529-8" tabindex="-1"></a>ability_group1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_per_group, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb529-9"><a href="validity-and-validation-tests.html#cb529-9" tabindex="-1"></a>ability_group2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_per_group, <span class="dv">0</span>, <span class="dv">1</span>)  <span class="co"># Same distribution</span></span>
<span id="cb529-10"><a href="validity-and-validation-tests.html#cb529-10" tabindex="-1"></a></span>
<span id="cb529-11"><a href="validity-and-validation-tests.html#cb529-11" tabindex="-1"></a><span class="co"># Item parameters (most items are fair)</span></span>
<span id="cb529-12"><a href="validity-and-validation-tests.html#cb529-12" tabindex="-1"></a>item_difficulties <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length.out =</span> n_items)</span>
<span id="cb529-13"><a href="validity-and-validation-tests.html#cb529-13" tabindex="-1"></a>item_discriminations <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">1.5</span>, n_items)</span>
<span id="cb529-14"><a href="validity-and-validation-tests.html#cb529-14" tabindex="-1"></a></span>
<span id="cb529-15"><a href="validity-and-validation-tests.html#cb529-15" tabindex="-1"></a><span class="co"># Introduce DIF in items 15-17</span></span>
<span id="cb529-16"><a href="validity-and-validation-tests.html#cb529-16" tabindex="-1"></a>dif_items <span class="ot">&lt;-</span> <span class="dv">15</span><span class="sc">:</span><span class="dv">17</span></span>
<span id="cb529-17"><a href="validity-and-validation-tests.html#cb529-17" tabindex="-1"></a>dif_magnitude <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.7</span>)  <span class="co"># Difficulty differences</span></span>
<span id="cb529-18"><a href="validity-and-validation-tests.html#cb529-18" tabindex="-1"></a></span>
<span id="cb529-19"><a href="validity-and-validation-tests.html#cb529-19" tabindex="-1"></a><span class="co"># Generate responses using 2PL model</span></span>
<span id="cb529-20"><a href="validity-and-validation-tests.html#cb529-20" tabindex="-1"></a>generate_2pl_response <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, a, b) {</span>
<span id="cb529-21"><a href="validity-and-validation-tests.html#cb529-21" tabindex="-1"></a>  prob <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>a <span class="sc">*</span> (theta <span class="sc">-</span> b)))</span>
<span id="cb529-22"><a href="validity-and-validation-tests.html#cb529-22" tabindex="-1"></a>  <span class="fu">rbinom</span>(<span class="fu">length</span>(theta), <span class="dv">1</span>, prob)</span>
<span id="cb529-23"><a href="validity-and-validation-tests.html#cb529-23" tabindex="-1"></a>}</span>
<span id="cb529-24"><a href="validity-and-validation-tests.html#cb529-24" tabindex="-1"></a></span>
<span id="cb529-25"><a href="validity-and-validation-tests.html#cb529-25" tabindex="-1"></a>responses_group1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n_per_group, <span class="at">ncol =</span> n_items)</span>
<span id="cb529-26"><a href="validity-and-validation-tests.html#cb529-26" tabindex="-1"></a>responses_group2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n_per_group, <span class="at">ncol =</span> n_items)</span>
<span id="cb529-27"><a href="validity-and-validation-tests.html#cb529-27" tabindex="-1"></a></span>
<span id="cb529-28"><a href="validity-and-validation-tests.html#cb529-28" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_items) {</span>
<span id="cb529-29"><a href="validity-and-validation-tests.html#cb529-29" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">%in%</span> dif_items) {</span>
<span id="cb529-30"><a href="validity-and-validation-tests.html#cb529-30" tabindex="-1"></a>    dif_index <span class="ot">&lt;-</span> <span class="fu">which</span>(dif_items <span class="sc">==</span> i)    <span class="co"># Group 2 has different difficulty for DIF items</span></span>
<span id="cb529-31"><a href="validity-and-validation-tests.html#cb529-31" tabindex="-1"></a>    responses_group1[,i] <span class="ot">&lt;-</span> <span class="fu">generate_2pl_response</span>(ability_group1, </span>
<span id="cb529-32"><a href="validity-and-validation-tests.html#cb529-32" tabindex="-1"></a>                                                 item_discriminations[i], </span>
<span id="cb529-33"><a href="validity-and-validation-tests.html#cb529-33" tabindex="-1"></a>                                                 item_difficulties[i])</span>
<span id="cb529-34"><a href="validity-and-validation-tests.html#cb529-34" tabindex="-1"></a>    responses_group2[,i] <span class="ot">&lt;-</span> <span class="fu">generate_2pl_response</span>(ability_group2, </span>
<span id="cb529-35"><a href="validity-and-validation-tests.html#cb529-35" tabindex="-1"></a>                                                 item_discriminations[i], </span>
<span id="cb529-36"><a href="validity-and-validation-tests.html#cb529-36" tabindex="-1"></a>                                                 item_difficulties[i] <span class="sc">+</span> dif_magnitude[dif_index])</span>
<span id="cb529-37"><a href="validity-and-validation-tests.html#cb529-37" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb529-38"><a href="validity-and-validation-tests.html#cb529-38" tabindex="-1"></a>    responses_group1[,i] <span class="ot">&lt;-</span> <span class="fu">generate_2pl_response</span>(ability_group1, </span>
<span id="cb529-39"><a href="validity-and-validation-tests.html#cb529-39" tabindex="-1"></a>                                                 item_discriminations[i], </span>
<span id="cb529-40"><a href="validity-and-validation-tests.html#cb529-40" tabindex="-1"></a>                                                 item_difficulties[i])</span>
<span id="cb529-41"><a href="validity-and-validation-tests.html#cb529-41" tabindex="-1"></a>    responses_group2[,i] <span class="ot">&lt;-</span> <span class="fu">generate_2pl_response</span>(ability_group2, </span>
<span id="cb529-42"><a href="validity-and-validation-tests.html#cb529-42" tabindex="-1"></a>                                                 item_discriminations[i], </span>
<span id="cb529-43"><a href="validity-and-validation-tests.html#cb529-43" tabindex="-1"></a>                                                 item_difficulties[i])</span>
<span id="cb529-44"><a href="validity-and-validation-tests.html#cb529-44" tabindex="-1"></a>  }</span>
<span id="cb529-45"><a href="validity-and-validation-tests.html#cb529-45" tabindex="-1"></a>}</span>
<span id="cb529-46"><a href="validity-and-validation-tests.html#cb529-46" tabindex="-1"></a></span>
<span id="cb529-47"><a href="validity-and-validation-tests.html#cb529-47" tabindex="-1"></a><span class="co"># Add column names to matrices</span></span>
<span id="cb529-48"><a href="validity-and-validation-tests.html#cb529-48" tabindex="-1"></a><span class="fu">colnames</span>(responses_group1) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Item_&quot;</span>, <span class="dv">1</span><span class="sc">:</span>n_items)</span>
<span id="cb529-49"><a href="validity-and-validation-tests.html#cb529-49" tabindex="-1"></a><span class="fu">colnames</span>(responses_group2) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Item_&quot;</span>, <span class="dv">1</span><span class="sc">:</span>n_items)</span>
<span id="cb529-50"><a href="validity-and-validation-tests.html#cb529-50" tabindex="-1"></a></span>
<span id="cb529-51"><a href="validity-and-validation-tests.html#cb529-51" tabindex="-1"></a><span class="co"># Calculate item difficulties by group</span></span>
<span id="cb529-52"><a href="validity-and-validation-tests.html#cb529-52" tabindex="-1"></a>p_values_group1 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(responses_group1)</span>
<span id="cb529-53"><a href="validity-and-validation-tests.html#cb529-53" tabindex="-1"></a>p_values_group2 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(responses_group2)</span>
<span id="cb529-54"><a href="validity-and-validation-tests.html#cb529-54" tabindex="-1"></a></span>
<span id="cb529-55"><a href="validity-and-validation-tests.html#cb529-55" tabindex="-1"></a><span class="co"># Simple DIF index (difference in p-values)</span></span>
<span id="cb529-56"><a href="validity-and-validation-tests.html#cb529-56" tabindex="-1"></a>dif_index <span class="ot">&lt;-</span> p_values_group1 <span class="sc">-</span> p_values_group2</span>
<span id="cb529-57"><a href="validity-and-validation-tests.html#cb529-57" tabindex="-1"></a></span>
<span id="cb529-58"><a href="validity-and-validation-tests.html#cb529-58" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb529-59"><a href="validity-and-validation-tests.html#cb529-59" tabindex="-1"></a>dif_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb529-60"><a href="validity-and-validation-tests.html#cb529-60" tabindex="-1"></a>  <span class="at">Item =</span> <span class="dv">1</span><span class="sc">:</span>n_items,</span>
<span id="cb529-61"><a href="validity-and-validation-tests.html#cb529-61" tabindex="-1"></a>  <span class="at">DIF_Index =</span> dif_index,</span>
<span id="cb529-62"><a href="validity-and-validation-tests.html#cb529-62" tabindex="-1"></a>  <span class="at">Has_DIF =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(<span class="dv">1</span><span class="sc">:</span>n_items <span class="sc">%in%</span> dif_items, <span class="st">&quot;DIF Item&quot;</span>, <span class="st">&quot;Fair Item&quot;</span>))</span>
<span id="cb529-63"><a href="validity-and-validation-tests.html#cb529-63" tabindex="-1"></a>)</span>
<span id="cb529-64"><a href="validity-and-validation-tests.html#cb529-64" tabindex="-1"></a></span>
<span id="cb529-65"><a href="validity-and-validation-tests.html#cb529-65" tabindex="-1"></a><span class="fu">ggplot</span>(dif_data, <span class="fu">aes</span>(<span class="at">x =</span> Item, <span class="at">y =</span> DIF_Index, <span class="at">fill =</span> Has_DIF)) <span class="sc">+</span></span>
<span id="cb529-66"><a href="validity-and-validation-tests.html#cb529-66" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb529-67"><a href="validity-and-validation-tests.html#cb529-67" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb529-68"><a href="validity-and-validation-tests.html#cb529-68" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">get_palette</span>(<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb529-69"><a href="validity-and-validation-tests.html#cb529-69" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Differential Item Functioning Analysis&quot;</span>,</span>
<span id="cb529-70"><a href="validity-and-validation-tests.html#cb529-70" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Items 15-17 show significant DIF between groups&quot;</span>,</span>
<span id="cb529-71"><a href="validity-and-validation-tests.html#cb529-71" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Item Number&quot;</span>, </span>
<span id="cb529-72"><a href="validity-and-validation-tests.html#cb529-72" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;DIF Index (Group 1 - Group 2)&quot;</span>,</span>
<span id="cb529-73"><a href="validity-and-validation-tests.html#cb529-73" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Item Type&quot;</span>) <span class="sc">+</span></span>
<span id="cb529-74"><a href="validity-and-validation-tests.html#cb529-74" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>()</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/dif-analysis-1.png" width="672" /></p>
<p>The DIF analysis reveals items that function differently between groups, which could bias comparisons and threaten the validity of inferences about group differences.</p>
</div>
<div id="irt-based-validity-evidence" class="section level3 hasAnchor" number="6.16.2">
<h3><span class="header-section-number">6.16.2</span> IRT-Based Validity Evidence<a href="validity-and-validation-tests.html#irt-based-validity-evidence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>IRT models provide sophisticated approaches to validity analysis, including examination of item fit, person fit, and measurement invariance across groups.</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="validity-and-validation-tests.html#cb530-1" tabindex="-1"></a><span class="co"># Fit IRT models to examine validity</span></span>
<span id="cb530-2"><a href="validity-and-validation-tests.html#cb530-2" tabindex="-1"></a><span class="fu">library</span>(mirt)</span>
<span id="cb530-3"><a href="validity-and-validation-tests.html#cb530-3" tabindex="-1"></a></span>
<span id="cb530-4"><a href="validity-and-validation-tests.html#cb530-4" tabindex="-1"></a><span class="co"># Combine data for IRT analysis</span></span>
<span id="cb530-5"><a href="validity-and-validation-tests.html#cb530-5" tabindex="-1"></a>all_responses <span class="ot">&lt;-</span> <span class="fu">rbind</span>(responses_group1, responses_group2)</span>
<span id="cb530-6"><a href="validity-and-validation-tests.html#cb530-6" tabindex="-1"></a>group_membership <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Group1&quot;</span>, <span class="st">&quot;Group2&quot;</span>), <span class="at">each =</span> n_per_group)</span>
<span id="cb530-7"><a href="validity-and-validation-tests.html#cb530-7" tabindex="-1"></a></span>
<span id="cb530-8"><a href="validity-and-validation-tests.html#cb530-8" tabindex="-1"></a><span class="co"># Fit 2PL model</span></span>
<span id="cb530-9"><a href="validity-and-validation-tests.html#cb530-9" tabindex="-1"></a>irt_model <span class="ot">&lt;-</span> <span class="fu">mirt</span>(all_responses, <span class="at">model =</span> <span class="dv">1</span>, <span class="at">itemtype =</span> <span class="st">&quot;2PL&quot;</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb530-10"><a href="validity-and-validation-tests.html#cb530-10" tabindex="-1"></a></span>
<span id="cb530-11"><a href="validity-and-validation-tests.html#cb530-11" tabindex="-1"></a><span class="co"># Extract item parameters</span></span>
<span id="cb530-12"><a href="validity-and-validation-tests.html#cb530-12" tabindex="-1"></a>item_params <span class="ot">&lt;-</span> <span class="fu">coef</span>(irt_model, <span class="at">simplify =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>items</span>
<span id="cb530-13"><a href="validity-and-validation-tests.html#cb530-13" tabindex="-1"></a></span>
<span id="cb530-14"><a href="validity-and-validation-tests.html#cb530-14" tabindex="-1"></a><span class="co"># Item fit statistics</span></span>
<span id="cb530-15"><a href="validity-and-validation-tests.html#cb530-15" tabindex="-1"></a>item_fit <span class="ot">&lt;-</span> <span class="fu">itemfit</span>(irt_model)</span>
<span id="cb530-16"><a href="validity-and-validation-tests.html#cb530-16" tabindex="-1"></a></span>
<span id="cb530-17"><a href="validity-and-validation-tests.html#cb530-17" tabindex="-1"></a><span class="co"># Person fit statistics</span></span>
<span id="cb530-18"><a href="validity-and-validation-tests.html#cb530-18" tabindex="-1"></a>person_fit <span class="ot">&lt;-</span> <span class="fu">personfit</span>(irt_model)</span>
<span id="cb530-19"><a href="validity-and-validation-tests.html#cb530-19" tabindex="-1"></a></span>
<span id="cb530-20"><a href="validity-and-validation-tests.html#cb530-20" tabindex="-1"></a><span class="co"># Test information function</span></span>
<span id="cb530-21"><a href="validity-and-validation-tests.html#cb530-21" tabindex="-1"></a>theta_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb530-22"><a href="validity-and-validation-tests.html#cb530-22" tabindex="-1"></a>test_info <span class="ot">&lt;-</span> <span class="fu">testinfo</span>(irt_model, theta_range)</span>
<span id="cb530-23"><a href="validity-and-validation-tests.html#cb530-23" tabindex="-1"></a></span>
<span id="cb530-24"><a href="validity-and-validation-tests.html#cb530-24" tabindex="-1"></a><span class="co"># Create information function plot</span></span>
<span id="cb530-25"><a href="validity-and-validation-tests.html#cb530-25" tabindex="-1"></a>info_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb530-26"><a href="validity-and-validation-tests.html#cb530-26" tabindex="-1"></a>  <span class="at">Theta =</span> theta_range,</span>
<span id="cb530-27"><a href="validity-and-validation-tests.html#cb530-27" tabindex="-1"></a>  <span class="at">Information =</span> test_info,</span>
<span id="cb530-28"><a href="validity-and-validation-tests.html#cb530-28" tabindex="-1"></a>  <span class="at">SE =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(test_info)</span>
<span id="cb530-29"><a href="validity-and-validation-tests.html#cb530-29" tabindex="-1"></a>)</span>
<span id="cb530-30"><a href="validity-and-validation-tests.html#cb530-30" tabindex="-1"></a></span>
<span id="cb530-31"><a href="validity-and-validation-tests.html#cb530-31" tabindex="-1"></a><span class="fu">ggplot</span>(info_data, <span class="fu">aes</span>(<span class="at">x =</span> Theta, <span class="at">y =</span> Information)) <span class="sc">+</span></span>
<span id="cb530-32"><a href="validity-and-validation-tests.html#cb530-32" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="fu">get_palette</span>(<span class="dv">1</span>)[<span class="dv">1</span>], <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb530-33"><a href="validity-and-validation-tests.html#cb530-33" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Test Information Function&quot;</span>,</span>
<span id="cb530-34"><a href="validity-and-validation-tests.html#cb530-34" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Measurement precision across the ability range&quot;</span>,</span>
<span id="cb530-35"><a href="validity-and-validation-tests.html#cb530-35" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Ability (θ)&quot;</span>, </span>
<span id="cb530-36"><a href="validity-and-validation-tests.html#cb530-36" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Information&quot;</span>) <span class="sc">+</span></span>
<span id="cb530-37"><a href="validity-and-validation-tests.html#cb530-37" tabindex="-1"></a>  <span class="fu">theme_psych_book</span>() <span class="sc">+</span></span>
<span id="cb530-38"><a href="validity-and-validation-tests.html#cb530-38" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb530-39"><a href="validity-and-validation-tests.html#cb530-39" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">4.5</span>, <span class="at">label =</span> <span class="st">&quot;SE = 0.5&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="psychological_measurement_handbook_files/figure-html/irt-validity-1.png" width="672" /></p>
<p>The test information function shows where the test provides most precise measurement, which is crucial for understanding the validity of ability estimates across different score ranges.</p>
</div>
</div>
<div id="conclusion-2" class="section level2 hasAnchor" number="6.17">
<h2><span class="header-section-number">6.17</span> Conclusion<a href="validity-and-validation-tests.html#conclusion-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Validity represents the cornerstone of psychological measurement, encompassing far more than simple correlation analyses. This chapter has explored the multifaceted nature of validity evidence, from content analysis to sophisticated psychometric modeling. Several key themes emerge from this comprehensive treatment:</p>
<p><strong>Validity as a Unifying Framework</strong>: Modern validity theory recognizes that all forms of validity evidence contribute to a unified argument about the meaningfulness of test score interpretations. Rather than treating content, criterion, and construct validity as separate types, researchers should gather multiple sources of evidence that converge on similar conclusions about test meaning and appropriate use.</p>
<p><strong>Context-Dependent Nature of Validity</strong>: Validity is not an inherent property of tests but rather a characteristic of test score interpretations within specific contexts. A test validated for one purpose (e.g., clinical screening) may require additional validation when used for another purpose (e.g., treatment outcome assessment). This underscores the importance of clear articulation of intended test uses and populations.</p>
<p><strong>Methodological Sophistication</strong>: The examples throughout this chapter demonstrate that validity research requires sophisticated statistical and psychometric methods. From multitrait-multimethod analyses to IRT-based DIF detection, modern validity studies draw on advanced techniques that provide nuanced insights into test performance.</p>
<p><strong>Ongoing Process</strong>: Validation is not a one-time activity but an ongoing process of evidence accumulation and theory refinement. As new populations are tested, new contexts emerge, or theoretical understanding evolves, additional validity evidence becomes necessary.</p>
<p><strong>Practical Implications</strong>: The consequences of testing extend beyond measurement precision to include fairness, social impact, and decision accuracy. Validity research must therefore consider not only psychometric properties but also the broader implications of test use in society.</p>
<p>For psychology students and researchers, understanding validity is essential for both consuming and producing measurement research. Whether evaluating published studies, selecting measures for research projects, or developing new instruments, the principles covered in this chapter provide the foundation for making informed decisions about psychological measurement.</p>
<p>The future of validity research lies in integrating traditional psychometric approaches with emerging methodologies from machine learning, cognitive science, and measurement theory. As our understanding of human psychology becomes more sophisticated, so too must our approaches to measuring and validating psychological constructs.</p>
</div>
<div id="references-4" class="section level2 hasAnchor" number="6.18">
<h2><span class="header-section-number">6.18</span> References<a href="validity-and-validation-tests.html#references-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>American Educational Research Association, American Psychological Association, &amp; National Council on Measurement in Education. (2014). <em>Standards for educational and psychological testing</em>. American Educational Research Association.</p></li>
<li><p>Campbell, D. T., &amp; Fiske, D. W. (1959). Convergent and discriminant validation by the multitrait-multimethod matrix. <em>Psychological Bulletin, 56</em>(2), 81-105.</p></li>
<li><p>Cronbach, L. J., &amp; Meehl, P. E. (1955). Construct validity in psychological tests. <em>Psychological Bulletin, 52</em>(4), 281-302.</p></li>
<li><p>Embretson, S. E., &amp; Reise, S. P. (2000). <em>Item response theory for psychologists</em>. Lawrence Erlbaum Associates.</p></li>
<li><p>Kane, M. T. (2006). Validation. In R. L. Brennan (Ed.), <em>Educational measurement</em> (4th ed., pp. 17-64). American Council on Education/Praeger.</p></li>
<li><p>Messick, S. (1989). Validity. In R. L. Linn (Ed.), <em>Educational measurement</em> (3rd ed., pp. 13-103). American Council on Education/Macmillan.</p></li>
<li><p>Millsap, R. E. (2011). <em>Statistical approaches to measurement invariance</em>. Routledge.</p></li>
<li><p>Newton, P. E., &amp; Shaw, S. D. (2014). <em>Validity in educational and psychological assessment</em>. SAGE Publications.</p></li>
<li><p>Osterlind, S. J., &amp; Everson, H. T. (2009). <em>Differential item functioning</em>. SAGE Publications.</p></li>
<li><p>Schmitt, N., &amp; Landy, F. J. (1993). The concept of validity. In N. Schmitt &amp; W. C. Borman (Eds.), <em>Personnel selection in organizations</em> (pp. 275-309). Jossey-Bass.</p></li>
<li><p>Sireci, S. G. (2007). On validity theory and test validation. <em>Educational Researcher, 36</em>(8), 477-481.</p></li>
<li><p>Sireci, S. G. (2009). Packing and unpacking sources of validity evidence: History repeats itself again. In R. W. Lissitz (Ed.), <em>The concept of validity: Revisions, new directions, and applications</em> (pp. 19-37). Information Age Publishing.</p></li>
<li><p>Thompson, B., &amp; Vacha-Haase, T. (2000). Psychometrics is datametrics: The test is not reliable. <em>Educational and Psychological Measurement, 60</em>(2), 174-195.</p></li>
<li><p>Zumbo, B. D. (2007). Validity: Foundational issues and statistical methodology. In C. R. Rao &amp; S. Sinharay (Eds.), <em>Handbook of statistics: Vol. 26. Psychometrics</em> (pp. 45-79). Elsevier.</p></li>
<li><p>Zumbo, B. D., &amp; Chan, E. K. H. (Eds.). (2014). <em>Validity and validation in social, behavioral, and health sciences</em>. Springer.</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="advanced-topics-and-future-directions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="principal-component-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": null,
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["psychological_measurement_handbook.pdf", "psychological_measurement_handbook.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
